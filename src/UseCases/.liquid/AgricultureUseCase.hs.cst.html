<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/UseCases/AgricultureUseCase.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><span class='hs-comment'>{-# LANGUAGE BlockArguments, GADTs, FlexibleContexts, FlexibleInstances, DataKinds, PolyKinds, ScopedTypeVariables #-}</span>
<span class=hs-linenum>  2: </span><span class='hs-comment'>{-# Language PartialTypeSignatures #-}</span>
<span class=hs-linenum>  3: </span><span class='hs-comment'>{-# Language NamedWildCards #-}</span>
<span class=hs-linenum>  4: </span><span class='hs-comment'>{-# LANGUAGE OverloadedStrings #-}</span>
<span class=hs-linenum>  5: </span>
<span class=hs-linenum>  6: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-totality"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  7: </span><span class='hs-comment'>--{-@ LIQUID "--skip-module" @-}</span>
<span class=hs-linenum>  8: </span>
<span class=hs-linenum>  9: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>UseCases.AgricultureUseCase</span> <span class='hs-layout'>(</span><span class='hs-varid'>getInfoTlgm</span><span class='hs-layout'>,</span> <span class='hs-varid'>getInfoPlainText</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>where</span>
<span class=hs-linenum> 11: </span>
<span class=hs-linenum> 12: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy</span> <span class='hs-layout'>(</span> <span class='hs-conid'>Sem</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span><span class='hs-layout'>,</span> <span class='hs-conid'>Embed</span><span class='hs-layout'>,</span> <span class='hs-varid'>embed</span><span class='hs-layout'>,</span> <span class='hs-conid'>Members</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 13: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy.Error</span>
<span class=hs-linenum> 14: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy.Input</span>           <span class='hs-conid'>()</span>
<span class=hs-linenum> 15: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy.Trace</span>           <span class='hs-layout'>(</span><span class='hs-conid'>Trace</span><span class='hs-layout'>,</span> <span class='hs-varid'>trace</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 16: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>UseCases.WWI</span>             <span class='hs-layout'>(</span><span class='hs-conid'>WWI</span><span class='hs-layout'>,</span> <span class='hs-conid'>PlaceName</span><span class='hs-layout'>,</span> <span class='hs-conid'>TheWeatherThere</span><span class='hs-layout'>,</span> <span class='hs-varid'>getWeatherTown</span><span class='hs-layout'>,</span> <span class='hs-varid'>sendBackMsg</span><span class='hs-layout'>,</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>UserMsg</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 17: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Preferences</span> <span class='hs-layout'>(</span> <span class='hs-varid'>modalUser</span><span class='hs-layout'>,</span> <span class='hs-varid'>setPreferences</span><span class='hs-layout'>,</span> <span class='hs-varid'>getPreferences</span><span class='hs-layout'>,</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Telegram.Telegram</span> <span class='hs-layout'>(</span>
<span class=hs-linenum> 19: </span>                              <span class='hs-varid'>getUserIdNumber</span>
<span class=hs-linenum> 20: </span>                              <span class='hs-layout'>,</span> <span class='hs-conid'>User</span> <span class='hs-layout'>(</span><span class='hs-varid'>user_id</span><span class='hs-layout'>,</span> <span class='hs-varid'>user_first_name</span> <span class='hs-layout'>,</span> <span class='hs-varid'>user_last_name</span><span class='hs-layout'>,</span> <span class='hs-varid'>user_username</span><span class='hs-layout'>,</span> <span class='hs-varid'>user_language_code</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 21: </span>                              <span class='hs-layout'>,</span> <span class='hs-varid'>getUpdate_id</span>
<span class=hs-linenum> 22: </span>                              <span class='hs-layout'>,</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 23: </span>                              <span class='hs-layout'>,</span> <span class='hs-varid'>gettheTelegram</span>
<span class=hs-linenum> 24: </span>                              <span class='hs-layout'>,</span> <span class='hs-varid'>getMeta</span>
<span class=hs-linenum> 25: </span>                              <span class='hs-layout'>,</span> <span class='hs-varid'>getUserId</span>
<span class=hs-linenum> 26: </span>                              <span class='hs-layout'>,</span> <span class='hs-conid'>Update</span><span class='hs-layout'>(</span><span class='hs-conid'>Update</span><span class='hs-layout'>,</span> <span class='hs-varid'>message</span><span class='hs-layout'>,</span> <span class='hs-varid'>update_id</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 27: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Utils.Helper</span>
<span class=hs-linenum> 28: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>AWSLambda</span> <span class='hs-layout'>(</span><span class='hs-varid'>responseBody</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 29: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text.Internal</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<span class=hs-linenum> 30: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>M</span>
<span class=hs-linenum> 31: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.ByteString.Lazy.UTF8</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromString</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- from utf8-string</span>
<span class=hs-linenum> 32: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Text.RawString.QQ</span>
<span class=hs-linenum> 33: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Aeson</span> <span class='hs-layout'>(</span><span class='hs-varid'>eitherDecode</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 34: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Text.Lazy.Encoding</span> <span class='hs-layout'>(</span><span class='hs-varid'>encodeUtf8</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 35: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Text.Lazy</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromStrict</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 36: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Utils.ShortCircuit</span> <span class='hs-layout'>(</span><span class='hs-conid'>HasTrue</span><span class='hs-layout'>,</span> <span class='hs-conid'>Shortcircuit</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>andM</span><span class='hs-layout'>,</span> <span class='hs-varid'>firstFalseOf</span><span class='hs-layout'>,</span> <span class='hs-varid'>firstFalseOfM</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 37: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Either</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromRight</span><span class='hs-layout'>,</span> <span class='hs-varid'>isRight</span><span class='hs-layout'>,</span> <span class='hs-varid'>partitionEithers</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 38: </span>
<span class=hs-linenum> 39: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Web.Telegram.API.Bot.Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Message</span><span class='hs-layout'>,</span> <span class='hs-conid'>Message</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Message</span><span class='hs-layout'>(</span><span class='hs-varid'>text</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span><span class='hs-conid'>User</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 40: </span>
<span class=hs-linenum> 41: </span><span class='hs-comment'>-- Liquid Haskell imports</span>
<span class=hs-linenum> 42: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Polysemy.Internal</span> <span class='hs-layout'>(</span><span class='hs-conid'>Sem</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 43: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text.Lazy</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Tx</span>
<span class=hs-linenum> 44: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text.Internal.Lazy</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TL</span>
<span class=hs-linenum> 45: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.String</span>
<span class=hs-linenum> 46: </span>
<span class=hs-linenum> 47: </span><span class='hs-definition'>getInfoTlgm</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum> 48: </span><a class=annot href="#"><span class=annottext>forall r .
(GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find lq_tmp$x##1015:(lq_tmp$x##1016:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1017:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect lq_tmp$x##1018:(lq_tmp$x##1019:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1020:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r) '()), GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find lq_tmp$x##1022:(lq_tmp$x##1023:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1024:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1025:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect lq_tmp$x##1026:(lq_tmp$x##1027:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1028:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1029:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())) =&gt;
lq_tmp$x##3885:Web.Telegram.API.Bot.Data.Update -&gt; (Polysemy.Internal.Sem r Data.Text.Internal.Text)</span><span class='hs-definition'>getInfoTlgm</span></a> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Data.Update</span><span class='hs-varid'>updt</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Update</span> <span class='hs-layout'>{</span><span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>m</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 49: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4986 : GHC.Types.Bool | $k_##4985[VV##4984:=lq_tmp$x##4986][lq_tmp$db##13:=UseCases.AgricultureUseCase.isValidPreferencesJSON][lq_tmp$db##15:=lq_anf$##7205759403793934207##d4MIT][xcmp:=resp##a4Map]
                                   &amp;&amp; $k_##4991[VV##4990:=lq_tmp$x##4986][lq_tmp$db##13:=UseCases.AgricultureUseCase.isValidPreferencesJSON][lq_tmp$db##15:=lq_anf$##7205759403793934207##d4MIT][lq_tmp$x##4992:=resp##a4Map][xcmp:=resp##a4Map]}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##5022:{lq_tmp$x##5018 : (Data.Either.Either {lq_tmp$x##5016 : [{lq_tmp$x##5013 : GHC.Types.Char | $k_##3792[VV##3791:=lq_tmp$x##5013][VV##3796:=lq_tmp$x##5016][VV##3800:=lq_tmp$x##5018]}]&lt;\lq_tmp$x##5023 VV -&gt; {lq_tmp$x##5015 : GHC.Types.Char | $k_##3795[VV##3794:=lq_tmp$x##5015][VV##3796:=lq_tmp$x##5016][VV##3800:=lq_tmp$x##5018][lq_tmp$x##3793:=lq_tmp$x##5023][lq_tmp$x##5014:=lq_tmp$x##5023][lq_tmp$x##5021:=lq_tmp$x##5023]}&gt; | $k_##3797[VV##3796:=lq_tmp$x##5016][VV##3800:=lq_tmp$x##5018]} {lq_tmp$x##5017 : InterfaceAdapters.Preferences.Preferences | $k_##3799[VV##3798:=lq_tmp$x##5017][VV##3800:=lq_tmp$x##5018]}) | $k_##3801[VV##3800:=lq_tmp$x##5018]} -&gt; {lq_tmp$x##5019 : GHC.Types.Bool | $k_##3804[VV##3803:=lq_tmp$x##5019][json##a4MaP:=lq_tmp$x##5022]}</span><span class='hs-varid'>isValidPreferencesJSON</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4856:Data.ByteString.Lazy.Internal.ByteString -&gt; (Data.Either.Either [GHC.Types.Char] InterfaceAdapters.Preferences.Preferences)</span><span class='hs-varid'>eitherDecode</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4889:Data.Text.Internal.Lazy.Text -&gt; Data.ByteString.Lazy.Internal.ByteString</span><span class='hs-varid'>encodeUtf8</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4893:Data.Text.Internal.Text -&gt; Data.Text.Internal.Lazy.Text</span><span class='hs-varid'>fromStrict</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5034 : Data.Text.Internal.Text | lq_tmp$x##5034 == resp##a4Map
                                            &amp;&amp; $k_##4782[VV##4781:=lq_tmp$x##5034]}</span><span class='hs-varid'>resp</span></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-comment'>-- if preferences are valid and a JSON format ....</span>
<span class=hs-linenum> 50: </span>                  <a class=annot href="#"><span class=annottext>{lq_tmp$x##7778 : (Polysemy.Internal.Sem {lq_tmp$x##7785 : r | $k_##2389[fix$36$$36$d$40$$37$$44$$37$$41$_a4Mi1:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mj9][fix$36$$36$d$40$$37$$44$$37$$41$_a4Mi2:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][VV##2388:=lq_tmp$x##7785][VV##2392:=lq_tmp$x##7778][lq_tmp$x##2385:=updt##a4Mal][lq_tmp$x##7776:=lq_tmp$x##7785][lq_tmp$x##7782:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mj9][lq_tmp$x##7783:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][lq_tmp$x##7784:=updt##a4Mal]} {lq_tmp$x##7777 : () | $k_##2391[fix$36$$36$d$40$$37$$44$$37$$41$_a4Mi1:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mj9][fix$36$$36$d$40$$37$$44$$37$$41$_a4Mi2:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][VV##2390:=lq_tmp$x##7777][VV##2392:=lq_tmp$x##7778][lq_tmp$x##2385:=updt##a4Mal][lq_tmp$x##7782:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mj9][lq_tmp$x##7783:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][lq_tmp$x##7784:=updt##a4Mal]}) | $k_##2393[fix$36$$36$d$40$$37$$44$$37$$41$_a4Mi1:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mj9][fix$36$$36$d$40$$37$$44$$37$$41$_a4Mi2:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][VV##2392:=lq_tmp$x##7778][lq_tmp$x##2385:=updt##a4Mal][lq_tmp$x##7782:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mj9][lq_tmp$x##7783:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][lq_tmp$x##7784:=updt##a4Mal]}</span><span class='hs-varid'>apiSetTlgm</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7862 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##7862 == updt##a4Mal}</span><span class='hs-varid'>updt</span></a> 
<span class=hs-linenum> 51: </span>                  <a class=annot href="#"><span class=annottext>{lq_tmp$x##7910 : (Polysemy.Internal.Sem {lq_tmp$x##7917 : r | $k_##3052[fix$36$$36$d$40$$37$$44$$37$$41$_a4MiU:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][VV##3051:=lq_tmp$x##7917][VV##3055:=lq_tmp$x##7910][lq_tmp$x##3045:=resp##a4Map][lq_tmp$x##3048:=updt##a4Mal][lq_tmp$x##7908:=lq_tmp$x##7917][lq_tmp$x##7914:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][lq_tmp$x##7915:=resp##a4Map][lq_tmp$x##7916:=updt##a4Mal]} {lq_tmp$x##7909 : Data.Text.Internal.Text | $k_##3054[fix$36$$36$d$40$$37$$44$$37$$41$_a4MiU:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][VV##3053:=lq_tmp$x##7909][VV##3055:=lq_tmp$x##7910][lq_tmp$x##3045:=resp##a4Map][lq_tmp$x##3048:=updt##a4Mal][lq_tmp$x##7914:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][lq_tmp$x##7915:=resp##a4Map][lq_tmp$x##7916:=updt##a4Mal]}) | $k_##3056[fix$36$$36$d$40$$37$$44$$37$$41$_a4MiU:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][VV##3055:=lq_tmp$x##7910][lq_tmp$x##3045:=resp##a4Map][lq_tmp$x##3048:=updt##a4Mal][lq_tmp$x##7914:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][lq_tmp$x##7915:=resp##a4Map][lq_tmp$x##7916:=updt##a4Mal]}</span><span class='hs-varid'>outBoundRespond</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7960 : Data.Text.Internal.Text | lq_tmp$x##7960 == resp##a4Map
                                            &amp;&amp; $k_##4782[VV##4781:=lq_tmp$x##7960]}</span><span class='hs-varid'>resp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7961 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##7961 == updt##a4Mal}</span><span class='hs-varid'>updt</span></a>
<span class=hs-linenum> 52: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 53: </span>                  <span class='hs-keyword'>case</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5093 : Data.Text.Internal.Text | lq_tmp$x##5093 == respChecked##a4Maq}</span><span class='hs-varid'>respChecked</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5068 : Data.Text.Internal.Text | lq_tmp$x##5068 ~~ lq_anf$##7205759403793934211##d4MIX}</span><span class='hs-str'>"Invalid"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5100 : [GHC.Types.Char] | len lq_tmp$x##5100 == txtLen respChecked##a4Maq}</span><span class='hs-conid'>M.unpack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5104 : Data.Text.Internal.Text | lq_tmp$x##5104 == respChecked##a4Maq}</span><span class='hs-varid'>respChecked</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5121 : GHC.Types.Int | lq_tmp$x##5121 == len lq_anf$##7205759403793934213##d4MIZ
                                  &amp;&amp; lq_tmp$x##5121 &gt;= 0}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5110 : [GHC.Types.Char] | len lq_tmp$x##5110 == txtLen resp##a4Map}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>M.unpack</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5114 : Data.Text.Internal.Text | lq_tmp$x##5114 == resp##a4Map
                                            &amp;&amp; $k_##4782[VV##4781:=lq_tmp$x##5114]}</span><span class='hs-varid'>resp</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5145 : GHC.Types.Int | lq_tmp$x##5145 == (lq_anf$##7205759403793934215##d4MJ1 : int)}</span><span class='hs-num'>29</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5172 : GHC.Types.Int | lq_tmp$x##5172 == (lq_anf$##7205759403793934217##d4MJ3 : int)}</span><span class='hs-num'>4</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5219 : GHC.Types.Int | lq_tmp$x##5219 == len lq_anf$##7205759403793934220##d4MJ6
                                  &amp;&amp; lq_tmp$x##5219 &gt;= 0}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5200 : [[GHC.Types.Char]] | len lq_anf$##7205759403793934219##d4MJ5 - len lq_tmp$x##5200 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>words</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5181 : [GHC.Types.Char] | len lq_tmp$x##5181 == txtLen resp##a4Map}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>M.unpack</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5185 : Data.Text.Internal.Text | lq_tmp$x##5185 == resp##a4Map
                                            &amp;&amp; $k_##4782[VV##4781:=lq_tmp$x##5185]}</span><span class='hs-varid'>resp</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 54: </span>                        <span class='hs-layout'>(</span><span class='hs-conid'>True</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>            <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7686 : ((Polysemy.Internal.Union.Find lq_tmp$x##1022:(lq_tmp$x##1023:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1024:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1025:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect lq_tmp$x##1026:(lq_tmp$x##1027:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1028:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1029:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())) | lq_tmp$x##7686 == $d(%,%)_a4Mja}</span><span class='hs-varid'>outBoundRespond</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7582 : Data.Text.Internal.Text | lq_tmp$x##7582 ~~ lq_anf$##7205759403793934298##d4MKm}</span><span class='hs-str'>"Place Name is incorrectly specified"</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7688 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##7688 == updt##a4Mal}</span><span class='hs-varid'>updt</span></a>
<span class=hs-linenum> 55: </span>                        <span class='hs-layout'>(</span><span class='hs-conid'>False</span><span class='hs-layout'>,</span> <span class='hs-varid'>u1</span><span class='hs-conop'>:</span><span class='hs-varid'>u2</span><span class='hs-conop'>:</span><span class='hs-varid'>rx</span><span class='hs-layout'>,</span> <span class='hs-conid'>True</span><span class='hs-layout'>,</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 56: </span>                              <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>responseBody</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem r Data.Text.Internal.Text)</span><span class='hs-varid'>apiGetTlgm</span></a> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Data.Update</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Update</span> <span class='hs-layout'>{</span><span class='hs-varid'>update_id</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>getUpdate_id</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5818 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##5818 == updt##a4Mal}</span><span class='hs-varid'>updt</span></a><span class='hs-layout'>}</span> <span class='hs-layout'>{</span><span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7221 : (GHC.Maybe.Maybe {lq_tmp$x##7226 : Web.Telegram.API.Bot.Data.Message | $k_##7225[VV##7224:=lq_tmp$x##7226][lq_tmp$x##7223:=lq_anf$##7205759403793934294##d4MKi]}) | isJust lq_tmp$x##7221
                                                                                                                                                                                      &amp;&amp; fromJust lq_tmp$x##7221 == lq_anf$##7205759403793934294##d4MKi
                                                                                                                                                                                      &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##7221 == lq_anf$##7205759403793934294##d4MKi}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Data.Message</span><span class='hs-conid'>Message</span></a> <span class='hs-layout'>{</span><span class='hs-varid'>text</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6265 : (GHC.Maybe.Maybe {lq_tmp$x##6270 : Data.Text.Internal.Text | $k_##6269[VV##6268:=lq_tmp$x##6270][lq_tmp$x##6267:=ds_d4MB2]}) | isJust lq_tmp$x##6265
                                                                                                                                                 &amp;&amp; fromJust lq_tmp$x##6265 == ds_d4MB2
                                                                                                                                                 &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##6265 == ds_d4MB2}</span><span class='hs-conid'>Just</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6249 : Data.Text.Internal.Text | len lq_anf$##7205759403793934250##d4MJA == txtLen lq_tmp$x##6249}</span><span class='hs-conid'>M.pack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6223 : [{lq_tmp$x##6233 : GHC.Types.Char | $k_##6232[VV##6231:=lq_tmp$x##6233][lq_tmp$x##6227:=u1##a4Mar][lq_tmp$x##6228:=lq_anf$##7205759403793934249##d4MJz]}]&lt;\lq_tmp$x##6230 VV -&gt; {lq_tmp$x##6233 : GHC.Types.Char | $k_##6235[VV##6234:=lq_tmp$x##6233][lq_tmp$x##6227:=u1##a4Mar][lq_tmp$x##6228:=lq_anf$##7205759403793934249##d4MJz][lq_tmp$x##6236:=lq_tmp$x##6230]}&gt; | head lq_tmp$x##6223 == u1##a4Mar
                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; len lq_tmp$x##6223 == 1 + len lq_anf$##7205759403793934249##d4MJz
                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; tail lq_tmp$x##6223 == lq_anf$##7205759403793934249##d4MJz}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##6238 : GHC.Types.Char | lq_tmp$x##6238 == u1##a4Mar}</span><span class='hs-varid'>u1</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##6208 : GHC.Types.Char | lq_tmp$x##6208 == u2##a4Mas}</span><span class='hs-varid'>u2</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##6212 : [GHC.Types.Char] | lq_tmp$x##6212 == rx##a4Mat
                                     &amp;&amp; len lq_tmp$x##6212 &gt;= 0}</span><span class='hs-varid'>rx</span></a><span class='hs-layout'>)</span><span class='hs-layout'>}</span><span class='hs-layout'>{</span><span class='hs-varid'>from</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6918 : (GHC.Maybe.Maybe {lq_tmp$x##6923 : Web.Telegram.API.Bot.Data.User | $k_##6922[VV##6921:=lq_tmp$x##6923][lq_tmp$x##6920:=lq_anf$##7205759403793934292##d4MKg]}) | isJust lq_tmp$x##6918
                                                                                                                                                                                   &amp;&amp; fromJust lq_tmp$x##6918 == lq_anf$##7205759403793934292##d4MKg
                                                                                                                                                                                   &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##6918 == lq_anf$##7205759403793934292##d4MKg}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Data.User</span><span class='hs-conid'>User</span></a> <span class='hs-layout'>{</span><span class='hs-varid'>user_id</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>getUserIdNumber</span></a> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.User)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>from</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6795 : Web.Telegram.API.Bot.Data.Message | lq_tmp$x##6795 == m##a4Mam}</span><span class='hs-varid'>m</span></a><span class='hs-layout'>)</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 57: </span>                              <a class=annot href="#"><span class=annottext>{lq_tmp$x##7500 : (Polysemy.Internal.Sem {lq_tmp$x##7507 : r | $k_##3052[fix$36$$36$d$40$$37$$44$$37$$41$_a4MiU:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][VV##3051:=lq_tmp$x##7507][VV##3055:=lq_tmp$x##7500][lq_tmp$x##3045:=responseBody##a4Mau][lq_tmp$x##3048:=updt##a4Mal][lq_tmp$x##7498:=lq_tmp$x##7507][lq_tmp$x##7504:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][lq_tmp$x##7505:=responseBody##a4Mau][lq_tmp$x##7506:=updt##a4Mal]} {lq_tmp$x##7499 : Data.Text.Internal.Text | $k_##3054[fix$36$$36$d$40$$37$$44$$37$$41$_a4MiU:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][VV##3053:=lq_tmp$x##7499][VV##3055:=lq_tmp$x##7500][lq_tmp$x##3045:=responseBody##a4Mau][lq_tmp$x##3048:=updt##a4Mal][lq_tmp$x##7504:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][lq_tmp$x##7505:=responseBody##a4Mau][lq_tmp$x##7506:=updt##a4Mal]}) | $k_##3056[fix$36$$36$d$40$$37$$44$$37$$41$_a4MiU:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][VV##3055:=lq_tmp$x##7500][lq_tmp$x##3045:=responseBody##a4Mau][lq_tmp$x##3048:=updt##a4Mal][lq_tmp$x##7504:=fix$36$$36$d$40$$37$$44$$37$$41$_a4Mja][lq_tmp$x##7505:=responseBody##a4Mau][lq_tmp$x##7506:=updt##a4Mal]}</span><span class='hs-varid'>outBoundRespond</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7550 : Data.Text.Internal.Text | lq_tmp$x##7550 == responseBody##a4Mau}</span><span class='hs-varid'>responseBody</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7551 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##7551 == updt##a4Mal}</span><span class='hs-varid'>updt</span></a>
<span class=hs-linenum> 58: </span>                        <span class='hs-keyword'>_</span>                        <span class='hs-keyglyph'>-&gt;</span>  <a class=annot href="#"><span class=annottext>{lq_tmp$x##5806 : ((Polysemy.Internal.Union.Find lq_tmp$x##1022:(lq_tmp$x##1023:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1024:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1025:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect lq_tmp$x##1026:(lq_tmp$x##1027:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1028:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1029:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())) | lq_tmp$x##5806 == $d(%,%)_a4Mja}</span><span class='hs-varid'>outBoundRespond</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5807 : Data.Text.Internal.Text | lq_tmp$x##5807 == resp##a4Map
                                            &amp;&amp; $k_##4782[VV##4781:=lq_tmp$x##5807]}</span><span class='hs-varid'>resp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5808 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##5808 == updt##a4Mal}</span><span class='hs-varid'>updt</span></a>
<span class=hs-linenum> 59: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum> 60: </span>            <span class='hs-layout'>(</span><span class='hs-varid'>uuid</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>tlgm</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##4781 : Data.Text.Internal.Text | $k_##4782}</span><span class='hs-varid'>resp</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Text.Internal.Text, (Data.Text.Internal.Text, Data.Text.Internal.Text))</span><span class='hs-varid'>getMeta</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4595 : (GHC.Maybe.Maybe {lq_tmp$x##4600 : Web.Telegram.API.Bot.Data.Update | $k_##4599[VV##4598:=lq_tmp$x##4600][lq_tmp$x##4597:=updt##a4Mal]}) | isJust lq_tmp$x##4595
                                                                                                                                                             &amp;&amp; fromJust lq_tmp$x##4595 == updt##a4Mal
                                                                                                                                                             &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##4595 == updt##a4Mal}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Just</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4601 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##4601 == updt##a4Mal}</span><span class='hs-varid'>updt</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 61: </span>            <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>respChecked</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>rejectInvalid</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4842 : Data.Text.Internal.Text | lq_tmp$x##4842 == resp##a4Map
                                            &amp;&amp; $k_##4782[VV##4781:=lq_tmp$x##4842]}</span><span class='hs-varid'>resp</span></a>
<span class=hs-linenum> 62: </span><span class='hs-definition'>getInfoTlgm</span> <span class='hs-varid'>updt</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Update</span> <span class='hs-layout'>{</span><span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Base.Applicative (Polysemy.Internal.Sem r))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a6hX b##a6hY .
      lq_tmp$x##4435:(a##a6hX, b##a6hY) -&gt; {lq_tmp$x##4432 : a##a6hX | lq_tmp$x##4432 == fst lq_tmp$x##4435} | VV == Data.Tuple.fst}</span><span class='hs-varid'>fst</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4489 : ({lq_tmp$x##4483 : Data.Text.Internal.Text | $k_##2991[VV##2990:=lq_tmp$x##4483][VV##3001:=lq_tmp$x##4489][lq_tmp$x##4492:=lq_anf$##7205759403793934197##d4MIJ][lq_tmp$x##4493:=updt##a4Mal][r##a4MaI:=lq_anf$##7205759403793934197##d4MIJ][u##a4MaJ:=updt##a4Mal]}, {lq_tmp$x##4485 : (GHC.Maybe.Maybe {lq_tmp$x##4484 : Web.Telegram.API.Bot.Data.Update | $k_##2993[VV##2992:=lq_tmp$x##4484][VV##2994:=lq_tmp$x##4485][VV##3001:=lq_tmp$x##4489][lq_tmp$x##4492:=lq_anf$##7205759403793934197##d4MIJ][lq_tmp$x##4493:=updt##a4Mal][r##a4MaI:=lq_anf$##7205759403793934197##d4MIJ][u##a4MaJ:=updt##a4Mal]}) | $k_##2995[VV##2994:=lq_tmp$x##4485][VV##3001:=lq_tmp$x##4489][lq_tmp$x##4492:=lq_anf$##7205759403793934197##d4MIJ][lq_tmp$x##4493:=updt##a4Mal][r##a4MaI:=lq_anf$##7205759403793934197##d4MIJ][u##a4MaJ:=updt##a4Mal]})&lt;\lq_tmp$x##4494 VV -&gt; {lq_tmp$x##4488 : (GHC.Maybe.Maybe {lq_tmp$x##4487 : Web.Telegram.API.Bot.Data.Update | $k_##2998[VV##2997:=lq_tmp$x##4487][VV##2999:=lq_tmp$x##4488][VV##3001:=lq_tmp$x##4489][lq_tmp$x##2996:=lq_tmp$x##4494][lq_tmp$x##4486:=lq_tmp$x##4494][lq_tmp$x##4492:=lq_anf$##7205759403793934197##d4MIJ][lq_tmp$x##4493:=updt##a4Mal][r##a4MaI:=lq_anf$##7205759403793934197##d4MIJ][u##a4MaJ:=updt##a4Mal]}) | $k_##3000[VV##2999:=lq_tmp$x##4488][VV##3001:=lq_tmp$x##4489][lq_tmp$x##2996:=lq_tmp$x##4494][lq_tmp$x##4486:=lq_tmp$x##4494][lq_tmp$x##4492:=lq_anf$##7205759403793934197##d4MIJ][lq_tmp$x##4493:=updt##a4Mal][r##a4MaI:=lq_anf$##7205759403793934197##d4MIJ][u##a4MaJ:=updt##a4Mal]}&gt; | $k_##3002[VV##3001:=lq_tmp$x##4489][lq_tmp$x##4492:=lq_anf$##7205759403793934197##d4MIJ][lq_tmp$x##4493:=updt##a4Mal][r##a4MaI:=lq_anf$##7205759403793934197##d4MIJ][u##a4MaJ:=updt##a4Mal]}</span><span class='hs-varid'>theMsg</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4472 : Data.Text.Internal.Text | lq_tmp$x##4472 ~~ lq_anf$##7205759403793934196##d4MII}</span><span class='hs-str'>"Update:message=nothing!!"</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4496 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##4496 == updt##a4Mal}</span><span class='hs-varid'>updt</span></a>
<span class=hs-linenum> 63: </span>
<span class=hs-linenum> 64: </span><span class='hs-definition'>outBoundRespond</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum> 65: </span><a class=annot href="#"><span class=annottext>forall r .
(GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())) =&gt;
lq_tmp$x##3045:{VV##3046 : Data.Text.Internal.Text | $k_##3047} -&gt; lq_tmp$x##3048:{VV##3049 : Web.Telegram.API.Bot.Data.Update | $k_##3050} -&gt; {VV##3055 : (Polysemy.Internal.Sem {VV##3051 : r | $k_##3052} {VV##3053 : Data.Text.Internal.Text | $k_##3054}) | $k_##3056}</span><span class='hs-definition'>outBoundRespond</span></a> <a class=annot href="#"><span class=annottext>{VV##3046 : Data.Text.Internal.Text | $k_##3047}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>{VV##3049 : Web.Telegram.API.Bot.Data.Update | $k_##3050[lq_tmp$x##3045:=r##a4Maw]}</span><span class='hs-varid'>u</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem r ())</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : (((Polysemy.Internal.Union.Find lq_tmp$x##3342:(lq_tmp$x##3343:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##3344:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##3345:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect lq_tmp$x##3408:(lq_tmp$x##3409:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##3410:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##3411:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())), (Polysemy.Internal.CustomErrors.Redefined.IfStuck () GHC.Types.Constraint (Polysemy.Internal.Union.LocateEffect lq_tmp$x##3412:(lq_tmp$x##3413:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##3414:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##3415:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) (Polysemy.Internal.CustomErrors.Redefined.IfStuck [lq_tmp$x##3416:(lq_tmp$x##3417:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##3418:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)] GHC.Types.Constraint r (Polysemy.Internal.CustomErrors.AmbiguousSendError GHC.Types.Constraint 'Polysemy.Internal.CustomErrors.TyVarR r (UseCases.WWI.WWI lq_tmp$x##3422:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (Fcf.Combinators.Pure GHC.Types.Constraint (Polysemy.Internal.CustomErrors.AmbiguousSendError GHC.Types.Constraint (Polysemy.Internal.CustomErrors.UnstuckRState r) r (UseCases.WWI.WWI lq_tmp$x##3423:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))) (Fcf.Combinators.Pure GHC.Types.Constraint ()))) | VV ~~ (coerce (Tuple (Tuple (Polysemy.Internal.Union.ElemOf func(0 , [func(0 , [(GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (GHC.Prim.TYPE GHC.Types.LiftedRep)]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (GHC.Prim.TYPE GHC.Types.LiftedRep)]) (UseCases.WWI.WWI func(0 , [(GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (GHC.Prim.TYPE GHC.Types.LiftedRep)])) r##a4MiT) (GHC.Types.$126$ Tuple GHC.Tuple.$40$$41$ GHC.Tuple.$40$$41$)) Tuple) ~ (Tuple (Tuple (Polysemy.Internal.Union.ElemOf func(0 , [func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          GHC.Types.Type]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                GHC.Types.Type]) (UseCases.WWI.WWI func(0 , [(GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (GHC.Prim.TYPE GHC.Types.LiftedRep)])) r##a4MiT) (GHC.Types.$126$ Tuple (Polysemy.Internal.Union.LocateEffect func(0 , [func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               GHC.Types.Type]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (GHC.Prim.TYPE GHC.Types.LiftedRep)]) (UseCases.WWI.WWI func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       GHC.Types.Type])) r##a4MiT) GHC.Tuple.$40$$41$)) (Polysemy.Internal.CustomErrors.Redefined.IfStuck Tuple GHC.Types.Constraint (Polysemy.Internal.Union.LocateEffect func(0 , [func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               GHC.Types.Type]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (GHC.Prim.TYPE GHC.Types.LiftedRep)]) (UseCases.WWI.WWI func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       GHC.Types.Type])) r##a4MiT) (Polysemy.Internal.CustomErrors.Redefined.IfStuck [Polysemy.Internal.Kind.Effect] GHC.Types.Constraint r##a4MiT (Polysemy.Internal.CustomErrors.AmbiguousSendError GHC.Types.Constraint Polysemy.Internal.CustomErrors.TyVarR r##a4MiT (UseCases.WWI.WWI func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      GHC.Types.Type]))) (Fcf.Combinators.Pure GHC.Types.Constraint (Polysemy.Internal.CustomErrors.AmbiguousSendError GHC.Types.Constraint (Polysemy.Internal.CustomErrors.UnstuckRState r##a4MiT) r##a4MiT (UseCases.WWI.WWI func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         GHC.Types.Type]))))) (Fcf.Combinators.Pure GHC.Types.Constraint Type.Errors.NoError))) in $d(%,%)_a4Mo7)}</span><span class='hs-varid'>sendBackMsg</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3459 : ({lq_tmp$x##3453 : Data.Text.Internal.Text | $k_##2991[VV##2990:=lq_tmp$x##3453][VV##3001:=lq_tmp$x##3459][lq_tmp$x##3462:=r##a4Maw][lq_tmp$x##3463:=u##a4Max][r##a4MaI:=r##a4Maw][u##a4MaJ:=u##a4Max]}, {lq_tmp$x##3455 : (GHC.Maybe.Maybe {lq_tmp$x##3454 : Web.Telegram.API.Bot.Data.Update | $k_##2993[VV##2992:=lq_tmp$x##3454][VV##2994:=lq_tmp$x##3455][VV##3001:=lq_tmp$x##3459][lq_tmp$x##3462:=r##a4Maw][lq_tmp$x##3463:=u##a4Max][r##a4MaI:=r##a4Maw][u##a4MaJ:=u##a4Max]}) | $k_##2995[VV##2994:=lq_tmp$x##3455][VV##3001:=lq_tmp$x##3459][lq_tmp$x##3462:=r##a4Maw][lq_tmp$x##3463:=u##a4Max][r##a4MaI:=r##a4Maw][u##a4MaJ:=u##a4Max]})&lt;\lq_tmp$x##3464 VV -&gt; {lq_tmp$x##3458 : (GHC.Maybe.Maybe {lq_tmp$x##3457 : Web.Telegram.API.Bot.Data.Update | $k_##2998[VV##2997:=lq_tmp$x##3457][VV##2999:=lq_tmp$x##3458][VV##3001:=lq_tmp$x##3459][lq_tmp$x##2996:=lq_tmp$x##3464][lq_tmp$x##3456:=lq_tmp$x##3464][lq_tmp$x##3462:=r##a4Maw][lq_tmp$x##3463:=u##a4Max][r##a4MaI:=r##a4Maw][u##a4MaJ:=u##a4Max]}) | $k_##3000[VV##2999:=lq_tmp$x##3458][VV##3001:=lq_tmp$x##3459][lq_tmp$x##2996:=lq_tmp$x##3464][lq_tmp$x##3456:=lq_tmp$x##3464][lq_tmp$x##3462:=r##a4Maw][lq_tmp$x##3463:=u##a4Max][r##a4MaI:=r##a4Maw][u##a4MaJ:=u##a4Max]}&gt; | $k_##3002[VV##3001:=lq_tmp$x##3459][lq_tmp$x##3462:=r##a4Maw][lq_tmp$x##3463:=u##a4Max][r##a4MaI:=r##a4Maw][u##a4MaJ:=u##a4Max]}</span><span class='hs-varid'>theMsg</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3465 : Data.Text.Internal.Text | lq_tmp$x##3465 == r##a4Maw
                                            &amp;&amp; $k_##3047[VV##3046:=lq_tmp$x##3465]}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3466 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##3466 == u##a4Max
                                                     &amp;&amp; $k_##3050[VV##3049:=lq_tmp$x##3466][lq_tmp$x##3045:=r##a4Maw]}</span><span class='hs-varid'>u</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem r {lq_tmp$x##3754 : Data.Text.Internal.Text | $k_##3753[VV##3752:=lq_tmp$x##3754][lq_tmp$x##25:=r##a4Maw]})</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3755 : Data.Text.Internal.Text | lq_tmp$x##3755 == r##a4Maw
                                            &amp;&amp; $k_##3047[VV##3046:=lq_tmp$x##3755]}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum> 66: </span>
<span class=hs-linenum> 67: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>txtLen</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 68: </span>
<span class=hs-linenum> 69: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>numSpaces</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 70: </span><span class='hs-definition'>numSpaces</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> 
<span class=hs-linenum> 71: </span><span class='hs-definition'>numSpaces</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varop'>$</span> <span class='hs-varid'>words</span> <span class='hs-layout'>(</span><span class='hs-conid'>M.unpack</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span> 
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span>
<span class=hs-linenum> 74: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>gettheTelegram</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 75: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>BtwnXclu</span> <span class='hs-conid'>Lo</span> <span class='hs-conid'>V</span> <span class='hs-conid'>Hi</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lo</span> <span class='hs-varop'>&lt;</span> <span class='hs-conid'>V</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-conid'>V</span> <span class='hs-varop'>&lt;</span> <span class='hs-conid'>Hi</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 76: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>Lt</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>X</span> <span class='hs-varop'>&lt;</span> <span class='hs-conid'>Y</span>        <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 77: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>Ge</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lt</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 78: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>Lte</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>X</span> <span class='hs-varop'>&lt;=</span> <span class='hs-conid'>Y</span>        <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 79: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>Gt</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lte</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 80: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>Ne</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>X</span> <span class='hs-varop'>/=</span> <span class='hs-conid'>Y</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 81: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>TextNE</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>|</span> <span class='hs-num'>0</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>txtLen</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 82: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>LegitMultiWordPlaceName</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span> <span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Lte</span> <span class='hs-layout'>(</span><span class='hs-varid'>numSpaces</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-num'>3</span><span class='hs-layout'>}</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 83: </span>
<span class=hs-linenum> 84: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ValidInboundMsg</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>tlgm</span><span class='hs-conop'>:</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Lte</span> <span class='hs-layout'>(</span><span class='hs-varid'>numSpaces</span> <span class='hs-layout'>(</span><span class='hs-varid'>gettheTelegram</span> <span class='hs-varid'>tlgm</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-num'>3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-conid'>BtwnXclu</span> <span class='hs-num'>1</span> <span class='hs-layout'>(</span><span class='hs-varid'>txtLen</span> <span class='hs-layout'>(</span><span class='hs-varid'>gettheTelegram</span> <span class='hs-varid'>tlgm</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-num'>29</span> <span class='hs-layout'>}</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 85: </span>
<span class=hs-linenum> 86: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>apiGetTlgm</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ValidInboundMsg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 87: </span><span class='hs-definition'>apiGetTlgm</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum> 88: </span><span class='hs-definition'>apiGetTlgm</span> <span class='hs-varid'>updt</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 89: </span>                  <span class='hs-varid'>thisuserprefs</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>embed</span> <span class='hs-layout'>(</span><span class='hs-varid'>getPreferences</span> <span class='hs-varid'>uid</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 90: </span>                  <span class='hs-varid'>getWeatherTown</span> <span class='hs-varop'>$</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>resp</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thisuserprefs</span><span class='hs-layout'>}</span>
<span class=hs-linenum> 91: </span>            <span class='hs-keyword'>where</span> 
<span class=hs-linenum> 92: </span>                  <span class='hs-layout'>(</span><span class='hs-varid'>uid</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>tlgm</span><span class='hs-layout'>,</span> <span class='hs-varid'>resp</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getMeta</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>updt</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 93: </span>
<span class=hs-linenum> 94: </span><span class='hs-definition'>apiSetTlgm</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 95: </span><a class=annot href="#"><span class=annottext>forall r .
(GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r) '()), GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())) =&gt;
lq_tmp$x##2385:{VV##2386 : Web.Telegram.API.Bot.Data.Update | $k_##2387} -&gt; {VV##2392 : (Polysemy.Internal.Sem {VV##2388 : r | $k_##2389} {VV##2390 : () | $k_##2391}) | $k_##2393}</span><span class='hs-definition'>apiSetTlgm</span></a> <a class=annot href="#"><span class=annottext>{VV##2386 : Web.Telegram.API.Bot.Data.Update | $k_##2387}</span><span class='hs-varid'>updt</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2980 : ((Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r) '())) | lq_tmp$x##2980 == $d(%,%)_a4Mi1}</span><span class='hs-varid'>embed</span></a> <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-layout'>(</span></a><span class='hs-varid'>setPreferences</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2895 : Data.Text.Internal.Text | lq_tmp$x##2895 == uid##a4MaF
                                            &amp;&amp; $k_##2774[VV##2773:=lq_tmp$x##2895]}</span><span class='hs-varid'>uid</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2896 : Data.Text.Internal.Text | lq_tmp$x##2896 == resp##a4MaH
                                            &amp;&amp; $k_##2831[VV##2830:=lq_tmp$x##2896]}</span><span class='hs-varid'>resp</span></a><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 96: </span>                  <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##2773 : Data.Text.Internal.Text | $k_##2774}</span><span class='hs-varid'>uid</span></a><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>tlgm</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##2830 : Data.Text.Internal.Text | $k_##2831}</span><span class='hs-varid'>resp</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Text.Internal.Text, (Data.Text.Internal.Text, Data.Text.Internal.Text))</span><span class='hs-varid'>getMeta</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2587 : (GHC.Maybe.Maybe {lq_tmp$x##2592 : Web.Telegram.API.Bot.Data.Update | $k_##2591[VV##2590:=lq_tmp$x##2592][lq_tmp$x##2589:=updt##a4MaE]}) | isJust lq_tmp$x##2587
                                                                                                                                                             &amp;&amp; fromJust lq_tmp$x##2587 == updt##a4MaE
                                                                                                                                                             &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##2587 == updt##a4MaE}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Just</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2593 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##2593 == updt##a4MaE
                                                     &amp;&amp; $k_##2387[VV##2386:=lq_tmp$x##2593]}</span><span class='hs-varid'>updt</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 97: </span>
<span class=hs-linenum> 98: </span><span class='hs-definition'>theMsg</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>UserMsg</span>
<span class=hs-linenum> 99: </span><a class=annot href="#"><span class=annottext>r##a4MaI:{VV##2984 : Data.Text.Internal.Text | $k_##2985} -&gt; u##a4MaJ:{VV##2987 : Web.Telegram.API.Bot.Data.Update | $k_##2988} -&gt; {VV##3001 : ({VV##2990 : Data.Text.Internal.Text | $k_##2991}, {VV##2994 : (GHC.Maybe.Maybe {VV##2992 : Web.Telegram.API.Bot.Data.Update | $k_##2993}) | $k_##2995})&lt;\lq_tmp$x##2996 VV -&gt; {VV##2999 : (GHC.Maybe.Maybe {VV##2997 : Web.Telegram.API.Bot.Data.Update | $k_##2998}) | $k_##3000}&gt; | $k_##3002}</span><span class='hs-definition'>theMsg</span></a> <a class=annot href="#"><span class=annottext>{VV##2984 : Data.Text.Internal.Text | $k_##2985}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>{VV##2987 : Web.Telegram.API.Bot.Data.Update | $k_##2988}</span><span class='hs-varid'>u</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3040 : Data.Text.Internal.Text | lq_tmp$x##3040 == r##a4MaI
                                            &amp;&amp; $k_##2985[VV##2984:=lq_tmp$x##3040]}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3005 : (GHC.Maybe.Maybe {lq_tmp$x##3010 : Web.Telegram.API.Bot.Data.Update | $k_##3009[VV##3008:=lq_tmp$x##3010][lq_tmp$x##3007:=u##a4MaJ]}) | isJust lq_tmp$x##3005
                                                                                                                                                          &amp;&amp; fromJust lq_tmp$x##3005 == u##a4MaJ
                                                                                                                                                          &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##3005 == u##a4MaJ}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3011 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##3011 == u##a4MaJ
                                                     &amp;&amp; $k_##2988[VV##2987:=lq_tmp$x##3011]}</span><span class='hs-varid'>u</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UserMsg</span>
<span class=hs-linenum>100: </span>
<span class=hs-linenum>101: </span><span class='hs-definition'>getInfoPlainText</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>102: </span><span class='hs-definition'>getInfoPlainText</span> <span class='hs-varid'>plName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>embed</span> <span class='hs-layout'>(</span><span class='hs-varid'>getPreferences</span> <span class='hs-varid'>modalUser</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span>  <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>thisuserprefs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>getWeatherTown</span> <span class='hs-varop'>$</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plName</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thisuserprefs</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<span class=hs-linenum>103: </span>
<span class=hs-linenum>104: </span><span class='hs-definition'>apiGetPlainText</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>105: </span><span class='hs-definition'>apiGetPlainText</span> <span class='hs-varid'>plName</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>embed</span> <span class='hs-layout'>(</span><span class='hs-varid'>getPreferences</span> <span class='hs-varid'>modalUser</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span>  <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>thisuserprefs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>getWeatherTown</span> <span class='hs-varop'>$</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plName</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thisuserprefs</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<span class=hs-linenum>106: </span>
<span class=hs-linenum>107: </span><span class='hs-definition'>apiSetPlainText</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>108: </span><span class='hs-definition'>apiSetPlainText</span> <span class='hs-varid'>plName</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pure</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>109: </span>
<span class=hs-linenum>110: </span><span class='hs-definition'>isValidPreferencesJSON</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>String</span> <span class='hs-conid'>Preferences</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>111: </span><a class=annot href="#"><span class=annottext>json##a4MaP:{VV##3800 : (Data.Either.Either {VV##3796 : [{VV##3791 : GHC.Types.Char | $k_##3792}]&lt;\lq_tmp$x##3793 VV -&gt; {VV##3794 : GHC.Types.Char | $k_##3795}&gt; | $k_##3797} {VV##3798 : InterfaceAdapters.Preferences.Preferences | $k_##3799}) | $k_##3801} -&gt; {VV##3803 : GHC.Types.Bool | $k_##3804}</span><span class='hs-definition'>isValidPreferencesJSON</span></a> <a class=annot href="#"><span class=annottext>{VV##3800 : (Data.Either.Either {VV##3796 : [{VV##3791 : GHC.Types.Char | $k_##3792}]&lt;\lq_tmp$x##3793 VV -&gt; {VV##3794 : GHC.Types.Char | $k_##3795}&gt; | $k_##3797} {VV##3798 : InterfaceAdapters.Preferences.Preferences | $k_##3799}) | $k_##3801}</span><span class='hs-varid'>json</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3810 : (Data.Either.Either {lq_tmp$x##3808 : [{lq_tmp$x##3805 : GHC.Types.Char | $k_##3792[VV##3791:=lq_tmp$x##3805][VV##3796:=lq_tmp$x##3808][VV##3800:=lq_tmp$x##3810]}]&lt;\lq_tmp$x##3811 VV -&gt; {lq_tmp$x##3807 : GHC.Types.Char | $k_##3795[VV##3794:=lq_tmp$x##3807][VV##3796:=lq_tmp$x##3808][VV##3800:=lq_tmp$x##3810][lq_tmp$x##3793:=lq_tmp$x##3811][lq_tmp$x##3806:=lq_tmp$x##3811]}&gt; | $k_##3797[VV##3796:=lq_tmp$x##3808][VV##3800:=lq_tmp$x##3810]} {lq_tmp$x##3809 : InterfaceAdapters.Preferences.Preferences | $k_##3799[VV##3798:=lq_tmp$x##3809][VV##3800:=lq_tmp$x##3810]}) | lq_tmp$x##3810 == json##a4MaP
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &amp;&amp; $k_##3801[VV##3800:=lq_tmp$x##3810]}</span><span class='hs-varid'>json</span></a> <span class='hs-keyword'>of</span> 
<span class=hs-linenum>112: </span>            <span class='hs-conid'>Left</span> <span class='hs-varid'>invalid</span>                          <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3834 : GHC.Types.Bool | not lq_tmp$x##3834
                                   &amp;&amp; lq_tmp$x##3834 == GHC.Types.False}</span><span class='hs-conid'>False</span></a> 
<span class=hs-linenum>113: </span>            <span class='hs-conid'>Right</span> <span class='hs-layout'>(</span><span class='hs-conid'>Preferences</span> <span class='hs-varid'>uData</span> <span class='hs-varid'>uSize</span> <span class='hs-varid'>uSpan</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3881 : GHC.Types.Bool | lq_tmp$x##3881
                                   &amp;&amp; lq_tmp$x##3881 == GHC.Types.True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum>114: </span>
<span class=hs-linenum>115: </span><span class='hs-comment'>-- TO DO - use shortcircuit to do only one of the Left's !</span>
<span class=hs-linenum>116: </span><span class='hs-keyword'>{-@</span>  <span class='hs-varid'>rejectInvalid</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>o</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>117: </span><span class='hs-definition'>rejectInvalid</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>118: </span><span class='hs-definition'>rejectInvalid</span> <span class='hs-varid'>this</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-layout'>(</span><span class='hs-varid'>rejectionsLeft</span><span class='hs-layout'>,</span><span class='hs-varid'>oksRight</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span> 
<span class=hs-linenum>119: </span>                  <span class='hs-layout'>(</span><span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span> <span class='hs-comment'>-- i.e no (Left _) rejections and at least one (Right _) List item</span>
<span class=hs-linenum>120: </span>                  <span class='hs-keyword'>_</span>         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-str'>"Invalid"</span> 
<span class=hs-linenum>121: </span>            <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varid'>rejectionsLeft</span><span class='hs-layout'>,</span><span class='hs-varid'>oksRight</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>partitionEithers</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>placeLikeMinText</span> <span class='hs-varid'>this</span><span class='hs-layout'>,</span> <span class='hs-varid'>placeLikeMaxText</span> <span class='hs-varid'>this</span><span class='hs-layout'>,</span> <span class='hs-varid'>placeHasExcessiveWords</span> <span class='hs-varid'>this</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>122: </span>
<span class=hs-linenum>123: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assume</span> <span class='hs-conid'>M.pack</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>i</span><span class='hs-conop'>:</span><span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{o:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyword'>| len i == txtLen o }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>124: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assume</span> <span class='hs-conid'>M.unpack</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>i</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{o:</span><span class='hs-conid'>String</span> <span class='hs-keyword'>| len o == txtLen i }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>125: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assume</span> <span class='hs-conid'>Data.String.fromString</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-keyword'>_</span> <span class='hs-keyword'>| v ~~ x}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>126: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assume</span> <span class='hs-varid'>words</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>i</span><span class='hs-conop'>:</span><span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{o:</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>String</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| (len i) - len o &gt;= 0 }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>127: </span>
<span class=hs-linenum>128: </span>
<span class=hs-linenum>129: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>placeLikeMinText</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rv</span> <span class='hs-conop'>:</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyword'>{rght:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyword'>| 1 &lt; txtLen rght &amp;&amp; txtLen x == txtLen rght}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>130: </span><span class='hs-definition'>placeLikeMinText</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>T.Text</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>131: </span><span class='hs-definition'>placeLikeMinText</span> <span class='hs-varid'>y</span>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-conid'>M.unpack</span> <span class='hs-varid'>y</span> <span class='hs-keyword'>of</span> 
<span class=hs-linenum>132: </span>                        <span class='hs-layout'>(</span><span class='hs-varid'>u</span><span class='hs-conop'>:</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Right</span> <span class='hs-varid'>y</span>
<span class=hs-linenum>133: </span>                        <span class='hs-keyword'>_</span>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Left</span> <span class='hs-str'>"Invalid"</span>  
<span class=hs-linenum>134: </span>
<span class=hs-linenum>135: </span><span class='hs-comment'>-- 28 char long Venkatanarasimharajuvaripeta is a place in Andhra Pradesh</span>
<span class=hs-linenum>136: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>placeLikeMaxText</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rv</span> <span class='hs-conop'>:</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyword'>{rght:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyword'>| 29 &gt; txtLen rght &amp;&amp; txtLen x == txtLen rght}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>137: </span><span class='hs-definition'>placeLikeMaxText</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>T.Text</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>138: </span><span class='hs-definition'>placeLikeMaxText</span> <span class='hs-varid'>y</span>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-conid'>M.unpack</span> <span class='hs-varid'>y</span> <span class='hs-keyword'>of</span> 
<span class=hs-linenum>139: </span>                        <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-conop'>:</span><span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-varid'>c</span><span class='hs-conop'>:</span><span class='hs-varid'>d</span><span class='hs-conop'>:</span><span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-varid'>h</span><span class='hs-conop'>:</span><span class='hs-varid'>i</span><span class='hs-conop'>:</span><span class='hs-varid'>j</span><span class='hs-conop'>:</span><span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-varid'>l</span><span class='hs-conop'>:</span><span class='hs-varid'>m</span><span class='hs-conop'>:</span><span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-varid'>o</span><span class='hs-conop'>:</span><span class='hs-varid'>p</span><span class='hs-conop'>:</span><span class='hs-varid'>q</span><span class='hs-conop'>:</span><span class='hs-varid'>r</span><span class='hs-conop'>:</span><span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-varid'>u</span><span class='hs-conop'>:</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-varid'>w</span><span class='hs-conop'>:</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>y</span><span class='hs-conop'>:</span><span class='hs-varid'>z</span><span class='hs-conop'>:</span><span class='hs-varid'>a1</span><span class='hs-conop'>:</span><span class='hs-varid'>a2</span><span class='hs-conop'>:</span><span class='hs-varid'>a3</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Left</span> <span class='hs-str'>"Invalid"</span>
<span class=hs-linenum>140: </span>                        <span class='hs-keyword'>_</span>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Right</span> <span class='hs-varid'>y</span>
<span class=hs-linenum>141: </span>
<span class=hs-linenum>142: </span><span class='hs-comment'>-- Gopalpur on the sea is the valid one I can think of, so 4</span>
<span class=hs-linenum>143: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>placeHasExcessiveWords</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rv</span> <span class='hs-conop'>:</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyword'>{rght:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyword'>| txtLen x == txtLen rght}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>144: </span><span class='hs-definition'>placeHasExcessiveWords</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>T.Text</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>145: </span><span class='hs-definition'>placeHasExcessiveWords</span> <span class='hs-varid'>y</span>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>words</span> <span class='hs-varop'>$</span> <span class='hs-conid'>M.unpack</span> <span class='hs-varid'>y</span> <span class='hs-keyword'>of</span> 
<span class=hs-linenum>146: </span>                        <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-conop'>:</span><span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-varid'>c</span><span class='hs-conop'>:</span><span class='hs-varid'>d</span><span class='hs-conop'>:</span><span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Left</span> <span class='hs-str'>"Invalid"</span> 
<span class=hs-linenum>147: </span>                        <span class='hs-keyword'>_</span>             <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Right</span> <span class='hs-varid'>y</span>                        </pre>
</body>
</html>