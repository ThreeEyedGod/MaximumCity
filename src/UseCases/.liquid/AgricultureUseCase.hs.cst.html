<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/UseCases/AgricultureUseCase.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><span class='hs-comment'>{-# LANGUAGE BlockArguments, GADTs, FlexibleContexts, FlexibleInstances, DataKinds, PolyKinds, ScopedTypeVariables #-}</span>
<span class=hs-linenum>  2: </span><span class='hs-comment'>{-# LANGUAGE QuasiQuotes #-}</span>
<span class=hs-linenum>  3: </span><span class='hs-comment'>{-# Language PartialTypeSignatures #-}</span>
<span class=hs-linenum>  4: </span><span class='hs-comment'>{-# Language NamedWildCards #-}</span>
<span class=hs-linenum>  5: </span><span class='hs-comment'>{-# LANGUAGE OverloadedStrings #-}</span>
<span class=hs-linenum>  6: </span>
<span class=hs-linenum>  7: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-totality"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  8: </span><span class='hs-comment'>--{-@ LIQUID "--skip-module" @-}</span>
<span class=hs-linenum>  9: </span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>UseCases.AgricultureUseCase</span> <span class='hs-layout'>(</span><span class='hs-varid'>getInfoTlgm</span><span class='hs-layout'>,</span> <span class='hs-varid'>getInfoPlainText</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 11: </span><span class='hs-keyword'>where</span>
<span class=hs-linenum> 12: </span>
<span class=hs-linenum> 13: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy</span> <span class='hs-layout'>(</span> <span class='hs-conid'>Sem</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span><span class='hs-layout'>,</span> <span class='hs-conid'>Embed</span><span class='hs-layout'>,</span> <span class='hs-varid'>embed</span><span class='hs-layout'>,</span> <span class='hs-conid'>Members</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 14: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy.Error</span>
<span class=hs-linenum> 15: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy.Input</span>           <span class='hs-conid'>()</span>
<span class=hs-linenum> 16: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy.Trace</span>           <span class='hs-layout'>(</span><span class='hs-conid'>Trace</span><span class='hs-layout'>,</span> <span class='hs-varid'>trace</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 17: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>UseCases.WWI</span>             <span class='hs-layout'>(</span><span class='hs-conid'>WWI</span><span class='hs-layout'>,</span> <span class='hs-conid'>PlaceName</span><span class='hs-layout'>,</span> <span class='hs-conid'>TheWeatherThere</span><span class='hs-layout'>,</span> <span class='hs-varid'>getWeatherTown</span><span class='hs-layout'>,</span> <span class='hs-varid'>sendBackMsg</span><span class='hs-layout'>,</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>UserMsg</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Preferences</span> <span class='hs-layout'>(</span> <span class='hs-varid'>modalUser</span><span class='hs-layout'>,</span> <span class='hs-varid'>setPreferences</span><span class='hs-layout'>,</span> <span class='hs-varid'>getPreferences</span><span class='hs-layout'>,</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 19: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Telegram.Telegram</span> <span class='hs-layout'>(</span>
<span class=hs-linenum> 20: </span>        <span class='hs-varid'>getUserIdNumber</span>
<span class=hs-linenum> 21: </span>      <span class='hs-layout'>,</span> <span class='hs-conid'>User</span> <span class='hs-layout'>(</span><span class='hs-varid'>user_id</span><span class='hs-layout'>,</span> <span class='hs-varid'>user_first_name</span> <span class='hs-layout'>,</span> <span class='hs-varid'>user_last_name</span><span class='hs-layout'>,</span> <span class='hs-varid'>user_username</span><span class='hs-layout'>,</span> <span class='hs-varid'>user_language_code</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 22: </span>      <span class='hs-layout'>,</span> <span class='hs-varid'>getUpdate_id</span>
<span class=hs-linenum> 23: </span>      <span class='hs-layout'>,</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 24: </span>      <span class='hs-layout'>,</span> <span class='hs-varid'>gettheTelegram</span>
<span class=hs-linenum> 25: </span>      <span class='hs-layout'>,</span> <span class='hs-varid'>getMeta</span>
<span class=hs-linenum> 26: </span>      <span class='hs-layout'>,</span> <span class='hs-varid'>getUserId</span>
<span class=hs-linenum> 27: </span>      <span class='hs-layout'>,</span> <span class='hs-conid'>Update</span><span class='hs-layout'>(</span><span class='hs-conid'>Update</span><span class='hs-layout'>,</span> <span class='hs-varid'>message</span><span class='hs-layout'>,</span> <span class='hs-varid'>update_id</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 28: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Utils.Helper</span>
<span class=hs-linenum> 29: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>AWSLambda</span> <span class='hs-layout'>(</span><span class='hs-varid'>responseBody</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 30: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text.Internal</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<span class=hs-linenum> 31: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>M</span>
<span class=hs-linenum> 32: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Either</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromRight</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 33: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.ByteString.Lazy.UTF8</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromString</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- from utf8-string</span>
<span class=hs-linenum> 34: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Text.RawString.QQ</span>
<span class=hs-linenum> 35: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Aeson</span> <span class='hs-layout'>(</span><span class='hs-varid'>eitherDecode</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 36: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text.Lazy.Encoding</span> <span class='hs-layout'>(</span><span class='hs-varid'>encodeUtf8</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 37: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text.Lazy</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromStrict</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 38: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Utils.ShortCircuit</span> <span class='hs-layout'>(</span><span class='hs-conid'>HasTrue</span><span class='hs-layout'>,</span> <span class='hs-conid'>Shortcircuit</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>andM</span><span class='hs-layout'>,</span> <span class='hs-varid'>firstFalseOf</span><span class='hs-layout'>,</span> <span class='hs-varid'>firstFalseOfM</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 39: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Either</span> <span class='hs-layout'>(</span><span class='hs-varid'>isRight</span><span class='hs-layout'>,</span> <span class='hs-varid'>partitionEithers</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 40: </span>
<span class=hs-linenum> 41: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Web.Telegram.API.Bot.Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Message</span><span class='hs-layout'>,</span> <span class='hs-conid'>Message</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Message</span><span class='hs-layout'>(</span><span class='hs-varid'>text</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span><span class='hs-conid'>User</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 42: </span>
<span class=hs-linenum> 43: </span><span class='hs-comment'>-- Liquid Haskell imports</span>
<span class=hs-linenum> 44: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Polysemy.Internal</span> <span class='hs-layout'>(</span><span class='hs-conid'>Sem</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 45: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text.Lazy</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Tx</span>
<span class=hs-linenum> 46: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text.Internal.Lazy</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TL</span>
<span class=hs-linenum> 47: </span>
<span class=hs-linenum> 48: </span><span class='hs-definition'>getInfoTlgm</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum> 49: </span><a class=annot href="#"><span class=annottext>forall r .
(GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find lq_tmp$x##1008:(lq_tmp$x##1009:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1010:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect lq_tmp$x##1011:(lq_tmp$x##1012:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1013:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r) '()), GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find lq_tmp$x##1015:(lq_tmp$x##1016:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1017:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1018:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect lq_tmp$x##1019:(lq_tmp$x##1020:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1021:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1022:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())) =&gt;
lq_tmp$x##4728:Web.Telegram.API.Bot.Data.Update -&gt; (Polysemy.Internal.Sem r Data.Text.Internal.Text)</span><span class='hs-definition'>getInfoTlgm</span></a> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Data.Update</span><span class='hs-varid'>updt</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Update</span> <span class='hs-layout'>{</span><span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>m</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 50: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5886 : GHC.Types.Bool | $k_##5885[VV##5884:=lq_tmp$x##5886][lq_tmp$db##13:=UseCases.AgricultureUseCase.isValidPreferencesJSON][lq_tmp$db##15:=lq_anf$##7205759403794047659##d5geL][xcmp:=resp##a5fJz]
                                   &amp;&amp; $k_##5891[VV##5890:=lq_tmp$x##5886][lq_tmp$db##13:=UseCases.AgricultureUseCase.isValidPreferencesJSON][lq_tmp$db##15:=lq_anf$##7205759403794047659##d5geL][lq_tmp$x##5892:=resp##a5fJz][xcmp:=resp##a5fJz]}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##5922:{lq_tmp$x##5918 : (Data.Either.Either {lq_tmp$x##5916 : [{lq_tmp$x##5913 : GHC.Types.Char | $k_##3877[VV##3876:=lq_tmp$x##5913][VV##3881:=lq_tmp$x##5916][VV##3885:=lq_tmp$x##5918]}]&lt;\lq_tmp$x##5923 VV -&gt; {lq_tmp$x##5915 : GHC.Types.Char | $k_##3880[VV##3879:=lq_tmp$x##5915][VV##3881:=lq_tmp$x##5916][VV##3885:=lq_tmp$x##5918][lq_tmp$x##3878:=lq_tmp$x##5923][lq_tmp$x##5914:=lq_tmp$x##5923][lq_tmp$x##5921:=lq_tmp$x##5923]}&gt; | $k_##3882[VV##3881:=lq_tmp$x##5916][VV##3885:=lq_tmp$x##5918]} {lq_tmp$x##5917 : InterfaceAdapters.Preferences.Preferences | $k_##3884[VV##3883:=lq_tmp$x##5917][VV##3885:=lq_tmp$x##5918]}) | $k_##3886[VV##3885:=lq_tmp$x##5918]} -&gt; {lq_tmp$x##5919 : GHC.Types.Bool | $k_##3889[VV##3888:=lq_tmp$x##5919][json##a5fJY:=lq_tmp$x##5922]}</span><span class='hs-varid'>isValidPreferencesJSON</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5756:Data.ByteString.Lazy.Internal.ByteString -&gt; (Data.Either.Either [GHC.Types.Char] InterfaceAdapters.Preferences.Preferences)</span><span class='hs-varid'>eitherDecode</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5789:Data.Text.Internal.Lazy.Text -&gt; Data.ByteString.Lazy.Internal.ByteString</span><span class='hs-varid'>encodeUtf8</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5793:Data.Text.Internal.Text -&gt; Data.Text.Internal.Lazy.Text</span><span class='hs-varid'>fromStrict</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5934 : Data.Text.Internal.Text | lq_tmp$x##5934 == resp##a5fJz
                                            &amp;&amp; $k_##5682[VV##5681:=lq_tmp$x##5934]}</span><span class='hs-varid'>resp</span></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-comment'>-- if preferences are valid and a JSON format ....</span>
<span class=hs-linenum> 51: </span>                  <a class=annot href="#"><span class=annottext>{lq_tmp$x##8496 : (Polysemy.Internal.Sem {lq_tmp$x##8503 : r | $k_##2356[fix$36$$36$d$40$$37$$44$$37$$41$_a5fQE:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRI][fix$36$$36$d$40$$37$$44$$37$$41$_a5fQF:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][VV##2355:=lq_tmp$x##8503][VV##2359:=lq_tmp$x##8496][lq_tmp$x##2352:=updt##a5fJv][lq_tmp$x##8494:=lq_tmp$x##8503][lq_tmp$x##8500:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRI][lq_tmp$x##8501:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][lq_tmp$x##8502:=updt##a5fJv]} {lq_tmp$x##8495 : () | $k_##2358[fix$36$$36$d$40$$37$$44$$37$$41$_a5fQE:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRI][fix$36$$36$d$40$$37$$44$$37$$41$_a5fQF:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][VV##2357:=lq_tmp$x##8495][VV##2359:=lq_tmp$x##8496][lq_tmp$x##2352:=updt##a5fJv][lq_tmp$x##8500:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRI][lq_tmp$x##8501:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][lq_tmp$x##8502:=updt##a5fJv]}) | $k_##2360[fix$36$$36$d$40$$37$$44$$37$$41$_a5fQE:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRI][fix$36$$36$d$40$$37$$44$$37$$41$_a5fQF:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][VV##2359:=lq_tmp$x##8496][lq_tmp$x##2352:=updt##a5fJv][lq_tmp$x##8500:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRI][lq_tmp$x##8501:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][lq_tmp$x##8502:=updt##a5fJv]}</span><span class='hs-varid'>apiSetTlgm</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##8580 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##8580 == updt##a5fJv}</span><span class='hs-varid'>updt</span></a> 
<span class=hs-linenum> 52: </span>                  <a class=annot href="#"><span class=annottext>{lq_tmp$x##8628 : (Polysemy.Internal.Sem {lq_tmp$x##8635 : r | $k_##3019[fix$36$$36$d$40$$37$$44$$37$$41$_a5fRn:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][VV##3018:=lq_tmp$x##8635][VV##3022:=lq_tmp$x##8628][lq_tmp$x##3012:=resp##a5fJz][lq_tmp$x##3015:=updt##a5fJv][lq_tmp$x##8626:=lq_tmp$x##8635][lq_tmp$x##8632:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][lq_tmp$x##8633:=resp##a5fJz][lq_tmp$x##8634:=updt##a5fJv]} {lq_tmp$x##8627 : Data.Text.Internal.Text | $k_##3021[fix$36$$36$d$40$$37$$44$$37$$41$_a5fRn:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][VV##3020:=lq_tmp$x##8627][VV##3022:=lq_tmp$x##8628][lq_tmp$x##3012:=resp##a5fJz][lq_tmp$x##3015:=updt##a5fJv][lq_tmp$x##8632:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][lq_tmp$x##8633:=resp##a5fJz][lq_tmp$x##8634:=updt##a5fJv]}) | $k_##3023[fix$36$$36$d$40$$37$$44$$37$$41$_a5fRn:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][VV##3022:=lq_tmp$x##8628][lq_tmp$x##3012:=resp##a5fJz][lq_tmp$x##3015:=updt##a5fJv][lq_tmp$x##8632:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][lq_tmp$x##8633:=resp##a5fJz][lq_tmp$x##8634:=updt##a5fJv]}</span><span class='hs-varid'>outBoundRespond</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##8678 : Data.Text.Internal.Text | lq_tmp$x##8678 == resp##a5fJz
                                            &amp;&amp; $k_##5682[VV##5681:=lq_tmp$x##8678]}</span><span class='hs-varid'>resp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##8679 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##8679 == updt##a5fJv}</span><span class='hs-varid'>updt</span></a>
<span class=hs-linenum> 53: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 54: </span>            <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5959 : Data.Text.Internal.Text | lq_tmp$x##5959 == resp##a5fJz
                                            &amp;&amp; $k_##5682[VV##5681:=lq_tmp$x##5959]}</span><span class='hs-varid'>resp</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5960 : Data.Text.Internal.Text | lq_tmp$x##5960 == tlgm##a5fJy
                                            &amp;&amp; $k_##5625[VV##5624:=lq_tmp$x##5960]}</span><span class='hs-varid'>tlgm</span></a> <span class='hs-keyword'>then</span>
<span class=hs-linenum> 55: </span>                  <span class='hs-keyword'>case</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##6076 : [GHC.Types.Char] | len lq_tmp$x##6076 == txtLen respChecked##a5fJA}</span><span class='hs-conid'>M.unpack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6080 : Data.Text.Internal.Text | lq_tmp$x##6080 == respChecked##a5fJA}</span><span class='hs-varid'>respChecked</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6097 : GHC.Types.Int | lq_tmp$x##6097 == len lq_anf$##7205759403794047664##d5geQ
                                  &amp;&amp; lq_tmp$x##6097 &gt;= 0}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6086 : [GHC.Types.Char] | len lq_tmp$x##6086 == txtLen respChecked##a5fJA}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>M.unpack</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6090 : Data.Text.Internal.Text | lq_tmp$x##6090 == respChecked##a5fJA}</span><span class='hs-varid'>respChecked</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6121 : GHC.Types.Int | lq_tmp$x##6121 == (lq_anf$##7205759403794047666##d5geS : int)}</span><span class='hs-num'>29</span></a><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 56: </span>                        <span class='hs-layout'>(</span><span class='hs-varid'>u1</span><span class='hs-conop'>:</span><span class='hs-varid'>u2</span><span class='hs-conop'>:</span><span class='hs-varid'>rx</span><span class='hs-layout'>,</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 57: </span>                              <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>responseBody</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem r Data.Text.Internal.Text)</span><span class='hs-varid'>apiGetTlgm</span></a> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Data.Update</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Update</span> <span class='hs-layout'>{</span><span class='hs-varid'>update_id</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>getUpdate_id</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6673 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##6673 == updt##a5fJv}</span><span class='hs-varid'>updt</span></a><span class='hs-layout'>}</span> <span class='hs-layout'>{</span><span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##8076 : (GHC.Maybe.Maybe {lq_tmp$x##8081 : Web.Telegram.API.Bot.Data.Message | $k_##8080[VV##8079:=lq_tmp$x##8081][lq_tmp$x##8078:=lq_anf$##7205759403794047747##d5ggb]}) | isJust lq_tmp$x##8076
                                                                                                                                                                                      &amp;&amp; fromJust lq_tmp$x##8076 == lq_anf$##7205759403794047747##d5ggb
                                                                                                                                                                                      &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##8076 == lq_anf$##7205759403794047747##d5ggb}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Data.Message</span><span class='hs-conid'>Message</span></a> <span class='hs-layout'>{</span><span class='hs-varid'>text</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7120 : (GHC.Maybe.Maybe {lq_tmp$x##7125 : Data.Text.Internal.Text | $k_##7124[VV##7123:=lq_tmp$x##7125][lq_tmp$x##7122:=ds_d5g7f]}) | isJust lq_tmp$x##7120
                                                                                                                                                 &amp;&amp; fromJust lq_tmp$x##7120 == ds_d5g7f
                                                                                                                                                 &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##7120 == ds_d5g7f}</span><span class='hs-conid'>Just</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7104 : Data.Text.Internal.Text | len lq_anf$##7205759403794047703##d5gft == txtLen lq_tmp$x##7104}</span><span class='hs-conid'>M.pack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7078 : [{lq_tmp$x##7088 : GHC.Types.Char | $k_##7087[VV##7086:=lq_tmp$x##7088][lq_tmp$x##7082:=u1##a5fJB][lq_tmp$x##7083:=lq_anf$##7205759403794047702##d5gfs]}]&lt;\lq_tmp$x##7085 VV -&gt; {lq_tmp$x##7088 : GHC.Types.Char | $k_##7090[VV##7089:=lq_tmp$x##7088][lq_tmp$x##7082:=u1##a5fJB][lq_tmp$x##7083:=lq_anf$##7205759403794047702##d5gfs][lq_tmp$x##7091:=lq_tmp$x##7085]}&gt; | head lq_tmp$x##7078 == u1##a5fJB
                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; len lq_tmp$x##7078 == 1 + len lq_anf$##7205759403794047702##d5gfs
                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; tail lq_tmp$x##7078 == lq_anf$##7205759403794047702##d5gfs}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##7093 : GHC.Types.Char | lq_tmp$x##7093 == u1##a5fJB}</span><span class='hs-varid'>u1</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##7063 : GHC.Types.Char | lq_tmp$x##7063 == u2##a5fJC}</span><span class='hs-varid'>u2</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##7067 : [GHC.Types.Char] | lq_tmp$x##7067 == rx##a5fJD
                                     &amp;&amp; len lq_tmp$x##7067 &gt;= 0}</span><span class='hs-varid'>rx</span></a><span class='hs-layout'>)</span><span class='hs-layout'>}</span><span class='hs-layout'>{</span><span class='hs-varid'>from</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7773 : (GHC.Maybe.Maybe {lq_tmp$x##7778 : Web.Telegram.API.Bot.Data.User | $k_##7777[VV##7776:=lq_tmp$x##7778][lq_tmp$x##7775:=lq_anf$##7205759403794047745##d5gg9]}) | isJust lq_tmp$x##7773
                                                                                                                                                                                   &amp;&amp; fromJust lq_tmp$x##7773 == lq_anf$##7205759403794047745##d5gg9
                                                                                                                                                                                   &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##7773 == lq_anf$##7205759403794047745##d5gg9}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Data.User</span><span class='hs-conid'>User</span></a> <span class='hs-layout'>{</span><span class='hs-varid'>user_id</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>getUserIdNumber</span></a> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.User)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>from</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7650 : Web.Telegram.API.Bot.Data.Message | lq_tmp$x##7650 == m##a5fJw}</span><span class='hs-varid'>m</span></a><span class='hs-layout'>)</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 58: </span>                              <a class=annot href="#"><span class=annottext>{lq_tmp$x##8355 : (Polysemy.Internal.Sem {lq_tmp$x##8362 : r | $k_##3019[fix$36$$36$d$40$$37$$44$$37$$41$_a5fRn:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][VV##3018:=lq_tmp$x##8362][VV##3022:=lq_tmp$x##8355][lq_tmp$x##3012:=responseBody##a5fJE][lq_tmp$x##3015:=updt##a5fJv][lq_tmp$x##8353:=lq_tmp$x##8362][lq_tmp$x##8359:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][lq_tmp$x##8360:=responseBody##a5fJE][lq_tmp$x##8361:=updt##a5fJv]} {lq_tmp$x##8354 : Data.Text.Internal.Text | $k_##3021[fix$36$$36$d$40$$37$$44$$37$$41$_a5fRn:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][VV##3020:=lq_tmp$x##8354][VV##3022:=lq_tmp$x##8355][lq_tmp$x##3012:=responseBody##a5fJE][lq_tmp$x##3015:=updt##a5fJv][lq_tmp$x##8359:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][lq_tmp$x##8360:=responseBody##a5fJE][lq_tmp$x##8361:=updt##a5fJv]}) | $k_##3023[fix$36$$36$d$40$$37$$44$$37$$41$_a5fRn:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][VV##3022:=lq_tmp$x##8355][lq_tmp$x##3012:=responseBody##a5fJE][lq_tmp$x##3015:=updt##a5fJv][lq_tmp$x##8359:=fix$36$$36$d$40$$37$$44$$37$$41$_a5fRJ][lq_tmp$x##8360:=responseBody##a5fJE][lq_tmp$x##8361:=updt##a5fJv]}</span><span class='hs-varid'>outBoundRespond</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##8405 : Data.Text.Internal.Text | lq_tmp$x##8405 == responseBody##a5fJE}</span><span class='hs-varid'>responseBody</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##8406 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##8406 == updt##a5fJv}</span><span class='hs-varid'>updt</span></a>
<span class=hs-linenum> 59: </span>                        <span class='hs-keyword'>_</span>          <span class='hs-keyglyph'>-&gt;</span>  <a class=annot href="#"><span class=annottext>{lq_tmp$x##6661 : ((Polysemy.Internal.Union.Find lq_tmp$x##1015:(lq_tmp$x##1016:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1017:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1018:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect lq_tmp$x##1019:(lq_tmp$x##1020:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1021:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1022:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())) | lq_tmp$x##6661 == $d(%,%)_a5fRJ}</span><span class='hs-varid'>outBoundRespond</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6557 : Data.Text.Internal.Text | lq_tmp$x##6557 ~~ lq_anf$##7205759403794047678##d5gf4}</span><span class='hs-str'>"Place Name is of incorrect length"</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6663 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##6663 == updt##a5fJv}</span><span class='hs-varid'>updt</span></a>
<span class=hs-linenum> 60: </span>            <span class='hs-keyword'>else</span> 
<span class=hs-linenum> 61: </span>                        <a class=annot href="#"><span class=annottext>{lq_tmp$x##6064 : ((Polysemy.Internal.Union.Find lq_tmp$x##1015:(lq_tmp$x##1016:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1017:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1018:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect lq_tmp$x##1019:(lq_tmp$x##1020:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##1021:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##1022:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())) | lq_tmp$x##6064 == $d(%,%)_a5fRJ}</span><span class='hs-varid'>outBoundRespond</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6065 : Data.Text.Internal.Text | lq_tmp$x##6065 == resp##a5fJz
                                            &amp;&amp; $k_##5682[VV##5681:=lq_tmp$x##6065]}</span><span class='hs-varid'>resp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6066 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##6066 == updt##a5fJv}</span><span class='hs-varid'>updt</span></a>
<span class=hs-linenum> 62: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum> 63: </span>            <span class='hs-layout'>(</span><span class='hs-varid'>uuid</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##5624 : Data.Text.Internal.Text | $k_##5625}</span><span class='hs-varid'>tlgm</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##5681 : Data.Text.Internal.Text | $k_##5682}</span><span class='hs-varid'>resp</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Text.Internal.Text, (Data.Text.Internal.Text, Data.Text.Internal.Text))</span><span class='hs-varid'>getMeta</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5438 : (GHC.Maybe.Maybe {lq_tmp$x##5443 : Web.Telegram.API.Bot.Data.Update | $k_##5442[VV##5441:=lq_tmp$x##5443][lq_tmp$x##5440:=updt##a5fJv]}) | isJust lq_tmp$x##5438
                                                                                                                                                             &amp;&amp; fromJust lq_tmp$x##5438 == updt##a5fJv
                                                                                                                                                             &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##5438 == updt##a5fJv}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Just</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5444 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##5444 == updt##a5fJv}</span><span class='hs-varid'>updt</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 64: </span>            <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>respChecked</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>rejectInvalid</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5742 : Data.Text.Internal.Text | lq_tmp$x##5742 == resp##a5fJz
                                            &amp;&amp; $k_##5682[VV##5681:=lq_tmp$x##5742]}</span><span class='hs-varid'>resp</span></a>
<span class=hs-linenum> 65: </span><span class='hs-definition'>getInfoTlgm</span> <span class='hs-varid'>updt</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Update</span> <span class='hs-layout'>{</span><span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Base.Applicative (Polysemy.Internal.Sem r))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a6hX b##a6hY .
      lq_tmp$x##5278:(a##a6hX, b##a6hY) -&gt; {lq_tmp$x##5275 : a##a6hX | lq_tmp$x##5275 == fst lq_tmp$x##5278} | VV == Data.Tuple.fst}</span><span class='hs-varid'>fst</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5332 : ({lq_tmp$x##5326 : Data.Text.Internal.Text | $k_##2958[VV##2957:=lq_tmp$x##5326][VV##2968:=lq_tmp$x##5332][lq_tmp$x##5335:=lq_anf$##7205759403794047651##d5geD][lq_tmp$x##5336:=updt##a5fJv][r##a5fJR:=lq_anf$##7205759403794047651##d5geD][u##a5fJS:=updt##a5fJv]}, {lq_tmp$x##5328 : (GHC.Maybe.Maybe {lq_tmp$x##5327 : Web.Telegram.API.Bot.Data.Update | $k_##2960[VV##2959:=lq_tmp$x##5327][VV##2961:=lq_tmp$x##5328][VV##2968:=lq_tmp$x##5332][lq_tmp$x##5335:=lq_anf$##7205759403794047651##d5geD][lq_tmp$x##5336:=updt##a5fJv][r##a5fJR:=lq_anf$##7205759403794047651##d5geD][u##a5fJS:=updt##a5fJv]}) | $k_##2962[VV##2961:=lq_tmp$x##5328][VV##2968:=lq_tmp$x##5332][lq_tmp$x##5335:=lq_anf$##7205759403794047651##d5geD][lq_tmp$x##5336:=updt##a5fJv][r##a5fJR:=lq_anf$##7205759403794047651##d5geD][u##a5fJS:=updt##a5fJv]})&lt;\lq_tmp$x##5337 VV -&gt; {lq_tmp$x##5331 : (GHC.Maybe.Maybe {lq_tmp$x##5330 : Web.Telegram.API.Bot.Data.Update | $k_##2965[VV##2964:=lq_tmp$x##5330][VV##2966:=lq_tmp$x##5331][VV##2968:=lq_tmp$x##5332][lq_tmp$x##2963:=lq_tmp$x##5337][lq_tmp$x##5329:=lq_tmp$x##5337][lq_tmp$x##5335:=lq_anf$##7205759403794047651##d5geD][lq_tmp$x##5336:=updt##a5fJv][r##a5fJR:=lq_anf$##7205759403794047651##d5geD][u##a5fJS:=updt##a5fJv]}) | $k_##2967[VV##2966:=lq_tmp$x##5331][VV##2968:=lq_tmp$x##5332][lq_tmp$x##2963:=lq_tmp$x##5337][lq_tmp$x##5329:=lq_tmp$x##5337][lq_tmp$x##5335:=lq_anf$##7205759403794047651##d5geD][lq_tmp$x##5336:=updt##a5fJv][r##a5fJR:=lq_anf$##7205759403794047651##d5geD][u##a5fJS:=updt##a5fJv]}&gt; | $k_##2969[VV##2968:=lq_tmp$x##5332][lq_tmp$x##5335:=lq_anf$##7205759403794047651##d5geD][lq_tmp$x##5336:=updt##a5fJv][r##a5fJR:=lq_anf$##7205759403794047651##d5geD][u##a5fJS:=updt##a5fJv]}</span><span class='hs-varid'>theMsg</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5315 : Data.Text.Internal.Text | lq_tmp$x##5315 ~~ lq_anf$##7205759403794047650##d5geC}</span><span class='hs-str'>"Update:message=nothing!!"</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5339 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##5339 == updt##a5fJv}</span><span class='hs-varid'>updt</span></a>
<span class=hs-linenum> 66: </span>
<span class=hs-linenum> 67: </span><span class='hs-definition'>outBoundRespond</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum> 68: </span><a class=annot href="#"><span class=annottext>forall r .
(GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())) =&gt;
lq_tmp$x##3012:{VV##3013 : Data.Text.Internal.Text | $k_##3014} -&gt; lq_tmp$x##3015:{VV##3016 : Web.Telegram.API.Bot.Data.Update | $k_##3017} -&gt; {VV##3022 : (Polysemy.Internal.Sem {VV##3018 : r | $k_##3019} {VV##3020 : Data.Text.Internal.Text | $k_##3021}) | $k_##3023}</span><span class='hs-definition'>outBoundRespond</span></a> <a class=annot href="#"><span class=annottext>{VV##3013 : Data.Text.Internal.Text | $k_##3014}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>{VV##3016 : Web.Telegram.API.Bot.Data.Update | $k_##3017[lq_tmp$x##3012:=r##a5fJG]}</span><span class='hs-varid'>u</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 69: </span>                        <a class=annot href="#"><span class=annottext>{VV : (((Polysemy.Internal.Union.Find lq_tmp$x##3309:(lq_tmp$x##3310:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##3311:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##3312:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect lq_tmp$x##3375:(lq_tmp$x##3376:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##3377:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##3378:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())), (Polysemy.Internal.CustomErrors.Redefined.IfStuck () GHC.Types.Constraint (Polysemy.Internal.Union.LocateEffect lq_tmp$x##3379:(lq_tmp$x##3380:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##3381:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI lq_tmp$x##3382:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) (Polysemy.Internal.CustomErrors.Redefined.IfStuck [lq_tmp$x##3383:(lq_tmp$x##3384:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; lq_tmp$x##3385:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)] GHC.Types.Constraint r (Polysemy.Internal.CustomErrors.AmbiguousSendError GHC.Types.Constraint 'Polysemy.Internal.CustomErrors.TyVarR r (UseCases.WWI.WWI lq_tmp$x##3389:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (Fcf.Combinators.Pure GHC.Types.Constraint (Polysemy.Internal.CustomErrors.AmbiguousSendError GHC.Types.Constraint (Polysemy.Internal.CustomErrors.UnstuckRState r) r (UseCases.WWI.WWI lq_tmp$x##3390:(TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))) (Fcf.Combinators.Pure GHC.Types.Constraint ()))) | VV ~~ (coerce (Tuple (Tuple (Polysemy.Internal.Union.ElemOf func(0 , [func(0 , [(GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (GHC.Prim.TYPE GHC.Types.LiftedRep)]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (GHC.Prim.TYPE GHC.Types.LiftedRep)]) (UseCases.WWI.WWI func(0 , [(GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (GHC.Prim.TYPE GHC.Types.LiftedRep)])) r##a5fRm) (GHC.Types.$126$ Tuple GHC.Tuple.$40$$41$ GHC.Tuple.$40$$41$)) Tuple) ~ (Tuple (Tuple (Polysemy.Internal.Union.ElemOf func(0 , [func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          GHC.Types.Type]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                GHC.Types.Type]) (UseCases.WWI.WWI func(0 , [(GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (GHC.Prim.TYPE GHC.Types.LiftedRep)])) r##a5fRm) (GHC.Types.$126$ Tuple (Polysemy.Internal.Union.LocateEffect func(0 , [func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               GHC.Types.Type]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (GHC.Prim.TYPE GHC.Types.LiftedRep)]) (UseCases.WWI.WWI func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       GHC.Types.Type])) r##a5fRm) GHC.Tuple.$40$$41$)) (Polysemy.Internal.CustomErrors.Redefined.IfStuck Tuple GHC.Types.Constraint (Polysemy.Internal.Union.LocateEffect func(0 , [func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               GHC.Types.Type]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (GHC.Prim.TYPE GHC.Types.LiftedRep);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (GHC.Prim.TYPE GHC.Types.LiftedRep)]) (UseCases.WWI.WWI func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       GHC.Types.Type])) r##a5fRm) (Polysemy.Internal.CustomErrors.Redefined.IfStuck [Polysemy.Internal.Kind.Effect] GHC.Types.Constraint r##a5fRm (Polysemy.Internal.CustomErrors.AmbiguousSendError GHC.Types.Constraint Polysemy.Internal.CustomErrors.TyVarR r##a5fRm (UseCases.WWI.WWI func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      GHC.Types.Type]))) (Fcf.Combinators.Pure GHC.Types.Constraint (Polysemy.Internal.CustomErrors.AmbiguousSendError GHC.Types.Constraint (Polysemy.Internal.CustomErrors.UnstuckRState r##a5fRm) r##a5fRm (UseCases.WWI.WWI func(0 , [GHC.Types.Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         GHC.Types.Type]))))) (Fcf.Combinators.Pure GHC.Types.Constraint Type.Errors.NoError))) in $d(%,%)_a5fWt)}</span><span class='hs-varid'>sendBackMsg</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3426 : ({lq_tmp$x##3420 : Data.Text.Internal.Text | $k_##2958[VV##2957:=lq_tmp$x##3420][VV##2968:=lq_tmp$x##3426][lq_tmp$x##3429:=r##a5fJG][lq_tmp$x##3430:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]}, {lq_tmp$x##3422 : (GHC.Maybe.Maybe {lq_tmp$x##3421 : Web.Telegram.API.Bot.Data.Update | $k_##2960[VV##2959:=lq_tmp$x##3421][VV##2961:=lq_tmp$x##3422][VV##2968:=lq_tmp$x##3426][lq_tmp$x##3429:=r##a5fJG][lq_tmp$x##3430:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]}) | $k_##2962[VV##2961:=lq_tmp$x##3422][VV##2968:=lq_tmp$x##3426][lq_tmp$x##3429:=r##a5fJG][lq_tmp$x##3430:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]})&lt;\lq_tmp$x##3431 VV -&gt; {lq_tmp$x##3425 : (GHC.Maybe.Maybe {lq_tmp$x##3424 : Web.Telegram.API.Bot.Data.Update | $k_##2965[VV##2964:=lq_tmp$x##3424][VV##2966:=lq_tmp$x##3425][VV##2968:=lq_tmp$x##3426][lq_tmp$x##2963:=lq_tmp$x##3431][lq_tmp$x##3423:=lq_tmp$x##3431][lq_tmp$x##3429:=r##a5fJG][lq_tmp$x##3430:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]}) | $k_##2967[VV##2966:=lq_tmp$x##3425][VV##2968:=lq_tmp$x##3426][lq_tmp$x##2963:=lq_tmp$x##3431][lq_tmp$x##3423:=lq_tmp$x##3431][lq_tmp$x##3429:=r##a5fJG][lq_tmp$x##3430:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]}&gt; | $k_##2969[VV##2968:=lq_tmp$x##3426][lq_tmp$x##3429:=r##a5fJG][lq_tmp$x##3430:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]}</span><span class='hs-varid'>theMsg</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3432 : Data.Text.Internal.Text | lq_tmp$x##3432 == r##a5fJG
                                            &amp;&amp; $k_##3014[VV##3013:=lq_tmp$x##3432]}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3433 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##3433 == u##a5fJH
                                                     &amp;&amp; $k_##3017[VV##3016:=lq_tmp$x##3433][lq_tmp$x##3012:=r##a5fJG]}</span><span class='hs-varid'>u</span></a>
<span class=hs-linenum> 70: </span>                        <a class=annot href="#"><span class=annottext>(GHC.Base.Applicative (Polysemy.Internal.Sem r))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a6hX b##a6hY .
      lq_tmp$x##3731:(a##a6hX, b##a6hY) -&gt; {lq_tmp$x##3728 : a##a6hX | lq_tmp$x##3728 == fst lq_tmp$x##3731} | VV == Data.Tuple.fst}</span><span class='hs-varid'>fst</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3751 : ({lq_tmp$x##3745 : Data.Text.Internal.Text | $k_##2958[VV##2957:=lq_tmp$x##3745][VV##2968:=lq_tmp$x##3751][lq_tmp$x##3754:=r##a5fJG][lq_tmp$x##3755:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]}, {lq_tmp$x##3747 : (GHC.Maybe.Maybe {lq_tmp$x##3746 : Web.Telegram.API.Bot.Data.Update | $k_##2960[VV##2959:=lq_tmp$x##3746][VV##2961:=lq_tmp$x##3747][VV##2968:=lq_tmp$x##3751][lq_tmp$x##3754:=r##a5fJG][lq_tmp$x##3755:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]}) | $k_##2962[VV##2961:=lq_tmp$x##3747][VV##2968:=lq_tmp$x##3751][lq_tmp$x##3754:=r##a5fJG][lq_tmp$x##3755:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]})&lt;\lq_tmp$x##3756 VV -&gt; {lq_tmp$x##3750 : (GHC.Maybe.Maybe {lq_tmp$x##3749 : Web.Telegram.API.Bot.Data.Update | $k_##2965[VV##2964:=lq_tmp$x##3749][VV##2966:=lq_tmp$x##3750][VV##2968:=lq_tmp$x##3751][lq_tmp$x##2963:=lq_tmp$x##3756][lq_tmp$x##3748:=lq_tmp$x##3756][lq_tmp$x##3754:=r##a5fJG][lq_tmp$x##3755:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]}) | $k_##2967[VV##2966:=lq_tmp$x##3750][VV##2968:=lq_tmp$x##3751][lq_tmp$x##2963:=lq_tmp$x##3756][lq_tmp$x##3748:=lq_tmp$x##3756][lq_tmp$x##3754:=r##a5fJG][lq_tmp$x##3755:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]}&gt; | $k_##2969[VV##2968:=lq_tmp$x##3751][lq_tmp$x##3754:=r##a5fJG][lq_tmp$x##3755:=u##a5fJH][r##a5fJR:=r##a5fJG][u##a5fJS:=u##a5fJH]}</span><span class='hs-varid'>theMsg</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3757 : Data.Text.Internal.Text | lq_tmp$x##3757 == r##a5fJG
                                            &amp;&amp; $k_##3014[VV##3013:=lq_tmp$x##3757]}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3758 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##3758 == u##a5fJH
                                                     &amp;&amp; $k_##3017[VV##3016:=lq_tmp$x##3758][lq_tmp$x##3012:=r##a5fJG]}</span><span class='hs-varid'>u</span></a>
<span class=hs-linenum> 71: </span>
<span class=hs-linenum> 72: </span><span class='hs-comment'>-- Domain Data</span>
<span class=hs-linenum> 73: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>txtLen</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 74: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>gettheTelegram</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 75: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ValidInboundMsg</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>tlgm</span><span class='hs-conop'>:</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>|</span> <span class='hs-num'>1</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>txtLen</span> <span class='hs-layout'>(</span><span class='hs-varid'>gettheTelegram</span> <span class='hs-varid'>tlgm</span><span class='hs-layout'>)</span>  <span class='hs-varop'>&amp;&amp;</span> <span class='hs-num'>29</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>txtLen</span> <span class='hs-layout'>(</span><span class='hs-varid'>gettheTelegram</span> <span class='hs-varid'>tlgm</span><span class='hs-layout'>)</span><span class='hs-layout'>}</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 76: </span>
<span class=hs-linenum> 77: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>apiGetTlgm</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ValidInboundMsg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 78: </span><span class='hs-definition'>apiGetTlgm</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum> 79: </span><span class='hs-definition'>apiGetTlgm</span> <span class='hs-varid'>updt</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 80: </span>                  <span class='hs-varid'>thisuserprefs</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>embed</span> <span class='hs-layout'>(</span><span class='hs-varid'>getPreferences</span> <span class='hs-varid'>uid</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 81: </span>                  <span class='hs-varid'>getWeatherTown</span> <span class='hs-varop'>$</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>resp</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thisuserprefs</span><span class='hs-layout'>}</span>
<span class=hs-linenum> 82: </span>            <span class='hs-keyword'>where</span> 
<span class=hs-linenum> 83: </span>                  <span class='hs-layout'>(</span><span class='hs-varid'>uid</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>tlgm</span><span class='hs-layout'>,</span> <span class='hs-varid'>resp</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getMeta</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>updt</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 84: </span>
<span class=hs-linenum> 85: </span><span class='hs-definition'>apiSetTlgm</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 86: </span><a class=annot href="#"><span class=annottext>forall r .
(GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r) '()), GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) r) '())) =&gt;
lq_tmp$x##2352:{VV##2353 : Web.Telegram.API.Bot.Data.Update | $k_##2354} -&gt; {VV##2359 : (Polysemy.Internal.Sem {VV##2355 : r | $k_##2356} {VV##2357 : () | $k_##2358}) | $k_##2360}</span><span class='hs-definition'>apiSetTlgm</span></a> <a class=annot href="#"><span class=annottext>{VV##2353 : Web.Telegram.API.Bot.Data.Update | $k_##2354}</span><span class='hs-varid'>updt</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2947 : ((Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) r) '())) | lq_tmp$x##2947 == $d(%,%)_a5fQE}</span><span class='hs-varid'>embed</span></a> <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-layout'>(</span></a><span class='hs-varid'>setPreferences</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2862 : Data.Text.Internal.Text | lq_tmp$x##2862 == uid##a5fJO
                                            &amp;&amp; $k_##2741[VV##2740:=lq_tmp$x##2862]}</span><span class='hs-varid'>uid</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2863 : Data.Text.Internal.Text | lq_tmp$x##2863 == resp##a5fJQ
                                            &amp;&amp; $k_##2798[VV##2797:=lq_tmp$x##2863]}</span><span class='hs-varid'>resp</span></a><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 87: </span>                  <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##2740 : Data.Text.Internal.Text | $k_##2741}</span><span class='hs-varid'>uid</span></a><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>tlgm</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##2797 : Data.Text.Internal.Text | $k_##2798}</span><span class='hs-varid'>resp</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Text.Internal.Text, (Data.Text.Internal.Text, Data.Text.Internal.Text))</span><span class='hs-varid'>getMeta</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2554 : (GHC.Maybe.Maybe {lq_tmp$x##2559 : Web.Telegram.API.Bot.Data.Update | $k_##2558[VV##2557:=lq_tmp$x##2559][lq_tmp$x##2556:=updt##a5fJN]}) | isJust lq_tmp$x##2554
                                                                                                                                                             &amp;&amp; fromJust lq_tmp$x##2554 == updt##a5fJN
                                                                                                                                                             &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##2554 == updt##a5fJN}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Just</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2560 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##2560 == updt##a5fJN
                                                     &amp;&amp; $k_##2354[VV##2353:=lq_tmp$x##2560]}</span><span class='hs-varid'>updt</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 88: </span>
<span class=hs-linenum> 89: </span><span class='hs-definition'>theMsg</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>UserMsg</span>
<span class=hs-linenum> 90: </span><a class=annot href="#"><span class=annottext>r##a5fJR:{VV##2951 : Data.Text.Internal.Text | $k_##2952} -&gt; u##a5fJS:{VV##2954 : Web.Telegram.API.Bot.Data.Update | $k_##2955} -&gt; {VV##2968 : ({VV##2957 : Data.Text.Internal.Text | $k_##2958}, {VV##2961 : (GHC.Maybe.Maybe {VV##2959 : Web.Telegram.API.Bot.Data.Update | $k_##2960}) | $k_##2962})&lt;\lq_tmp$x##2963 VV -&gt; {VV##2966 : (GHC.Maybe.Maybe {VV##2964 : Web.Telegram.API.Bot.Data.Update | $k_##2965}) | $k_##2967}&gt; | $k_##2969}</span><span class='hs-definition'>theMsg</span></a> <a class=annot href="#"><span class=annottext>{VV##2951 : Data.Text.Internal.Text | $k_##2952}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>{VV##2954 : Web.Telegram.API.Bot.Data.Update | $k_##2955}</span><span class='hs-varid'>u</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3007 : Data.Text.Internal.Text | lq_tmp$x##3007 == r##a5fJR
                                            &amp;&amp; $k_##2952[VV##2951:=lq_tmp$x##3007]}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2972 : (GHC.Maybe.Maybe {lq_tmp$x##2977 : Web.Telegram.API.Bot.Data.Update | $k_##2976[VV##2975:=lq_tmp$x##2977][lq_tmp$x##2974:=u##a5fJS]}) | isJust lq_tmp$x##2972
                                                                                                                                                          &amp;&amp; fromJust lq_tmp$x##2972 == u##a5fJS
                                                                                                                                                          &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##2972 == u##a5fJS}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2978 : Web.Telegram.API.Bot.Data.Update | lq_tmp$x##2978 == u##a5fJS
                                                     &amp;&amp; $k_##2955[VV##2954:=lq_tmp$x##2978]}</span><span class='hs-varid'>u</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UserMsg</span>
<span class=hs-linenum> 91: </span>
<span class=hs-linenum> 92: </span><span class='hs-definition'>getInfoPlainText</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum> 93: </span><span class='hs-definition'>getInfoPlainText</span> <span class='hs-varid'>plName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>embed</span> <span class='hs-layout'>(</span><span class='hs-varid'>getPreferences</span> <span class='hs-varid'>modalUser</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span>  <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>thisuserprefs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>getWeatherTown</span> <span class='hs-varop'>$</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plName</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thisuserprefs</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 94: </span>
<span class=hs-linenum> 95: </span><span class='hs-definition'>apiGetPlainText</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum> 96: </span><span class='hs-definition'>apiGetPlainText</span> <span class='hs-varid'>plName</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>embed</span> <span class='hs-layout'>(</span><span class='hs-varid'>getPreferences</span> <span class='hs-varid'>modalUser</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span>  <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>thisuserprefs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>getWeatherTown</span> <span class='hs-varop'>$</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plName</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thisuserprefs</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 97: </span>
<span class=hs-linenum> 98: </span><span class='hs-definition'>apiSetPlainText</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>WWI</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 99: </span><span class='hs-definition'>apiSetPlainText</span> <span class='hs-varid'>plName</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pure</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>100: </span>
<span class=hs-linenum>101: </span><span class='hs-definition'>isValidPreferencesJSON</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>String</span> <span class='hs-conid'>Preferences</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>102: </span><a class=annot href="#"><span class=annottext>json##a5fJY:{VV##3885 : (Data.Either.Either {VV##3881 : [{VV##3876 : GHC.Types.Char | $k_##3877}]&lt;\lq_tmp$x##3878 VV -&gt; {VV##3879 : GHC.Types.Char | $k_##3880}&gt; | $k_##3882} {VV##3883 : InterfaceAdapters.Preferences.Preferences | $k_##3884}) | $k_##3886} -&gt; {VV##3888 : GHC.Types.Bool | $k_##3889}</span><span class='hs-definition'>isValidPreferencesJSON</span></a> <a class=annot href="#"><span class=annottext>{VV##3885 : (Data.Either.Either {VV##3881 : [{VV##3876 : GHC.Types.Char | $k_##3877}]&lt;\lq_tmp$x##3878 VV -&gt; {VV##3879 : GHC.Types.Char | $k_##3880}&gt; | $k_##3882} {VV##3883 : InterfaceAdapters.Preferences.Preferences | $k_##3884}) | $k_##3886}</span><span class='hs-varid'>json</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3895 : (Data.Either.Either {lq_tmp$x##3893 : [{lq_tmp$x##3890 : GHC.Types.Char | $k_##3877[VV##3876:=lq_tmp$x##3890][VV##3881:=lq_tmp$x##3893][VV##3885:=lq_tmp$x##3895]}]&lt;\lq_tmp$x##3896 VV -&gt; {lq_tmp$x##3892 : GHC.Types.Char | $k_##3880[VV##3879:=lq_tmp$x##3892][VV##3881:=lq_tmp$x##3893][VV##3885:=lq_tmp$x##3895][lq_tmp$x##3878:=lq_tmp$x##3896][lq_tmp$x##3891:=lq_tmp$x##3896]}&gt; | $k_##3882[VV##3881:=lq_tmp$x##3893][VV##3885:=lq_tmp$x##3895]} {lq_tmp$x##3894 : InterfaceAdapters.Preferences.Preferences | $k_##3884[VV##3883:=lq_tmp$x##3894][VV##3885:=lq_tmp$x##3895]}) | lq_tmp$x##3895 == json##a5fJY
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &amp;&amp; $k_##3886[VV##3885:=lq_tmp$x##3895]}</span><span class='hs-varid'>json</span></a> <span class='hs-keyword'>of</span> 
<span class=hs-linenum>103: </span>            <span class='hs-conid'>Left</span> <span class='hs-varid'>invalid</span>                          <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3919 : GHC.Types.Bool | not lq_tmp$x##3919
                                   &amp;&amp; lq_tmp$x##3919 == GHC.Types.False}</span><span class='hs-conid'>False</span></a> 
<span class=hs-linenum>104: </span>            <span class='hs-conid'>Right</span> <span class='hs-layout'>(</span><span class='hs-conid'>Preferences</span> <span class='hs-varid'>uData</span> <span class='hs-varid'>uSize</span> <span class='hs-varid'>uSpan</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3966 : GHC.Types.Bool | lq_tmp$x##3966
                                   &amp;&amp; lq_tmp$x##3966 == GHC.Types.True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum>105: </span>
<span class=hs-linenum>106: </span><span class='hs-keyword'>{-@</span>  <span class='hs-varid'>rejectInvalid</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>o</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>107: </span><span class='hs-definition'>rejectInvalid</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>108: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3968:Data.Text.Internal.Text -&gt; Data.Text.Internal.Text</span><span class='hs-definition'>rejectInvalid</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>this</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4507 : [{lq_tmp$x##4504 : Data.Text.Internal.Text | $k_##4361[VV##4360:=lq_tmp$x##4504][VV##4365:=lq_tmp$x##4507]}]&lt;\lq_tmp$x##4508 VV -&gt; {lq_tmp$x##4506 : Data.Text.Internal.Text | $k_##4364[VV##4363:=lq_tmp$x##4506][VV##4365:=lq_tmp$x##4507][lq_tmp$x##4362:=lq_tmp$x##4508][lq_tmp$x##4505:=lq_tmp$x##4508]}&gt; | lq_tmp$x##4507 == rejectionsLeft##a5fK4
                                                                                                                                                                                                                                                                                                                                   &amp;&amp; len lq_tmp$x##4507 &gt;= 0
                                                                                                                                                                                                                                                                                                                                   &amp;&amp; $k_##4366[VV##4365:=lq_tmp$x##4507]}</span><span class='hs-varid'>rejectionsLeft</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4555 : [{lq_tmp$x##4552 : Data.Text.Internal.Text | $k_##4417[VV##4416:=lq_tmp$x##4552][VV##4421:=lq_tmp$x##4555]}]&lt;\lq_tmp$x##4556 VV -&gt; {lq_tmp$x##4554 : Data.Text.Internal.Text | $k_##4420[VV##4419:=lq_tmp$x##4554][VV##4421:=lq_tmp$x##4555][lq_tmp$x##4418:=lq_tmp$x##4556][lq_tmp$x##4553:=lq_tmp$x##4556]}&gt; | lq_tmp$x##4555 == oksRight##a5fK5
                                                                                                                                                                                                                                                                                                                                   &amp;&amp; len lq_tmp$x##4555 &gt;= 0
                                                                                                                                                                                                                                                                                                                                   &amp;&amp; $k_##4422[VV##4421:=lq_tmp$x##4555]}</span><span class='hs-varid'>oksRight</span></a><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span> 
<span class=hs-linenum>109: </span>                  <span class='hs-layout'>(</span><span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4644 : Data.Text.Internal.Text | lq_tmp$x##4644 == x##a5fK6
                                            &amp;&amp; $k_##4417[VV##4416:=lq_tmp$x##4644][VV##4421:=lq_anf$##7205759403794047634##d5gem][liquid_internal_this:=lq_anf$##7205759403794047634##d5gem][lq_tmp$x##4552:=lq_tmp$x##4644][lq_tmp$x##4555:=lq_anf$##7205759403794047634##d5gem][lq_tmp$x##4608:=lq_tmp$x##4644][lq_tmp$x##4611:=lq_anf$##7205759403794047634##d5gem]}</span><span class='hs-varid'>x</span></a> <span class='hs-comment'>-- i.e no (Left _) rejections and at least one (Right _) List item</span>
<span class=hs-linenum>110: </span>                  <span class='hs-keyword'>_</span>         <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4694 : [{lq_tmp$x##4698 : GHC.Types.Char | $k_##4697[VV##4696:=lq_tmp$x##4698]}]&lt;\lq_tmp$x##4695 VV -&gt; {lq_tmp$x##4698 : GHC.Types.Char | $k_##4700[VV##4699:=lq_tmp$x##4698][lq_tmp$x##4701:=lq_tmp$x##4695]}&gt; | len lq_tmp$x##4694 == 0}</span><span class='hs-str'>""</span></a> 
<span class=hs-linenum>111: </span>            <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##4365 : [{VV##4360 : Data.Text.Internal.Text | $k_##4361}]&lt;\lq_tmp$x##4362 VV -&gt; {VV##4363 : Data.Text.Internal.Text | $k_##4364}&gt; | $k_##4366}</span><span class='hs-varid'>rejectionsLeft</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{VV##4421 : [{VV##4416 : Data.Text.Internal.Text | $k_##4417}]&lt;\lq_tmp$x##4418 VV -&gt; {VV##4419 : Data.Text.Internal.Text | $k_##4420}&gt; | $k_##4422}</span><span class='hs-varid'>oksRight</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>([{lq_tmp$x##4346 : Data.Text.Internal.Text | $k_##4345[VV##4344:=lq_tmp$x##4346][lq_tmp$x##4338:=lq_anf$##7205759403794047629##d5geh]}], [{lq_tmp$x##4349 : Data.Text.Internal.Text | $k_##4348[VV##4347:=lq_tmp$x##4349][lq_tmp$x##4338:=lq_anf$##7205759403794047629##d5geh]}])</span><span class='hs-varid'>partitionEithers</span></a> <a class=annot href="#"><span class=annottext>[(Data.Either.Either Data.Text.Internal.Text Data.Text.Internal.Text)]</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text {lq_tmp$x##3990 : Data.Text.Internal.Text | txtLen this##a5fK3 == txtLen lq_tmp$x##3990
                                                                                        &amp;&amp; 1 &lt; txtLen lq_tmp$x##3990})</span><span class='hs-varid'>placeLikeMinText</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3994 : Data.Text.Internal.Text | lq_tmp$x##3994 == this##a5fK3}</span><span class='hs-varid'>this</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text {lq_tmp$x##4002 : Data.Text.Internal.Text | txtLen this##a5fK3 == txtLen lq_tmp$x##4002
                                                                                        &amp;&amp; 29 &gt; txtLen lq_tmp$x##4002})</span><span class='hs-varid'>placeLikeMaxText</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4006 : Data.Text.Internal.Text | lq_tmp$x##4006 == this##a5fK3}</span><span class='hs-varid'>this</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>112: </span>
<span class=hs-linenum>113: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assume</span> <span class='hs-conid'>M.pack</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>i</span><span class='hs-conop'>:</span><span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{o:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyword'>| len i == txtLen o }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>114: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assume</span> <span class='hs-conid'>M.unpack</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>i</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{o:</span><span class='hs-conid'>String</span> <span class='hs-keyword'>| len o == txtLen i }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>115: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assume</span> <span class='hs-conid'>Data.String.fromString</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-keyword'>_</span> <span class='hs-keyword'>| v ~~ x}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>116: </span>
<span class=hs-linenum>117: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>placeLikeMinText</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rv</span> <span class='hs-conop'>:</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyword'>{rght:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyword'>| 1 &lt; txtLen rght &amp;&amp; txtLen x == txtLen rght}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>118: </span><span class='hs-definition'>placeLikeMinText</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>T.Text</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>119: </span><span class='hs-definition'>placeLikeMinText</span> <span class='hs-varid'>y</span>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-conid'>M.unpack</span> <span class='hs-varid'>y</span> <span class='hs-keyword'>of</span> 
<span class=hs-linenum>120: </span>                        <span class='hs-layout'>(</span><span class='hs-varid'>u</span><span class='hs-conop'>:</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Right</span> <span class='hs-varid'>y</span>
<span class=hs-linenum>121: </span>                        <span class='hs-keyword'>_</span>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Left</span> <span class='hs-str'>"Invalid"</span>  
<span class=hs-linenum>122: </span>
<span class=hs-linenum>123: </span><span class='hs-comment'>-- Venkatanarasimharajuvaripeta in Andhra Pradesh</span>
<span class=hs-linenum>124: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>placeLikeMaxText</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>T.Text</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rv</span> <span class='hs-conop'>:</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyword'>{rght:</span><span class='hs-conid'>T.Text</span> <span class='hs-keyword'>| 29 &gt; txtLen rght &amp;&amp; txtLen x == txtLen rght}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>125: </span><span class='hs-definition'>placeLikeMaxText</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>T.Text</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>126: </span><span class='hs-definition'>placeLikeMaxText</span> <span class='hs-varid'>y</span>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-conid'>M.unpack</span> <span class='hs-varid'>y</span> <span class='hs-keyword'>of</span> 
<span class=hs-linenum>127: </span>                        <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-conop'>:</span><span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-varid'>c</span><span class='hs-conop'>:</span><span class='hs-varid'>d</span><span class='hs-conop'>:</span><span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-varid'>h</span><span class='hs-conop'>:</span><span class='hs-varid'>i</span><span class='hs-conop'>:</span><span class='hs-varid'>j</span><span class='hs-conop'>:</span><span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-varid'>l</span><span class='hs-conop'>:</span><span class='hs-varid'>m</span><span class='hs-conop'>:</span><span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-varid'>o</span><span class='hs-conop'>:</span><span class='hs-varid'>p</span><span class='hs-conop'>:</span><span class='hs-varid'>q</span><span class='hs-conop'>:</span><span class='hs-varid'>r</span><span class='hs-conop'>:</span><span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-varid'>u</span><span class='hs-conop'>:</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-varid'>w</span><span class='hs-conop'>:</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>y</span><span class='hs-conop'>:</span><span class='hs-varid'>z</span><span class='hs-conop'>:</span><span class='hs-varid'>a1</span><span class='hs-conop'>:</span><span class='hs-varid'>a2</span><span class='hs-conop'>:</span><span class='hs-varid'>a3</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Left</span> <span class='hs-str'>"Invalid"</span>
<span class=hs-linenum>128: </span>                        <span class='hs-keyword'>_</span>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Right</span> <span class='hs-varid'>y</span></pre>
</body>
</html>