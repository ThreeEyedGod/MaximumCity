<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/ExternalInterfaces/ApplicationAssembly.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE TypeOperators #-}</span></a>
<span class=hs-linenum> 2: </span><span class='hs-comment'>{-# LANGUAGE DataKinds #-}</span>
<span class=hs-linenum> 3: </span><span class='hs-comment'>{-# LANGUAGE FlexibleContexts #-}</span>
<span class=hs-linenum> 4: </span><span class='hs-comment'>{-# LANGUAGE GADTs #-}</span>
<span class=hs-linenum> 5: </span><span class='hs-comment'>{-# LANGUAGE TypeApplications #-}</span>
<span class=hs-linenum> 6: </span>
<span class=hs-linenum> 7: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>ExternalInterfaces.ApplicationAssembly</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 8: </span>
<span class=hs-linenum> 9: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Control.Monad.Except</span>
<span class=hs-linenum>10: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.ByteString.Lazy.Char8</span>               <span class='hs-layout'>(</span><span class='hs-varid'>pack</span><span class='hs-layout'>)</span>
<span class=hs-linenum>11: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Function</span>                            <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>&amp;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>12: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy</span>
<span class=hs-linenum>13: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy.Error</span>
<span class=hs-linenum>14: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy.Input</span>                           <span class='hs-layout'>(</span><span class='hs-conid'>Input</span><span class='hs-layout'>,</span> <span class='hs-varid'>runInputConst</span><span class='hs-layout'>)</span>
<span class=hs-linenum>15: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Polysemy.Trace</span>                           <span class='hs-layout'>(</span><span class='hs-conid'>Trace</span><span class='hs-layout'>,</span> <span class='hs-varid'>traceToIO</span><span class='hs-layout'>,</span> <span class='hs-varid'>ignoreTrace</span><span class='hs-layout'>,</span> <span class='hs-varid'>traceToStdout</span><span class='hs-layout'>)</span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Servant.Server</span>
<span class=hs-linenum>17: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Aeson.Types</span> <span class='hs-layout'>(</span><span class='hs-conid'>ToJSON</span><span class='hs-layout'>,</span> <span class='hs-conid'>FromJSON</span><span class='hs-layout'>)</span>
<span class=hs-linenum>18: </span>
<span class=hs-linenum>19: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Config</span>
<span class=hs-linenum>20: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.AgricultureRestService</span>
<span class=hs-linenum>21: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Weather.WWITelegramPirate</span>
<span class=hs-linenum>22: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Weather.WWIWebPirate</span>
<span class=hs-linenum>23: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>InterfaceAdapters.Parameters.KVSAWSSSMParmStore</span>
<span class=hs-linenum>24: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>UseCases.WWI</span>
<span class=hs-linenum>25: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>UseCases.AgricultureUseCase</span>
<span class=hs-linenum>26: </span>
<span class=hs-linenum>27: </span>
<span class=hs-linenum>28: </span><span class='hs-comment'>{--
  @LambdaFiring
  1. LoadConfig and then 'Select' the right backendfrontend runWWI___
  2. runWWI_ then sets it so that GetWeatherTown is 'interpreted' to Weather.getAgInfo
  2a. the structure of interpretation is in WWI

  @DataFlowIn
  1. Servant sucks in the actual API (POST/GET/whatever) in AgriRestServices and 
  1a. Depending on the http-call (Post or Get or etc) weatherTownTelegram or weatherTownWeb is called
  2. which then makes the call to the mapped runWWI_function in (in WWITelegramPirate, WWIWebPirate, other) and processes the frontend specific JSON or Text
  3. which then makes the call to AgriUsecase - weatherTown
  3. which then calls WWI:GetWeatherTown
  4. See @LambdaFiring#2!
--}</span>
<span class=hs-linenum>42: </span>
<span class=hs-linenum>43: </span><span class='hs-definition'>servApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Application</span>
<span class=hs-linenum>44: </span><a class=annot href="#"><span class=annottext>(GHC.Types.IO Network.Wai.Internal.Request -&gt; (Network.Wai.Internal.Response -&gt; (GHC.Types.IO Network.Wai.Internal.ResponseReceived)) -&gt; (GHC.Types.IO Network.Wai.Internal.ResponseReceived))</span><span class='hs-definition'>servApp</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <a class=annot href="#"><span class=annottext>InterfaceAdapters.Config.Config -&gt; Network.Wai.Internal.Request -&gt; (Network.Wai.Internal.Response -&gt; (GHC.Types.IO Network.Wai.Internal.ResponseReceived)) -&gt; (GHC.Types.IO Network.Wai.Internal.ResponseReceived)</span><span class='hs-varid'>createApp</span></a> <span class='hs-varop'>&lt;$&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Types.IO InterfaceAdapters.Config.Config) | v == loadConfig}</span><span class='hs-varid'>loadConfig</span></a>
<span class=hs-linenum>45: </span>
<span class=hs-linenum>46: </span><span class='hs-comment'>-- | creates the WAI Application that can be executed by Warp.run.</span>
<span class=hs-linenum>47: </span><span class='hs-comment'>-- All Polysemy interpretations must be executed here.</span>
<span class=hs-linenum>48: </span><span class='hs-definition'>createApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Config</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Application</span>
<span class=hs-linenum>49: </span><a class=annot href="#"><span class=annottext>InterfaceAdapters.Config.Config -&gt; Network.Wai.Internal.Request -&gt; (Network.Wai.Internal.Response -&gt; (GHC.Types.IO Network.Wai.Internal.ResponseReceived)) -&gt; (GHC.Types.IO Network.Wai.Internal.ResponseReceived)</span><span class='hs-definition'>createApp</span></a> <a class=annot href="#"><span class=annottext>InterfaceAdapters.Config.Config</span><span class='hs-varid'>config</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>serve</span> <a class=annot href="#"><span class=annottext>{v : (Data.Proxy.Proxy (TYPE 'GHC.Types.LiftedRep) (Servant.API.Alternative.:&lt;|&gt; (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.Description.Summary [GHC.Types.Char]) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.ReqBody.ReqBody' (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Required (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Strict ('[] (TYPE 'GHC.Types.LiftedRep)))) (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.JSON ('[] (TYPE 'GHC.Types.LiftedRep))) Web.Telegram.API.Bot.Data.Update) (Servant.API.Verbs.Verb Network.HTTP.Types.Method.StdMethod 'Network.HTTP.Types.Method.POST GHC.Types.Int (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text))) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.Description.Summary [GHC.Types.Char]) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.ReqBody.ReqBody' (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Required (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Strict ('[] (TYPE 'GHC.Types.LiftedRep)))) (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text) (Servant.API.Verbs.Verb Network.HTTP.Types.Method.StdMethod 'Network.HTTP.Types.Method.POST GHC.Types.Int (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text))))) | v == agricultureAPI}</span><span class='hs-varid'>agricultureAPI</span></a> <a class=annot href="#"><span class=annottext>(Servant.Server.Internal.ServerT (TYPE 'GHC.Types.LiftedRep) (Servant.API.Alternative.:&lt;|&gt; (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.Description.Summary [GHC.Types.Char]) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.ReqBody.ReqBody' (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Required (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Strict ('[] (TYPE 'GHC.Types.LiftedRep)))) (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.JSON ('[] (TYPE 'GHC.Types.LiftedRep))) Web.Telegram.API.Bot.Data.Update) (Servant.API.Verbs.Verb Network.HTTP.Types.Method.StdMethod 'Network.HTTP.Types.Method.POST GHC.Types.Int (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text))) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.Description.Summary [GHC.Types.Char]) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.ReqBody.ReqBody' (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Required (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Strict ('[] (TYPE 'GHC.Types.LiftedRep)))) (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text) (Servant.API.Verbs.Verb Network.HTTP.Types.Method.StdMethod 'Network.HTTP.Types.Method.POST GHC.Types.Int (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text)))) Servant.Server.Internal.Handler.Handler)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>liftServer</span> <a class=annot href="#"><span class=annottext>{v : InterfaceAdapters.Config.Config | v == config}</span><span class='hs-varid'>config</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>50: </span>
<span class=hs-linenum>51: </span><span class='hs-definition'>liftServer</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Config</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ServerT</span> <span class='hs-conid'>AgricultureAPI</span> <span class='hs-conid'>Handler</span>
<span class=hs-linenum>52: </span><a class=annot href="#"><span class=annottext>InterfaceAdapters.Config.Config -&gt; (Servant.Server.Internal.ServerT (TYPE 'GHC.Types.LiftedRep) (Servant.API.Alternative.:&lt;|&gt; (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.Description.Summary [GHC.Types.Char]) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.ReqBody.ReqBody' (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Required (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Strict ('[] (TYPE 'GHC.Types.LiftedRep)))) (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.JSON ('[] (TYPE 'GHC.Types.LiftedRep))) Web.Telegram.API.Bot.Data.Update) (Servant.API.Verbs.Verb Network.HTTP.Types.Method.StdMethod 'Network.HTTP.Types.Method.POST GHC.Types.Int (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text))) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.Description.Summary [GHC.Types.Char]) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.ReqBody.ReqBody' (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Required (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Strict ('[] (TYPE 'GHC.Types.LiftedRep)))) (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text) (Servant.API.Verbs.Verb Network.HTTP.Types.Method.StdMethod 'Network.HTTP.Types.Method.POST GHC.Types.Int (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text)))) Servant.Server.Internal.Handler.Handler)</span><span class='hs-definition'>liftServer</span></a> <a class=annot href="#"><span class=annottext>InterfaceAdapters.Config.Config</span><span class='hs-varid'>config</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (UseCases.WWI.WWI ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) InterfaceAdapters.Config.Config) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) UseCases.WWI.WeatherStatusError) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Trace.Trace ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)))))))) a) -&gt; (Servant.Server.Internal.Handler.Handler a)</span><span class='hs-varid'>hoistServer</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.Proxy.Proxy (TYPE 'GHC.Types.LiftedRep) (Servant.API.Alternative.:&lt;|&gt; (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.Description.Summary [GHC.Types.Char]) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.ReqBody.ReqBody' (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Required (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Strict ('[] (TYPE 'GHC.Types.LiftedRep)))) (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.JSON ('[] (TYPE 'GHC.Types.LiftedRep))) Web.Telegram.API.Bot.Data.Update) (Servant.API.Verbs.Verb Network.HTTP.Types.Method.StdMethod 'Network.HTTP.Types.Method.POST GHC.Types.Int (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text))) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.Description.Summary [GHC.Types.Char]) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.ReqBody.ReqBody' (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Required (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Strict ('[] (TYPE 'GHC.Types.LiftedRep)))) (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text) (Servant.API.Verbs.Verb Network.HTTP.Types.Method.StdMethod 'Network.HTTP.Types.Method.POST GHC.Types.Int (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text))))) | v == agricultureAPI}</span><span class='hs-varid'>agricultureAPI</span></a> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (UseCases.WWI.WWI ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) InterfaceAdapters.Config.Config) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) UseCases.WWI.WeatherStatusError) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Trace.Trace ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)))))))) a) -&gt; (Servant.Server.Internal.Handler.Handler a)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>interpretServer</span> <a class=annot href="#"><span class=annottext>{v : InterfaceAdapters.Config.Config | v == config}</span><span class='hs-varid'>config</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(Servant.Server.Internal.ServerT (TYPE 'GHC.Types.LiftedRep) (Servant.API.Alternative.:&lt;|&gt; (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.Description.Summary [GHC.Types.Char]) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.ReqBody.ReqBody' (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Required (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Strict ('[] (TYPE 'GHC.Types.LiftedRep)))) (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.JSON ('[] (TYPE 'GHC.Types.LiftedRep))) Web.Telegram.API.Bot.Data.Update) (Servant.API.Verbs.Verb Network.HTTP.Types.Method.StdMethod 'Network.HTTP.Types.Method.POST GHC.Types.Int (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text))) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.Description.Summary [GHC.Types.Char]) (Servant.API.Sub.:&gt; (TYPE 'GHC.Types.LiftedRep) (Servant.API.ReqBody.ReqBody' (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Required (': (TYPE 'GHC.Types.LiftedRep) Servant.API.Modifiers.Strict ('[] (TYPE 'GHC.Types.LiftedRep)))) (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text) (Servant.API.Verbs.Verb Network.HTTP.Types.Method.StdMethod 'Network.HTTP.Types.Method.POST GHC.Types.Int (': (TYPE 'GHC.Types.LiftedRep) Servant.API.ContentTypes.PlainText ('[] (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text)))) (Polysemy.Internal.Sem (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) InterfaceAdapters.Config.Config) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) UseCases.WWI.WeatherStatusError) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Trace.Trace (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)))))))))</span><span class='hs-varid'>agricultureServer</span></a>
<span class=hs-linenum>53: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>54: </span>    <a class=annot href="#"><span class=annottext>forall a .
InterfaceAdapters.Config.Config -&gt; (Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (UseCases.WWI.WWI ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) InterfaceAdapters.Config.Config) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) UseCases.WWI.WeatherStatusError) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Trace.Trace ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)))))))) a) -&gt; (Servant.Server.Internal.Handler.Handler a)</span><span class='hs-varid'>interpretServer</span></a> <a class=annot href="#"><span class=annottext>InterfaceAdapters.Config.Config</span><span class='hs-varid'>conf</span></a> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) InterfaceAdapters.Config.Config) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) UseCases.WWI.WeatherStatusError) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Trace.Trace (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))))) a)</span><span class='hs-varid'>sem</span></a>  <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>{v : (Polysemy.Internal.Sem (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (UseCases.WWI.WWI (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) InterfaceAdapters.Config.Config) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) UseCases.WWI.WeatherStatusError) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Trace.Trace (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))))) a) | v == sem}</span><span class='hs-varid'>sem</span></a>
<span class=hs-linenum>55: </span>      <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (UseCases.WWI.WWI ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) InterfaceAdapters.Config.Config) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) UseCases.WWI.WeatherStatusError) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Trace.Trace ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)))))))) a) -&gt; (Polysemy.Internal.Sem (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) InterfaceAdapters.Config.Config) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) UseCases.WWI.WeatherStatusError) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Trace.Trace (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)))))) a)</span><span class='hs-varid'>selectWWICombination</span></a> <a class=annot href="#"><span class=annottext>{v : InterfaceAdapters.Config.Config | v == conf}</span><span class='hs-varid'>conf</span></a>
<span class=hs-linenum>56: </span>      <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) InterfaceAdapters.Config.Config) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) UseCases.WWI.WeatherStatusError) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Trace.Trace ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))))) a) -&gt; (Polysemy.Internal.Sem (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) UseCases.WWI.WeatherStatusError) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Trace.Trace (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))) a)</span><span class='hs-varid'>runInputConst</span></a> <a class=annot href="#"><span class=annottext>{v : InterfaceAdapters.Config.Config | v == conf}</span><span class='hs-varid'>conf</span></a>
<span class=hs-linenum>57: </span>      <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c .
      (Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Error.Error (TYPE 'GHC.Types.LiftedRep) a) b) c) -&gt; (Polysemy.Internal.Sem b (Data.Either.Either a c)) | VV == runError}</span><span class='hs-varid'>runError</span></a> <span class='hs-keyglyph'>@</span><span class='hs-conid'>WeatherStatusError</span>
<span class=hs-linenum>58: </span>      <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Trace.Trace ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))) (Data.Either.Either UseCases.WWI.WeatherStatusError a)) -&gt; (Polysemy.Internal.Sem (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (Data.Either.Either UseCases.WWI.WeatherStatusError a))</span><span class='hs-varid'>selectTraceVerbosity</span></a> <a class=annot href="#"><span class=annottext>{v : InterfaceAdapters.Config.Config | v == conf}</span><span class='hs-varid'>conf</span></a>
<span class=hs-linenum>59: </span>      <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)))) (Data.Either.Either UseCases.WWI.WeatherStatusError a)) -&gt; (GHC.Types.IO (Data.Either.Either UseCases.WWI.WeatherStatusError a))</span><span class='hs-varid'>runM</span></a>
<span class=hs-linenum>60: </span>      <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      (GHC.Types.IO (Data.Either.Either UseCases.WWI.WeatherStatusError a)) -&gt; (Servant.Server.Internal.Handler.Handler a) | VV == liftToHandler}</span><span class='hs-varid'>liftToHandler</span></a>
<span class=hs-linenum>61: </span>    <a class=annot href="#"><span class=annottext>forall a .
(GHC.Types.IO (Data.Either.Either UseCases.WWI.WeatherStatusError a)) -&gt; (Servant.Server.Internal.Handler.Handler a)</span><span class='hs-varid'>liftToHandler</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:(Control.Monad.Trans.Except.ExceptT Servant.Server.Internal.ServerError.ServerError GHC.Types.IO a) -&gt; {VV : (Servant.Server.Internal.Handler.Handler a) | VV ~~ x1}</span><span class='hs-conid'>Handler</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO (Data.Either.Either UseCases.WWI.WeatherStatusError a)) -&gt; (Control.Monad.Trans.Except.ExceptT Servant.Server.Internal.ServerError.ServerError GHC.Types.IO a)</span><span class='hs-conid'>ExceptT</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO (Data.Either.Either UseCases.WWI.WeatherStatusError a)) -&gt; (GHC.Types.IO (Data.Either.Either Servant.Server.Internal.ServerError.ServerError a))</span><span class='hs-varid'>fmap</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      (Data.Either.Either UseCases.WWI.WeatherStatusError a) -&gt; (Data.Either.Either Servant.Server.Internal.ServerError.ServerError a) | VV == handleErrors}</span><span class='hs-varid'>handleErrors</span></a>
<span class=hs-linenum>62: </span>    <a class=annot href="#"><span class=annottext>forall a .
(Data.Either.Either UseCases.WWI.WeatherStatusError a) -&gt; (Data.Either.Either Servant.Server.Internal.ServerError.ServerError a)</span><span class='hs-varid'>handleErrors</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Left</span> <span class='hs-layout'>(</span><span class='hs-conid'>WeatherStatusNotPossible</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b . a -&gt; (Data.Either.Either a b) | VV == Left}</span><span class='hs-conid'>Left</span></a> <a class=annot href="#"><span class=annottext>Servant.Server.Internal.ServerError.ServerError</span><span class='hs-varid'>err412</span></a> <span class='hs-layout'>{</span> <span class='hs-varid'>errBody</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Lazy.Internal.ByteString</span><span class='hs-varid'>pack</span></a> <span class='hs-varid'>msg</span><span class='hs-layout'>}</span>
<span class=hs-linenum>63: </span>    <span class='hs-varid'>handleErrors</span> <span class='hs-layout'>(</span><span class='hs-conid'>Right</span> <span class='hs-varid'>value</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b . b -&gt; (Data.Either.Either a b) | VV == Right}</span><span class='hs-conid'>Right</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == value}</span><span class='hs-varid'>value</span></a>
<span class=hs-linenum>64: </span>
<span class=hs-linenum>65: </span><span class='hs-comment'>-- | port and verbose are unused</span>
<span class=hs-linenum>66: </span><span class='hs-definition'>selectWWICombination</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Input</span> <span class='hs-conid'>Config</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span> <span class='hs-conid'>Trace</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<span class=hs-linenum>67: </span>                 <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Config</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-layout'>(</span><span class='hs-conid'>WWI</span> <span class='hs-conop'>:</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>68: </span><a class=annot href="#"><span class=annottext>forall a b .
(GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) InterfaceAdapters.Config.Config) a) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Input.Input (TYPE 'GHC.Types.LiftedRep) (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) InterfaceAdapters.Config.Config) a) '()), GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a) '()), GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Trace.Trace (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) a) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Trace.Trace (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) a) '())) =&gt;
InterfaceAdapters.Config.Config -&gt; (Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (UseCases.WWI.WWI ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) a) b) -&gt; (Polysemy.Internal.Sem a b)</span><span class='hs-definition'>selectWWICombination</span></a> <span class='hs-conid'>Config</span> <span class='hs-layout'>{</span><span class='hs-varid'>port</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>8080</span><span class='hs-layout'>,</span> <span class='hs-varid'>backend</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PirateWeather</span><span class='hs-layout'>,</span> <span class='hs-varid'>frontend</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Telegram</span><span class='hs-layout'>,</span> <span class='hs-varid'>geoend</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>OpenCage</span><span class='hs-layout'>,</span> <span class='hs-varid'>gateway</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AWSAPIRest</span><span class='hs-layout'>,</span>  <span class='hs-varid'>verbose</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : ((Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a) '())) | v == $d(%,%)_a5bW3}</span><span class='hs-varid'>runWWITelegramPirate</span></a>
<span class=hs-linenum>69: </span><span class='hs-definition'>selectWWICombination</span> <span class='hs-conid'>Config</span> <span class='hs-layout'>{</span><span class='hs-varid'>port</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>8080</span><span class='hs-layout'>,</span> <span class='hs-varid'>backend</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PirateWeather</span><span class='hs-layout'>,</span> <span class='hs-varid'>frontend</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Web</span><span class='hs-layout'>,</span> <span class='hs-varid'>geoend</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>OpenCage</span><span class='hs-layout'>,</span> <span class='hs-varid'>gateway</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AWSAPIRest</span><span class='hs-layout'>,</span>  <span class='hs-varid'>verbose</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : ((Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a) '())) | v == $d(%,%)_a5bW3}</span><span class='hs-varid'>runWWIWebPirate</span></a>
<span class=hs-linenum>70: </span>
<span class=hs-linenum>71: </span><span class='hs-comment'>-- | if the config flag verbose is set to True, trace to Console, else ignore all trace messages</span>
<span class=hs-linenum>72: </span><span class='hs-definition'>selectTraceVerbosity</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Config</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Sem</span> <span class='hs-layout'>(</span><span class='hs-conid'>Trace</span> <span class='hs-conop'>:</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>73: </span><a class=annot href="#"><span class=annottext>forall a b .
(GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a) '())) =&gt;
InterfaceAdapters.Config.Config -&gt; (Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Trace.Trace ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) a) b) -&gt; (Polysemy.Internal.Sem a b)</span><span class='hs-definition'>selectTraceVerbosity</span></a> <a class=annot href="#"><span class=annottext>InterfaceAdapters.Config.Config</span><span class='hs-varid'>config</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>74: </span>  <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>verbose</span></a> <a class=annot href="#"><span class=annottext>{v : InterfaceAdapters.Config.Config | v == config}</span><span class='hs-varid'>config</span></a>
<span class=hs-linenum>75: </span>    <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{v : ((Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a) '())) | v == $d(%,%)_a5bVS}</span><span class='hs-varid'>traceToStdout</span></a>
<span class=hs-linenum>76: </span>    <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>{VV : forall a b .
      (Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Trace.Trace ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) a) b) -&gt; (Polysemy.Internal.Sem a b) | VV == ignoreTrace}</span><span class='hs-varid'>ignoreTrace</span></a>
<span class=hs-linenum>77: </span>
</pre>
</body>
</html>