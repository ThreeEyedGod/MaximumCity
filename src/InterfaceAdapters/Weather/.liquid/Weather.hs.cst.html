<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/InterfaceAdapters/Weather/Weather.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>{VV##3386 : GHC.Types.Module | $k_##3387}</span><span class='hs-comment'>{-# LANGUAGE DuplicateRecordFields #-}</span></a>
<span class=hs-linenum> 2: </span><span class='hs-comment'>{-# LANGUAGE OverloadedStrings #-}</span>
<span class=hs-linenum> 3: </span><span class='hs-comment'>{-# OPTIONS_GHC -Wno-orphans #-}</span>
<span class=hs-linenum> 4: </span>
<span class=hs-linenum> 5: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>InterfaceAdapters.Weather.Weather</span>
<span class=hs-linenum> 6: </span><span class='hs-layout'>(</span>
<span class=hs-linenum> 7: </span>    <span class='hs-sel'>_getTownNameWeatherFromIp</span>
<span class=hs-linenum> 8: </span>  <span class='hs-layout'>,</span> <span class='hs-sel'>_getTownNameWeatherFromTown</span>
<span class=hs-linenum> 9: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>getWeather</span>
<span class=hs-linenum>10: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>PreprocessedHeaders</span>
<span class=hs-linenum>11: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>getAgInfo</span>
<span class=hs-linenum>12: </span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>13: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Monad.IO.Class</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>14: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.ByteString.Lazy.Char8</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>LB</span>
<span class=hs-linenum>15: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Data.ByteString.Char8</span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<span class=hs-linenum>17: </span><span class='hs-comment'>--import GHC.Integer.Logarithms ()</span>
<span class=hs-linenum>18: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text.Encoding</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TSE</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>19: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text.Lazy.Encoding</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TLE</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>20: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.ByteString.UTF8</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>BSU</span> <span class='hs-layout'>(</span> <span class='hs-varid'>toString</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>21: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>22: </span>
<span class=hs-linenum>23: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Weather.OpenWeatherAPI</span>
<span class=hs-linenum>24: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>getWeatherForTown</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>25: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Weather.PirateWeatherAPI</span>
<span class=hs-linenum>26: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>weatherCurrentForecastMini</span><span class='hs-layout'>,</span>
<span class=hs-linenum>27: </span>      <span class='hs-sel'>_getWeatherForTown</span><span class='hs-layout'>,</span>
<span class=hs-linenum>28: </span>      <span class='hs-varid'>weatherCurrentForecast</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>29: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.IP.IP2Location</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>30: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Water.MH.Core.WaterLevelLakes</span>
<span class=hs-linenum>31: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>getWaterLakeLevelForPlace_LiveToday_wrtStorage</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>32: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Water.MH.Core.WaterLevelHeaders</span>
<span class=hs-linenum>33: </span>    <span class='hs-layout'>(</span> <span class='hs-conid'>PercentLiveStorage</span><span class='hs-layout'>(</span><span class='hs-varid'>percent_Today</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Region</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>34: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Utils.HttpHeadersPathDefinitions</span>
<span class=hs-linenum>35: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>extractXForwardedForHeader</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>36: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Preferences</span>
<span class=hs-linenum>37: </span>    <span class='hs-layout'>(</span> <span class='hs-conid'>Timespan</span><span class='hs-layout'>(</span><span class='hs-conid'>RightNow</span><span class='hs-layout'>,</span> <span class='hs-conid'>NearForecast</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum>38: </span>      <span class='hs-conid'>Datasize</span><span class='hs-layout'>(</span><span class='hs-conid'>Mini</span><span class='hs-layout'>,</span> <span class='hs-conid'>Detailed</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum>39: </span>      <span class='hs-conid'>Agdata</span><span class='hs-layout'>(</span><span class='hs-conid'>WaterLevels</span><span class='hs-layout'>,</span> <span class='hs-conid'>WeatherWaterLevels</span><span class='hs-layout'>,</span> <span class='hs-conid'>Weather</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum>40: </span>      <span class='hs-conid'>Preferences</span><span class='hs-layout'>(</span><span class='hs-conid'>Preferences</span><span class='hs-layout'>,</span> <span class='hs-varid'>userdata</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span><span class='hs-layout'>)</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>41: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>UseCases.WWI</span> <span class='hs-layout'>(</span><span class='hs-conid'>UserAsk</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>PlaceName</span><span class='hs-layout'>,</span> <span class='hs-conid'>TheWeatherThere</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>42: </span>
<span class=hs-linenum>43: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>PreprocessedHeaders</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>LB.ByteString</span>
<span class=hs-linenum>44: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>WaterLevel</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>String</span>
<span class=hs-linenum>45: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>WeatherText</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>46: </span>
<span class=hs-linenum>47: </span><span class='hs-sel'>_getTownNameWeatherFromIp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>48: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##4560:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromIp</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>town</span></a>
<span class=hs-linenum>49: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"Fail"</span></a> <span class='hs-varop'>`T.isPrefixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4604 : Data.Text.Internal.Text | lq_tmp$x##4604 == town##a55Xx}</span><span class='hs-varid'>town</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4669 : (GHC.Base.Monad GHC.Types.IO) | lq_tmp$x##4669 == GHC.Base.$fMonadIO}</span><span class='hs-varid'>return</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"Fail:getTownNameWeatherFromIp | town"</span></a>
<span class=hs-linenum>50: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4617:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromTown</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4618 : Data.Text.Internal.Text | lq_tmp$x##4618 == town##a55Xx}</span><span class='hs-varid'>town</span></a>
<span class=hs-linenum>51: </span>
<span class=hs-linenum>52: </span><span class='hs-comment'>-- | water levels of lakes in a region as percent of same time last year or full capacity</span>
<span class=hs-linenum>53: </span><span class='hs-comment'>-- | from Water modules </span>
<span class=hs-linenum>54: </span><span class='hs-sel'>_helperLivePercent</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>Region</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>PercentLiveStorage</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>String</span>
<span class=hs-linenum>55: </span><a class=annot href="#"><span class=annottext>ds_d5624:{VV##3427 : ({VV##3416 : (GHC.Maybe.Maybe {VV##3414 : Data.ByteString.Internal.ByteString | $k_##3415}) | $k_##3417}, {VV##3420 : (GHC.Maybe.Maybe {VV##3418 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3419}) | $k_##3421})&lt;\lq_tmp$x##3422 VV -&gt; {VV##3425 : (GHC.Maybe.Maybe {VV##3423 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3424}) | $k_##3426}&gt; | $k_##3428} -&gt; {VV##3437 : (GHC.Types.IO {VV##3435 : [{VV##3430 : GHC.Types.Char | $k_##3431}]&lt;\lq_tmp$x##3432 VV -&gt; {VV##3433 : GHC.Types.Char | $k_##3434}&gt; | $k_##3436}) | $k_##3438}</span><span class='hs-sel'>_helperLivePercent</span></a> <span class='hs-layout'>(</span> <span class='hs-conid'>Nothing</span> <span class='hs-layout'>,</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3517 : (GHC.Base.Applicative GHC.Types.IO) | lq_tmp$x##3517 == GHC.Base.$fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>" No Region detectable for determining lake levels "</span></a>
<span class=hs-linenum>56: </span><span class='hs-sel'>_helperLivePercent</span> <span class='hs-layout'>(</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>,</span> <span class='hs-conid'>Nothing</span> <span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3582 : (GHC.Base.Applicative GHC.Types.IO) | lq_tmp$x##3582 == GHC.Base.$fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>" No Water Data can be found for place provided "</span></a>
<span class=hs-linenum>57: </span><span class='hs-sel'>_helperLivePercent</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##16:{lq_tmp$x##3888 : [{lq_tmp$x##3885 : GHC.Types.Char | $k_##3879[VV##3878:=lq_tmp$x##3885][VV##3883:=lq_tmp$x##3888]}]&lt;\lq_tmp$x##3886 VV -&gt; {lq_tmp$x##3887 : GHC.Types.Char | $k_##3882[VV##3881:=lq_tmp$x##3887][VV##3883:=lq_tmp$x##3888][lq_tmp$x##3880:=lq_tmp$x##3886]}&gt; | $k_##3884[VV##3883:=lq_tmp$x##3888]} -&gt; (GHC.Types.IO {lq_tmp$x##3888 : [{lq_tmp$x##3885 : GHC.Types.Char | $k_##3879[VV##3878:=lq_tmp$x##3885][VV##3883:=lq_tmp$x##3888]}]&lt;\lq_tmp$x##3886 VV -&gt; {lq_tmp$x##3887 : GHC.Types.Char | $k_##3882[VV##3881:=lq_tmp$x##3887][VV##3883:=lq_tmp$x##3888][lq_tmp$x##3880:=lq_tmp$x##3886]}&gt; | $k_##3884[VV##3883:=lq_tmp$x##3888]})</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>" % livelake level at "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>BSU.toString</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3731 : Data.ByteString.Internal.ByteString | lq_tmp$x##3731 == a##a55Xy
                                                        &amp;&amp; $k_##3415[VV##3414:=lq_tmp$x##3731][VV##3416:=lq_anf$##7205759403794008551##d563Z][VV##3427:=lq_anf$##7205759403794008548##d563W][liquid_internal_this:=lq_anf$##7205759403794008548##d563W][lq_tmp$x##3439:=lq_tmp$x##3731][lq_tmp$x##3440:=lq_anf$##7205759403794008551##d563Z][lq_tmp$x##3446:=lq_anf$##7205759403794008548##d563W][lq_tmp$x##3449:=lq_tmp$x##3731][lq_tmp$x##3450:=lq_anf$##7205759403794008551##d563Z][lq_tmp$x##3456:=lq_anf$##7205759403794008548##d563W][lq_tmp$x##3613:=lq_tmp$x##3731][lq_tmp$x##3614:=lq_anf$##7205759403794008551##d563Z][lq_tmp$x##3648:=lq_tmp$x##3731][lq_tmp$x##3649:=lq_anf$##7205759403794008551##d563Z]}</span><span class='hs-varid'>a</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>" is "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>BSU.toString</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-layout'>(</span></a><span class='hs-varid'>percent_Today</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3749 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | lq_tmp$x##3749 == b##a55Xz
                                                                                         &amp;&amp; $k_##3419[VV##3418:=lq_tmp$x##3749][VV##3420:=lq_anf$##7205759403794008553##d5641][VV##3427:=lq_anf$##7205759403794008548##d563W][liquid_internal_this:=lq_anf$##7205759403794008548##d563W][lq_tmp$x##3441:=lq_tmp$x##3749][lq_tmp$x##3442:=lq_anf$##7205759403794008553##d5641][lq_tmp$x##3446:=lq_anf$##7205759403794008548##d563W][lq_tmp$x##3451:=lq_tmp$x##3749][lq_tmp$x##3452:=lq_anf$##7205759403794008553##d5641][lq_tmp$x##3454:=lq_tmp$x##3749][lq_tmp$x##3455:=lq_anf$##7205759403794008553##d5641][lq_tmp$x##3456:=lq_anf$##7205759403794008548##d563W][lq_tmp$x##3467:=ds_d562o][lq_tmp$x##3662:=lq_tmp$x##3749][lq_tmp$x##3663:=lq_anf$##7205759403794008553##d5641][lq_tmp$x##3697:=lq_tmp$x##3749][lq_tmp$x##3698:=lq_anf$##7205759403794008553##d5641]
                                                                                         &amp;&amp; $k_##3424[VV##3423:=lq_tmp$x##3749][VV##3425:=lq_anf$##7205759403794008553##d5641][VV##3427:=lq_anf$##7205759403794008548##d563W][liquid_internal_this:=lq_anf$##7205759403794008548##d563W][lq_tmp$x##3422:=ds_d562o][lq_tmp$x##3443:=ds_d562o][lq_tmp$x##3444:=lq_tmp$x##3749][lq_tmp$x##3445:=lq_anf$##7205759403794008553##d5641][lq_tmp$x##3446:=lq_anf$##7205759403794008548##d563W][lq_tmp$x##3447:=ds_d562o][lq_tmp$x##3451:=lq_tmp$x##3749][lq_tmp$x##3452:=lq_anf$##7205759403794008553##d5641][lq_tmp$x##3453:=ds_d562o][lq_tmp$x##3454:=lq_tmp$x##3749][lq_tmp$x##3455:=lq_anf$##7205759403794008553##d5641][lq_tmp$x##3456:=lq_anf$##7205759403794008548##d563W][lq_tmp$x##3457:=ds_d562o][lq_tmp$x##3467:=ds_d562o][lq_tmp$x##3662:=lq_tmp$x##3749][lq_tmp$x##3663:=lq_anf$##7205759403794008553##d5641][lq_tmp$x##3697:=lq_tmp$x##3749][lq_tmp$x##3698:=lq_anf$##7205759403794008553##d5641]}</span><span class='hs-varid'>b</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>58: </span>
<span class=hs-linenum>59: </span><span class='hs-sel'>_mkWeatherThere</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WeatherText</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WaterLevel</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>60: </span><a class=annot href="#"><span class=annottext>twn##a55XA:{VV##3895 : Data.Text.Internal.Text | $k_##3896} -&gt; ds_d561P:{VV##3898 : Data.Text.Internal.Text | $k_##3899} -&gt; wl##a55XB:{VV##3906 : [{VV##3901 : GHC.Types.Char | $k_##3902}]&lt;\lq_tmp$x##3903 VV -&gt; {VV##3904 : GHC.Types.Char | $k_##3905}&gt; | $k_##3907} -&gt; {VV##3911 : (GHC.Types.IO {VV##3909 : Data.Text.Internal.Text | $k_##3910}) | $k_##3912}</span><span class='hs-sel'>_mkWeatherThere</span></a> <a class=annot href="#"><span class=annottext>{VV##3895 : Data.Text.Internal.Text | $k_##3896}</span><span class='hs-varid'>twn</span></a> <span class='hs-layout'>(</span><span class='hs-str'>""</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span><span class='hs-layout'>)</span>  <a class=annot href="#"><span class=annottext>{VV##3906 : [{VV##3901 : GHC.Types.Char | $k_##3902}]&lt;\lq_tmp$x##3903 VV -&gt; {VV##3904 : GHC.Types.Char | $k_##3905}&gt; | $k_##3907}</span><span class='hs-varid'>wl</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##16:{lq_tmp$x##4256 : Data.Text.Internal.Text | $k_##4255[VV##4254:=lq_tmp$x##4256]} -&gt; (GHC.Types.IO {lq_tmp$x##4256 : Data.Text.Internal.Text | $k_##4255[VV##4254:=lq_tmp$x##4256]})</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Data.ByteString.Char8.pack</span></a> <a class=annot href="#"><span class=annottext>[{lq_tmp$x##4215 : GHC.Types.Char | $k_##4214[VV##4213:=lq_tmp$x##4215][lq_tmp$x##4208:=lq_anf$##7205759403794008585##d564x][lq_tmp$x##4209:=wl##a55XB]}]</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>Data.ByteString.Char8.unpack</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>""</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4224 : [{lq_tmp$x##4221 : GHC.Types.Char | $k_##3902[VV##3901:=lq_tmp$x##4221][VV##3906:=lq_tmp$x##4224]}]&lt;\lq_tmp$x##4225 VV -&gt; {lq_tmp$x##4223 : GHC.Types.Char | $k_##3905[VV##3904:=lq_tmp$x##4223][VV##3906:=lq_tmp$x##4224][lq_tmp$x##3903:=lq_tmp$x##4225][lq_tmp$x##4222:=lq_tmp$x##4225]}&gt; | lq_tmp$x##4224 == wl##a55XB
                                                                                                                                                                                                                                                                                                                 &amp;&amp; $k_##3907[VV##3906:=lq_tmp$x##4224]}</span><span class='hs-varid'>wl</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>61: </span><span class='hs-sel'>_mkWeatherThere</span> <span class='hs-varid'>twn</span> <span class='hs-varid'>wt</span> <span class='hs-varid'>wl</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##16:{lq_tmp$x##4140 : Data.Text.Internal.Text | $k_##4139[VV##4138:=lq_tmp$x##4140]} -&gt; (GHC.Types.IO {lq_tmp$x##4140 : Data.Text.Internal.Text | $k_##4139[VV##4138:=lq_tmp$x##4140]})</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Data.ByteString.Char8.pack</span></a>  <a class=annot href="#"><span class=annottext>[{lq_tmp$x##4099 : GHC.Types.Char | $k_##4098[VV##4097:=lq_tmp$x##4099][lq_tmp$x##4092:=lq_anf$##7205759403794008575##d564n][lq_tmp$x##4093:=lq_anf$##7205759403794008580##d564s]}]</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>Data.ByteString.Char8.unpack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3982 : Data.Text.Internal.Text | lq_tmp$x##3982 == twn##a55XA
                                            &amp;&amp; $k_##3896[VV##3895:=lq_tmp$x##3982]}</span><span class='hs-varid'>twn</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>" is "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>Data.ByteString.Char8.unpack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4004 : Data.Text.Internal.Text | lq_tmp$x##4004 == ds_d561P
                                            &amp;&amp; $k_##3899[VV##3898:=lq_tmp$x##4004]}</span><span class='hs-varid'>wt</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4038 : [{lq_tmp$x##4035 : GHC.Types.Char | $k_##3902[VV##3901:=lq_tmp$x##4035][VV##3906:=lq_tmp$x##4038]}]&lt;\lq_tmp$x##4039 VV -&gt; {lq_tmp$x##4037 : GHC.Types.Char | $k_##3905[VV##3904:=lq_tmp$x##4037][VV##3906:=lq_tmp$x##4038][lq_tmp$x##3903:=lq_tmp$x##4039][lq_tmp$x##4036:=lq_tmp$x##4039]}&gt; | lq_tmp$x##4038 == wl##a55XB
                                                                                                                                                                                                                                                                                                                 &amp;&amp; $k_##3907[VV##3906:=lq_tmp$x##4038]}</span><span class='hs-varid'>wl</span></a> <span class='hs-layout'>)</span>
<span class=hs-linenum>62: </span>
<span class=hs-linenum>63: </span><span class='hs-sel'>_handlePirateResponse</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>WeatherText</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WaterLevel</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>64: </span><a class=annot href="#"><span class=annottext>weather1##a55XF:{VV##4259 : Data.Text.Internal.Text | $k_##4260} -&gt; town##a55XG:{VV##4262 : Data.Text.Internal.Text | $k_##4263} -&gt; wll##a55XH:{VV##4270 : [{VV##4265 : GHC.Types.Char | $k_##4266}]&lt;\lq_tmp$x##4267 VV -&gt; {VV##4268 : GHC.Types.Char | $k_##4269}&gt; | $k_##4271} -&gt; {VV##4275 : (GHC.Types.IO {VV##4273 : Data.Text.Internal.Text | $k_##4274}) | $k_##4276}</span><span class='hs-sel'>_handlePirateResponse</span></a> <a class=annot href="#"><span class=annottext>{VV##4259 : Data.Text.Internal.Text | $k_##4260}</span><span class='hs-varid'>weather1</span></a> <a class=annot href="#"><span class=annottext>{VV##4262 : Data.Text.Internal.Text | $k_##4263}</span><span class='hs-varid'>town</span></a> <a class=annot href="#"><span class=annottext>{VV##4270 : [{VV##4265 : GHC.Types.Char | $k_##4266}]&lt;\lq_tmp$x##4267 VV -&gt; {VV##4268 : GHC.Types.Char | $k_##4269}&gt; | $k_##4271}</span><span class='hs-varid'>wll</span></a>
<span class=hs-linenum>65: </span>   <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"Fail:"</span></a> <span class='hs-varop'>`T.isPrefixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4319 : Data.Text.Internal.Text | lq_tmp$x##4319 == weather1##a55XF
                                            &amp;&amp; $k_##4260[VV##4259:=lq_tmp$x##4319]}</span><span class='hs-varid'>weather1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-conid'>InterfaceAdapters.Weather.OpenWeatherAPI.getWeatherForTown</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Data.ByteString.Char8.unpack</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4364 : Data.Text.Internal.Text | lq_tmp$x##4364 == town##a55XG
                                            &amp;&amp; $k_##4263[VV##4262:=lq_tmp$x##4364]}</span><span class='hs-varid'>town</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4389 : (GHC.Types.IO {lq_tmp$x##4388 : Data.Text.Internal.Text | $k_##3910[VV##3909:=lq_tmp$x##4388][VV##3911:=lq_tmp$x##4389][ds_d561P:=weather2##a55XI][lq_tmp$x##4394:=town##a55XG][lq_tmp$x##4395:=weather2##a55XI][lq_tmp$x##4396:=wll##a55XH][twn##a55XA:=town##a55XG][wl##a55XB:=wll##a55XH]}) | $k_##3912[VV##3911:=lq_tmp$x##4389][ds_d561P:=weather2##a55XI][lq_tmp$x##4394:=town##a55XG][lq_tmp$x##4395:=weather2##a55XI][lq_tmp$x##4396:=wll##a55XH][twn##a55XA:=town##a55XG][wl##a55XB:=wll##a55XH]}</span><span class='hs-layout'>(</span></a><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>weather2</span></a> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-sel'>_mkWeatherThere</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4398 : Data.Text.Internal.Text | lq_tmp$x##4398 == town##a55XG
                                            &amp;&amp; $k_##4263[VV##4262:=lq_tmp$x##4398]}</span><span class='hs-varid'>town</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4399 : Data.Text.Internal.Text | lq_tmp$x##4399 == weather2##a55XI}</span><span class='hs-varid'>weather2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4403 : [{lq_tmp$x##4400 : GHC.Types.Char | $k_##4266[VV##4265:=lq_tmp$x##4400][VV##4270:=lq_tmp$x##4403]}]&lt;\lq_tmp$x##4404 VV -&gt; {lq_tmp$x##4402 : GHC.Types.Char | $k_##4269[VV##4268:=lq_tmp$x##4402][VV##4270:=lq_tmp$x##4403][lq_tmp$x##4267:=lq_tmp$x##4404][lq_tmp$x##4401:=lq_tmp$x##4404]}&gt; | lq_tmp$x##4403 == wll##a55XH
                                                                                                                                                                                                                                                                                                                 &amp;&amp; $k_##4271[VV##4270:=lq_tmp$x##4403]}</span><span class='hs-varid'>wll</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>66: </span>   <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>lq_tmp$x##4340:{lq_tmp$x##4328 : Data.Text.Internal.Text | $k_##3896[VV##3895:=lq_tmp$x##4328]} -&gt; lq_tmp$x##4341:{lq_tmp$x##4329 : Data.Text.Internal.Text | $k_##3899[VV##3898:=lq_tmp$x##4329][twn##a55XA:=lq_tmp$x##4340]} -&gt; lq_tmp$x##4342:{lq_tmp$x##4333 : [{lq_tmp$x##4330 : GHC.Types.Char | $k_##3902[VV##3901:=lq_tmp$x##4330][VV##3906:=lq_tmp$x##4333][ds_d561P:=lq_tmp$x##4341][twn##a55XA:=lq_tmp$x##4340]}]&lt;\lq_tmp$x##4343 VV -&gt; {lq_tmp$x##4332 : GHC.Types.Char | $k_##3905[VV##3904:=lq_tmp$x##4332][VV##3906:=lq_tmp$x##4333][ds_d561P:=lq_tmp$x##4341][lq_tmp$x##3903:=lq_tmp$x##4343][lq_tmp$x##4331:=lq_tmp$x##4343][lq_tmp$x##4339:=lq_tmp$x##4343][twn##a55XA:=lq_tmp$x##4340]}&gt; | $k_##3907[VV##3906:=lq_tmp$x##4333][ds_d561P:=lq_tmp$x##4341][twn##a55XA:=lq_tmp$x##4340]} -&gt; {lq_tmp$x##4335 : (GHC.Types.IO {lq_tmp$x##4334 : Data.Text.Internal.Text | $k_##3910[VV##3909:=lq_tmp$x##4334][VV##3911:=lq_tmp$x##4335][ds_d561P:=lq_tmp$x##4341][twn##a55XA:=lq_tmp$x##4340][wl##a55XB:=lq_tmp$x##4342]}) | $k_##3912[VV##3911:=lq_tmp$x##4335][ds_d561P:=lq_tmp$x##4341][twn##a55XA:=lq_tmp$x##4340][wl##a55XB:=lq_tmp$x##4342]}</span><span class='hs-sel'>_mkWeatherThere</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4344 : Data.Text.Internal.Text | lq_tmp$x##4344 == town##a55XG
                                            &amp;&amp; $k_##4263[VV##4262:=lq_tmp$x##4344]}</span><span class='hs-varid'>town</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4345 : Data.Text.Internal.Text | lq_tmp$x##4345 == weather1##a55XF
                                            &amp;&amp; $k_##4260[VV##4259:=lq_tmp$x##4345]}</span><span class='hs-varid'>weather1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4349 : [{lq_tmp$x##4346 : GHC.Types.Char | $k_##4266[VV##4265:=lq_tmp$x##4346][VV##4270:=lq_tmp$x##4349]}]&lt;\lq_tmp$x##4350 VV -&gt; {lq_tmp$x##4348 : GHC.Types.Char | $k_##4269[VV##4268:=lq_tmp$x##4348][VV##4270:=lq_tmp$x##4349][lq_tmp$x##4267:=lq_tmp$x##4350][lq_tmp$x##4347:=lq_tmp$x##4350]}&gt; | lq_tmp$x##4349 == wll##a55XH
                                                                                                                                                                                                                                                                                                                 &amp;&amp; $k_##4271[VV##4270:=lq_tmp$x##4349]}</span><span class='hs-varid'>wll</span></a>
<span class=hs-linenum>67: </span>
<span class=hs-linenum>68: </span><span class='hs-sel'>_getTownNameWeatherFromTown</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>69: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##4406:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromTown</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>town</span></a> <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##4476 : [{lq_tmp$x##4473 : GHC.Types.Char | $k_##4467[VV##4466:=lq_tmp$x##4473][VV##4471:=lq_tmp$x##4476][lq_tmp$x##8:=lq_anf$##7205759403794008594##d564G][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##4474 VV -&gt; {lq_tmp$x##4475 : GHC.Types.Char | $k_##4470[VV##4469:=lq_tmp$x##4475][VV##4471:=lq_tmp$x##4476][lq_tmp$x##4468:=lq_tmp$x##4474][lq_tmp$x##8:=lq_anf$##7205759403794008594##d564G][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | $k_##4472[VV##4471:=lq_tmp$x##4476][lq_tmp$x##8:=lq_anf$##7205759403794008594##d564G][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]})</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Types.IO ((GHC.Maybe.Maybe Data.ByteString.Internal.ByteString), (GHC.Maybe.Maybe InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage)))</span><span class='hs-varid'>getWaterLakeLevelForPlace_LiveToday_wrtStorage</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4421 : Data.Text.Internal.Text | lq_tmp$x##4421 == town##a55XJ}</span><span class='hs-varid'>town</span></a> <span class='hs-varop'>&gt;&gt;=</span>  <a class=annot href="#"><span class=annottext>lq_tmp$x##4502:{lq_tmp$x##4494 : ({lq_tmp$x##4488 : (GHC.Maybe.Maybe {lq_tmp$x##4487 : Data.ByteString.Internal.ByteString | $k_##3415[VV##3414:=lq_tmp$x##4487][VV##3416:=lq_tmp$x##4488][VV##3427:=lq_tmp$x##4494]}) | $k_##3417[VV##3416:=lq_tmp$x##4488][VV##3427:=lq_tmp$x##4494]}, {lq_tmp$x##4490 : (GHC.Maybe.Maybe {lq_tmp$x##4489 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3419[VV##3418:=lq_tmp$x##4489][VV##3420:=lq_tmp$x##4490][VV##3427:=lq_tmp$x##4494]}) | $k_##3421[VV##3420:=lq_tmp$x##4490][VV##3427:=lq_tmp$x##4494]})&lt;\lq_tmp$x##4503 VV -&gt; {lq_tmp$x##4493 : (GHC.Maybe.Maybe {lq_tmp$x##4492 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3424[VV##3423:=lq_tmp$x##4492][VV##3425:=lq_tmp$x##4493][VV##3427:=lq_tmp$x##4494][lq_tmp$x##3422:=lq_tmp$x##4503][lq_tmp$x##4491:=lq_tmp$x##4503][lq_tmp$x##4501:=lq_tmp$x##4503]}) | $k_##3426[VV##3425:=lq_tmp$x##4493][VV##3427:=lq_tmp$x##4494][lq_tmp$x##3422:=lq_tmp$x##4503][lq_tmp$x##4491:=lq_tmp$x##4503][lq_tmp$x##4501:=lq_tmp$x##4503]}&gt; | $k_##3428[VV##3427:=lq_tmp$x##4494]} -&gt; {lq_tmp$x##4499 : (GHC.Types.IO {lq_tmp$x##4498 : [{lq_tmp$x##4495 : GHC.Types.Char | $k_##3431[VV##3430:=lq_tmp$x##4495][VV##3435:=lq_tmp$x##4498][VV##3437:=lq_tmp$x##4499][ds_d5624:=lq_tmp$x##4502]}]&lt;\lq_tmp$x##4504 VV -&gt; {lq_tmp$x##4497 : GHC.Types.Char | $k_##3434[VV##3433:=lq_tmp$x##4497][VV##3435:=lq_tmp$x##4498][VV##3437:=lq_tmp$x##4499][ds_d5624:=lq_tmp$x##4502][lq_tmp$x##3432:=lq_tmp$x##4504][lq_tmp$x##4496:=lq_tmp$x##4504]}&gt; | $k_##3436[VV##3435:=lq_tmp$x##4498][VV##3437:=lq_tmp$x##4499][ds_d5624:=lq_tmp$x##4502]}) | $k_##3438[VV##3437:=lq_tmp$x##4499][ds_d5624:=lq_tmp$x##4502]}</span><span class='hs-sel'>_helperLivePercent</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span>
<span class=hs-linenum>70: </span>  <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4476 : [{lq_tmp$x##4473 : GHC.Types.Char | $k_##4467[VV##4466:=lq_tmp$x##4473][VV##4471:=lq_tmp$x##4476][lq_tmp$x##8:=lq_anf$##7205759403794008594##d564G][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##4474 VV -&gt; {lq_tmp$x##4475 : GHC.Types.Char | $k_##4470[VV##4469:=lq_tmp$x##4475][VV##4471:=lq_tmp$x##4476][lq_tmp$x##4468:=lq_tmp$x##4474][lq_tmp$x##8:=lq_anf$##7205759403794008594##d564G][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | $k_##4472[VV##4471:=lq_tmp$x##4476][lq_tmp$x##8:=lq_anf$##7205759403794008594##d564G][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}</span><span class='hs-varid'>wl</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-conid'>InterfaceAdapters.Weather.PirateWeatherAPI._getWeatherForTown</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Data.ByteString.Char8.unpack</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4518 : Data.Text.Internal.Text | lq_tmp$x##4518 == town##a55XJ}</span><span class='hs-varid'>town</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span>
<span class=hs-linenum>71: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##4543 : (GHC.Types.IO {lq_tmp$x##4542 : Data.Text.Internal.Text | $k_##4274[VV##4273:=lq_tmp$x##4542][VV##4275:=lq_tmp$x##4543][lq_tmp$x##4548:=w##a55XL][lq_tmp$x##4549:=town##a55XJ][lq_tmp$x##4550:=wl##a55XK][town##a55XG:=town##a55XJ][weather1##a55XF:=w##a55XL][wll##a55XH:=wl##a55XK]}) | $k_##4276[VV##4275:=lq_tmp$x##4543][lq_tmp$x##4548:=w##a55XL][lq_tmp$x##4549:=town##a55XJ][lq_tmp$x##4550:=wl##a55XK][town##a55XG:=town##a55XJ][weather1##a55XF:=w##a55XL][wll##a55XH:=wl##a55XK]}</span><span class='hs-layout'>(</span></a><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>w</span></a> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-sel'>_handlePirateResponse</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4552 : Data.Text.Internal.Text | lq_tmp$x##4552 == w##a55XL}</span><span class='hs-varid'>w</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4553 : Data.Text.Internal.Text | lq_tmp$x##4553 == town##a55XJ}</span><span class='hs-varid'>town</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4557 : [{lq_tmp$x##4554 : GHC.Types.Char | $k_##4467[VV##4466:=lq_tmp$x##4554][VV##4471:=lq_tmp$x##4557][lq_tmp$x##4473:=lq_tmp$x##4554][lq_tmp$x##4476:=lq_tmp$x##4557][lq_tmp$x##8:=lq_anf$##7205759403794008594##d564G][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##4558 VV -&gt; {lq_tmp$x##4556 : GHC.Types.Char | $k_##4470[VV##4469:=lq_tmp$x##4556][VV##4471:=lq_tmp$x##4557][lq_tmp$x##4468:=lq_tmp$x##4558][lq_tmp$x##4474:=lq_tmp$x##4558][lq_tmp$x##4475:=lq_tmp$x##4556][lq_tmp$x##4476:=lq_tmp$x##4557][lq_tmp$x##4555:=lq_tmp$x##4558][lq_tmp$x##8:=lq_anf$##7205759403794008594##d564G][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | lq_tmp$x##4557 == wl##a55XK
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &amp;&amp; $k_##4472[VV##4471:=lq_tmp$x##4557][lq_tmp$x##4476:=lq_tmp$x##4557][lq_tmp$x##8:=lq_anf$##7205759403794008594##d564G][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}</span><span class='hs-varid'>wl</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>72: </span>
<span class=hs-linenum>73: </span><span class='hs-definition'>getWeather</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>PreprocessedHeaders</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>74: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##4675:(GHC.Maybe.Maybe Data.ByteString.Lazy.Internal.ByteString) -&gt; lq_tmp$x##4676:(GHC.Maybe.Maybe Data.Text.Internal.Text) -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-definition'>getWeather</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-varid'>extractXForwardedForHeader</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4883 : Data.ByteString.Lazy.Internal.ByteString | lq_tmp$x##4883 == p##a55XM}</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4917:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromIp</span></a>
<span class=hs-linenum>75: </span><span class='hs-definition'>getWeather</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5093:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromTown</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5094 : Data.Text.Internal.Text | lq_tmp$x##5094 == pl##a55XN}</span><span class='hs-varid'>pl</span></a>
<span class=hs-linenum>76: </span><span class='hs-definition'>getWeather</span> <span class='hs-conid'>Nothing</span> <span class='hs-conid'>Nothing</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5010 : (GHC.Base.Applicative GHC.Types.IO) | lq_tmp$x##5010 == GHC.Base.$fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-layout'>(</span></a><span class='hs-str'>"Hmmm... Something Deeply Wrong"</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TheWeatherThere</span><span class='hs-layout'>)</span>
<span class=hs-linenum>77: </span>
<span class=hs-linenum>78: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-keyglyph'>::</span>  <span class='hs-conid'>UserAsk</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>79: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##5097:UseCases.WWI.UserAsk -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-definition'>getAgInfo</span></a> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>"/prefs"</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##12:{lq_tmp$x##7124 : Data.Text.Internal.Text | $k_##7123[VV##7122:=lq_tmp$x##7124]} -&gt; (GHC.Types.IO {lq_tmp$x##7124 : Data.Text.Internal.Text | $k_##7123[VV##7122:=lq_tmp$x##7124]})</span><span class='hs-varid'>return</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Data.ByteString.Char8.pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"/Preferences related  "</span></a>
<span class=hs-linenum>80: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>"/start"</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##12:{lq_tmp$x##7076 : Data.Text.Internal.Text | $k_##7075[VV##7074:=lq_tmp$x##7076]} -&gt; (GHC.Types.IO {lq_tmp$x##7076 : Data.Text.Internal.Text | $k_##7075[VV##7074:=lq_tmp$x##7076]})</span><span class='hs-varid'>return</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Data.ByteString.Char8.pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"/Start related  "</span></a>
<span class=hs-linenum>81: </span>
<span class=hs-linenum>82: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pfs</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Weather</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5291:[GHC.Types.Char] -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-varid'>weatherCurrentForecast</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5293 : InterfaceAdapters.Preferences.Preferences | lq_tmp$x##5293 == ds_d563h}</span><span class='hs-varid'>pfs</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>Data.ByteString.Char8.unpack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5278 : Data.Text.Internal.Text | lq_tmp$x##5278 == ds_d563g}</span><span class='hs-varid'>pl</span></a>
<span class=hs-linenum>83: </span><span class='hs-comment'>-- getAgInfo UserAsk {placeName = pl, prefs = Preferences {userdata = Weather, usersize = Mini, usertimespan = RightNow}} = weatherCurrentForecastMini $ Data.ByteString.Char8.unpack pl</span>
<span class=hs-linenum>84: </span><span class='hs-comment'>-- getAgInfo UserAsk {placeName = pl, prefs = Preferences {userdata = Weather, usersize = _, usertimespan = _}} = weatherCurrentForecastMini $ Data.ByteString.Char8.unpack pl</span>
<span class=hs-linenum>85: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WaterLevels</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mini</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RightNow</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##5386 : [{lq_tmp$x##5383 : GHC.Types.Char | $k_##5377[VV##5376:=lq_tmp$x##5383][VV##5381:=lq_tmp$x##5386][lq_tmp$x##8:=lq_anf$##7205759403794008657##d565H][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##5384 VV -&gt; {lq_tmp$x##5385 : GHC.Types.Char | $k_##5380[VV##5379:=lq_tmp$x##5385][VV##5381:=lq_tmp$x##5386][lq_tmp$x##5378:=lq_tmp$x##5384][lq_tmp$x##8:=lq_anf$##7205759403794008657##d565H][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | $k_##5382[VV##5381:=lq_tmp$x##5386][lq_tmp$x##8:=lq_anf$##7205759403794008657##d565H][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]})</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Types.IO ((GHC.Maybe.Maybe Data.ByteString.Internal.ByteString), (GHC.Maybe.Maybe InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage)))</span><span class='hs-varid'>getWaterLakeLevelForPlace_LiveToday_wrtStorage</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5331 : Data.Text.Internal.Text | lq_tmp$x##5331 == ds_d563g}</span><span class='hs-varid'>pl</span></a> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5412:{lq_tmp$x##5404 : ({lq_tmp$x##5398 : (GHC.Maybe.Maybe {lq_tmp$x##5397 : Data.ByteString.Internal.ByteString | $k_##3415[VV##3414:=lq_tmp$x##5397][VV##3416:=lq_tmp$x##5398][VV##3427:=lq_tmp$x##5404]}) | $k_##3417[VV##3416:=lq_tmp$x##5398][VV##3427:=lq_tmp$x##5404]}, {lq_tmp$x##5400 : (GHC.Maybe.Maybe {lq_tmp$x##5399 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3419[VV##3418:=lq_tmp$x##5399][VV##3420:=lq_tmp$x##5400][VV##3427:=lq_tmp$x##5404]}) | $k_##3421[VV##3420:=lq_tmp$x##5400][VV##3427:=lq_tmp$x##5404]})&lt;\lq_tmp$x##5413 VV -&gt; {lq_tmp$x##5403 : (GHC.Maybe.Maybe {lq_tmp$x##5402 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3424[VV##3423:=lq_tmp$x##5402][VV##3425:=lq_tmp$x##5403][VV##3427:=lq_tmp$x##5404][lq_tmp$x##3422:=lq_tmp$x##5413][lq_tmp$x##5401:=lq_tmp$x##5413][lq_tmp$x##5411:=lq_tmp$x##5413]}) | $k_##3426[VV##3425:=lq_tmp$x##5403][VV##3427:=lq_tmp$x##5404][lq_tmp$x##3422:=lq_tmp$x##5413][lq_tmp$x##5401:=lq_tmp$x##5413][lq_tmp$x##5411:=lq_tmp$x##5413]}&gt; | $k_##3428[VV##3427:=lq_tmp$x##5404]} -&gt; {lq_tmp$x##5409 : (GHC.Types.IO {lq_tmp$x##5408 : [{lq_tmp$x##5405 : GHC.Types.Char | $k_##3431[VV##3430:=lq_tmp$x##5405][VV##3435:=lq_tmp$x##5408][VV##3437:=lq_tmp$x##5409][ds_d5624:=lq_tmp$x##5412]}]&lt;\lq_tmp$x##5414 VV -&gt; {lq_tmp$x##5407 : GHC.Types.Char | $k_##3434[VV##3433:=lq_tmp$x##5407][VV##3435:=lq_tmp$x##5408][VV##3437:=lq_tmp$x##5409][ds_d5624:=lq_tmp$x##5412][lq_tmp$x##3432:=lq_tmp$x##5414][lq_tmp$x##5406:=lq_tmp$x##5414]}&gt; | $k_##3436[VV##3435:=lq_tmp$x##5408][VV##3437:=lq_tmp$x##5409][ds_d5624:=lq_tmp$x##5412]}) | $k_##3438[VV##3437:=lq_tmp$x##5409][ds_d5624:=lq_tmp$x##5412]}</span><span class='hs-sel'>_helperLivePercent</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5465:{lq_tmp$x##5456 : [{lq_tmp$x##5453 : GHC.Types.Char | $k_##3902[VV##3901:=lq_tmp$x##5453][VV##3906:=lq_tmp$x##5456][ds_d561P:=lq_anf$##7205759403794008660##d565K][lq_tmp$x##5463:=ds_d563g][lq_tmp$x##5464:=lq_anf$##7205759403794008660##d565K][twn##a55XA:=ds_d563g]}]&lt;\lq_tmp$x##5466 VV -&gt; {lq_tmp$x##5455 : GHC.Types.Char | $k_##3905[VV##3904:=lq_tmp$x##5455][VV##3906:=lq_tmp$x##5456][ds_d561P:=lq_anf$##7205759403794008660##d565K][lq_tmp$x##3903:=lq_tmp$x##5466][lq_tmp$x##5454:=lq_tmp$x##5466][lq_tmp$x##5462:=lq_tmp$x##5466][lq_tmp$x##5463:=ds_d563g][lq_tmp$x##5464:=lq_anf$##7205759403794008660##d565K][twn##a55XA:=ds_d563g]}&gt; | $k_##3907[VV##3906:=lq_tmp$x##5456][ds_d561P:=lq_anf$##7205759403794008660##d565K][lq_tmp$x##5463:=ds_d563g][lq_tmp$x##5464:=lq_anf$##7205759403794008660##d565K][twn##a55XA:=ds_d563g]} -&gt; {lq_tmp$x##5458 : (GHC.Types.IO {lq_tmp$x##5457 : Data.Text.Internal.Text | $k_##3910[VV##3909:=lq_tmp$x##5457][VV##3911:=lq_tmp$x##5458][ds_d561P:=lq_anf$##7205759403794008660##d565K][lq_tmp$x##5463:=ds_d563g][lq_tmp$x##5464:=lq_anf$##7205759403794008660##d565K][twn##a55XA:=ds_d563g][wl##a55XB:=lq_tmp$x##5465]}) | $k_##3912[VV##3911:=lq_tmp$x##5458][ds_d561P:=lq_anf$##7205759403794008660##d565K][lq_tmp$x##5463:=ds_d563g][lq_tmp$x##5464:=lq_anf$##7205759403794008660##d565K][twn##a55XA:=ds_d563g][wl##a55XB:=lq_tmp$x##5465]}</span><span class='hs-sel'>_mkWeatherThere</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5467 : Data.Text.Internal.Text | lq_tmp$x##5467 == ds_d563g}</span><span class='hs-varid'>pl</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>""</span></a>
<span class=hs-linenum>86: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WaterLevels</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mini</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NearForecast</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##5800 : [{lq_tmp$x##5797 : GHC.Types.Char | $k_##5791[VV##5790:=lq_tmp$x##5797][VV##5795:=lq_tmp$x##5800][lq_tmp$x##8:=lq_anf$##7205759403794008662##d565M][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##5798 VV -&gt; {lq_tmp$x##5799 : GHC.Types.Char | $k_##5794[VV##5793:=lq_tmp$x##5799][VV##5795:=lq_tmp$x##5800][lq_tmp$x##5792:=lq_tmp$x##5798][lq_tmp$x##8:=lq_anf$##7205759403794008662##d565M][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | $k_##5796[VV##5795:=lq_tmp$x##5800][lq_tmp$x##8:=lq_anf$##7205759403794008662##d565M][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]})</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Types.IO ((GHC.Maybe.Maybe Data.ByteString.Internal.ByteString), (GHC.Maybe.Maybe InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage)))</span><span class='hs-varid'>getWaterLakeLevelForPlace_LiveToday_wrtStorage</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5745 : Data.Text.Internal.Text | lq_tmp$x##5745 == ds_d563g}</span><span class='hs-varid'>pl</span></a> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5826:{lq_tmp$x##5818 : ({lq_tmp$x##5812 : (GHC.Maybe.Maybe {lq_tmp$x##5811 : Data.ByteString.Internal.ByteString | $k_##3415[VV##3414:=lq_tmp$x##5811][VV##3416:=lq_tmp$x##5812][VV##3427:=lq_tmp$x##5818]}) | $k_##3417[VV##3416:=lq_tmp$x##5812][VV##3427:=lq_tmp$x##5818]}, {lq_tmp$x##5814 : (GHC.Maybe.Maybe {lq_tmp$x##5813 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3419[VV##3418:=lq_tmp$x##5813][VV##3420:=lq_tmp$x##5814][VV##3427:=lq_tmp$x##5818]}) | $k_##3421[VV##3420:=lq_tmp$x##5814][VV##3427:=lq_tmp$x##5818]})&lt;\lq_tmp$x##5827 VV -&gt; {lq_tmp$x##5817 : (GHC.Maybe.Maybe {lq_tmp$x##5816 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3424[VV##3423:=lq_tmp$x##5816][VV##3425:=lq_tmp$x##5817][VV##3427:=lq_tmp$x##5818][lq_tmp$x##3422:=lq_tmp$x##5827][lq_tmp$x##5815:=lq_tmp$x##5827][lq_tmp$x##5825:=lq_tmp$x##5827]}) | $k_##3426[VV##3425:=lq_tmp$x##5817][VV##3427:=lq_tmp$x##5818][lq_tmp$x##3422:=lq_tmp$x##5827][lq_tmp$x##5815:=lq_tmp$x##5827][lq_tmp$x##5825:=lq_tmp$x##5827]}&gt; | $k_##3428[VV##3427:=lq_tmp$x##5818]} -&gt; {lq_tmp$x##5823 : (GHC.Types.IO {lq_tmp$x##5822 : [{lq_tmp$x##5819 : GHC.Types.Char | $k_##3431[VV##3430:=lq_tmp$x##5819][VV##3435:=lq_tmp$x##5822][VV##3437:=lq_tmp$x##5823][ds_d5624:=lq_tmp$x##5826]}]&lt;\lq_tmp$x##5828 VV -&gt; {lq_tmp$x##5821 : GHC.Types.Char | $k_##3434[VV##3433:=lq_tmp$x##5821][VV##3435:=lq_tmp$x##5822][VV##3437:=lq_tmp$x##5823][ds_d5624:=lq_tmp$x##5826][lq_tmp$x##3432:=lq_tmp$x##5828][lq_tmp$x##5820:=lq_tmp$x##5828]}&gt; | $k_##3436[VV##3435:=lq_tmp$x##5822][VV##3437:=lq_tmp$x##5823][ds_d5624:=lq_tmp$x##5826]}) | $k_##3438[VV##3437:=lq_tmp$x##5823][ds_d5624:=lq_tmp$x##5826]}</span><span class='hs-sel'>_helperLivePercent</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5879:{lq_tmp$x##5870 : [{lq_tmp$x##5867 : GHC.Types.Char | $k_##3902[VV##3901:=lq_tmp$x##5867][VV##3906:=lq_tmp$x##5870][ds_d561P:=lq_anf$##7205759403794008665##d565P][lq_tmp$x##5877:=ds_d563g][lq_tmp$x##5878:=lq_anf$##7205759403794008665##d565P][twn##a55XA:=ds_d563g]}]&lt;\lq_tmp$x##5880 VV -&gt; {lq_tmp$x##5869 : GHC.Types.Char | $k_##3905[VV##3904:=lq_tmp$x##5869][VV##3906:=lq_tmp$x##5870][ds_d561P:=lq_anf$##7205759403794008665##d565P][lq_tmp$x##3903:=lq_tmp$x##5880][lq_tmp$x##5868:=lq_tmp$x##5880][lq_tmp$x##5876:=lq_tmp$x##5880][lq_tmp$x##5877:=ds_d563g][lq_tmp$x##5878:=lq_anf$##7205759403794008665##d565P][twn##a55XA:=ds_d563g]}&gt; | $k_##3907[VV##3906:=lq_tmp$x##5870][ds_d561P:=lq_anf$##7205759403794008665##d565P][lq_tmp$x##5877:=ds_d563g][lq_tmp$x##5878:=lq_anf$##7205759403794008665##d565P][twn##a55XA:=ds_d563g]} -&gt; {lq_tmp$x##5872 : (GHC.Types.IO {lq_tmp$x##5871 : Data.Text.Internal.Text | $k_##3910[VV##3909:=lq_tmp$x##5871][VV##3911:=lq_tmp$x##5872][ds_d561P:=lq_anf$##7205759403794008665##d565P][lq_tmp$x##5877:=ds_d563g][lq_tmp$x##5878:=lq_anf$##7205759403794008665##d565P][twn##a55XA:=ds_d563g][wl##a55XB:=lq_tmp$x##5879]}) | $k_##3912[VV##3911:=lq_tmp$x##5872][ds_d561P:=lq_anf$##7205759403794008665##d565P][lq_tmp$x##5877:=ds_d563g][lq_tmp$x##5878:=lq_anf$##7205759403794008665##d565P][twn##a55XA:=ds_d563g][wl##a55XB:=lq_tmp$x##5879]}</span><span class='hs-sel'>_mkWeatherThere</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5881 : Data.Text.Internal.Text | lq_tmp$x##5881 == ds_d563g}</span><span class='hs-varid'>pl</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>""</span></a>
<span class=hs-linenum>87: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WaterLevels</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##6421 : [{lq_tmp$x##6418 : GHC.Types.Char | $k_##6412[VV##6411:=lq_tmp$x##6418][VV##6416:=lq_tmp$x##6421][lq_tmp$x##8:=lq_anf$##7205759403794008646##d565w][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##6419 VV -&gt; {lq_tmp$x##6420 : GHC.Types.Char | $k_##6415[VV##6414:=lq_tmp$x##6420][VV##6416:=lq_tmp$x##6421][lq_tmp$x##6413:=lq_tmp$x##6419][lq_tmp$x##8:=lq_anf$##7205759403794008646##d565w][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | $k_##6417[VV##6416:=lq_tmp$x##6421][lq_tmp$x##8:=lq_anf$##7205759403794008646##d565w][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]})</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Types.IO ((GHC.Maybe.Maybe Data.ByteString.Internal.ByteString), (GHC.Maybe.Maybe InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage)))</span><span class='hs-varid'>getWaterLakeLevelForPlace_LiveToday_wrtStorage</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6366 : Data.Text.Internal.Text | lq_tmp$x##6366 == ds_d563g}</span><span class='hs-varid'>pl</span></a> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##6447:{lq_tmp$x##6439 : ({lq_tmp$x##6433 : (GHC.Maybe.Maybe {lq_tmp$x##6432 : Data.ByteString.Internal.ByteString | $k_##3415[VV##3414:=lq_tmp$x##6432][VV##3416:=lq_tmp$x##6433][VV##3427:=lq_tmp$x##6439]}) | $k_##3417[VV##3416:=lq_tmp$x##6433][VV##3427:=lq_tmp$x##6439]}, {lq_tmp$x##6435 : (GHC.Maybe.Maybe {lq_tmp$x##6434 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3419[VV##3418:=lq_tmp$x##6434][VV##3420:=lq_tmp$x##6435][VV##3427:=lq_tmp$x##6439]}) | $k_##3421[VV##3420:=lq_tmp$x##6435][VV##3427:=lq_tmp$x##6439]})&lt;\lq_tmp$x##6448 VV -&gt; {lq_tmp$x##6438 : (GHC.Maybe.Maybe {lq_tmp$x##6437 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3424[VV##3423:=lq_tmp$x##6437][VV##3425:=lq_tmp$x##6438][VV##3427:=lq_tmp$x##6439][lq_tmp$x##3422:=lq_tmp$x##6448][lq_tmp$x##6436:=lq_tmp$x##6448][lq_tmp$x##6446:=lq_tmp$x##6448]}) | $k_##3426[VV##3425:=lq_tmp$x##6438][VV##3427:=lq_tmp$x##6439][lq_tmp$x##3422:=lq_tmp$x##6448][lq_tmp$x##6436:=lq_tmp$x##6448][lq_tmp$x##6446:=lq_tmp$x##6448]}&gt; | $k_##3428[VV##3427:=lq_tmp$x##6439]} -&gt; {lq_tmp$x##6444 : (GHC.Types.IO {lq_tmp$x##6443 : [{lq_tmp$x##6440 : GHC.Types.Char | $k_##3431[VV##3430:=lq_tmp$x##6440][VV##3435:=lq_tmp$x##6443][VV##3437:=lq_tmp$x##6444][ds_d5624:=lq_tmp$x##6447]}]&lt;\lq_tmp$x##6449 VV -&gt; {lq_tmp$x##6442 : GHC.Types.Char | $k_##3434[VV##3433:=lq_tmp$x##6442][VV##3435:=lq_tmp$x##6443][VV##3437:=lq_tmp$x##6444][ds_d5624:=lq_tmp$x##6447][lq_tmp$x##3432:=lq_tmp$x##6449][lq_tmp$x##6441:=lq_tmp$x##6449]}&gt; | $k_##3436[VV##3435:=lq_tmp$x##6443][VV##3437:=lq_tmp$x##6444][ds_d5624:=lq_tmp$x##6447]}) | $k_##3438[VV##3437:=lq_tmp$x##6444][ds_d5624:=lq_tmp$x##6447]}</span><span class='hs-sel'>_helperLivePercent</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##6500:{lq_tmp$x##6491 : [{lq_tmp$x##6488 : GHC.Types.Char | $k_##3902[VV##3901:=lq_tmp$x##6488][VV##3906:=lq_tmp$x##6491][ds_d561P:=lq_anf$##7205759403794008649##d565z][lq_tmp$x##6498:=ds_d563g][lq_tmp$x##6499:=lq_anf$##7205759403794008649##d565z][twn##a55XA:=ds_d563g]}]&lt;\lq_tmp$x##6501 VV -&gt; {lq_tmp$x##6490 : GHC.Types.Char | $k_##3905[VV##3904:=lq_tmp$x##6490][VV##3906:=lq_tmp$x##6491][ds_d561P:=lq_anf$##7205759403794008649##d565z][lq_tmp$x##3903:=lq_tmp$x##6501][lq_tmp$x##6489:=lq_tmp$x##6501][lq_tmp$x##6497:=lq_tmp$x##6501][lq_tmp$x##6498:=ds_d563g][lq_tmp$x##6499:=lq_anf$##7205759403794008649##d565z][twn##a55XA:=ds_d563g]}&gt; | $k_##3907[VV##3906:=lq_tmp$x##6491][ds_d561P:=lq_anf$##7205759403794008649##d565z][lq_tmp$x##6498:=ds_d563g][lq_tmp$x##6499:=lq_anf$##7205759403794008649##d565z][twn##a55XA:=ds_d563g]} -&gt; {lq_tmp$x##6493 : (GHC.Types.IO {lq_tmp$x##6492 : Data.Text.Internal.Text | $k_##3910[VV##3909:=lq_tmp$x##6492][VV##3911:=lq_tmp$x##6493][ds_d561P:=lq_anf$##7205759403794008649##d565z][lq_tmp$x##6498:=ds_d563g][lq_tmp$x##6499:=lq_anf$##7205759403794008649##d565z][twn##a55XA:=ds_d563g][wl##a55XB:=lq_tmp$x##6500]}) | $k_##3912[VV##3911:=lq_tmp$x##6493][ds_d561P:=lq_anf$##7205759403794008649##d565z][lq_tmp$x##6498:=ds_d563g][lq_tmp$x##6499:=lq_anf$##7205759403794008649##d565z][twn##a55XA:=ds_d563g][wl##a55XB:=lq_tmp$x##6500]}</span><span class='hs-sel'>_mkWeatherThere</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6502 : Data.Text.Internal.Text | lq_tmp$x##6502 == ds_d563g}</span><span class='hs-varid'>pl</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>""</span></a>
<span class=hs-linenum>88: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WeatherWaterLevels</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Detailed</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NearForecast</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##6884:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromTown</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6885 : Data.Text.Internal.Text | lq_tmp$x##6885 == ds_d563g}</span><span class='hs-varid'>pl</span></a>
<span class=hs-linenum>89: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WeatherWaterLevels</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mini</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RightNow</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##6578:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromTown</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6579 : Data.Text.Internal.Text | lq_tmp$x##6579 == ds_d563g}</span><span class='hs-varid'>pl</span></a>
<span class=hs-linenum>90: </span>
<span class=hs-linenum>91: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##12:{lq_tmp$x##7028 : Data.Text.Internal.Text | $k_##7027[VV##7026:=lq_tmp$x##7028]} -&gt; (GHC.Types.IO {lq_tmp$x##7028 : Data.Text.Internal.Text | $k_##7027[VV##7026:=lq_tmp$x##7028]})</span><span class='hs-varid'>return</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Data.ByteString.Char8.pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Are your preferences set right? Use /prefs &lt;Weather or WaterLevels or WeatherWaterLevels or Monsoon or All&gt; &lt;Mini or Standard or Detailed&gt; &lt;RightNow or Alerts or NearForecast or LongRange&gt; For ex: /prefs weather mini rightnow "</span></a> 
<span class=hs-linenum>92: </span><span class='hs-comment'>-- getAgInfo UserAsk {placeName = pl, prefs = Preferences {userdata = Weather, usersize = Mini, usertimespan = Alerts}} = weatherCurrentAlerts $ Data.ByteString.Char8.unpack pl </span>
</pre>
</body>
</html>