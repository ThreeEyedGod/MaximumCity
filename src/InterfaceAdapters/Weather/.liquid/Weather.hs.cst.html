<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/InterfaceAdapters/Weather/Weather.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>{VV##3724 : GHC.Types.Module | $k_##3725}</span><span class='hs-comment'>{-# LANGUAGE DuplicateRecordFields #-}</span></a>
<span class=hs-linenum> 2: </span><span class='hs-comment'>{-# LANGUAGE OverloadedStrings #-}</span>
<span class=hs-linenum> 3: </span><span class='hs-comment'>{-# OPTIONS_GHC -Wno-orphans #-}</span>
<span class=hs-linenum> 4: </span>
<span class=hs-linenum> 5: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>InterfaceAdapters.Weather.Weather</span>
<span class=hs-linenum> 6: </span><span class='hs-layout'>(</span>
<span class=hs-linenum> 7: </span>    <span class='hs-sel'>_getTownNameWeatherFromIp</span>
<span class=hs-linenum> 8: </span>  <span class='hs-layout'>,</span> <span class='hs-sel'>_getTownNameWeatherFromTown</span>
<span class=hs-linenum> 9: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>getWeather</span>
<span class=hs-linenum>10: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>PreprocessedHeaders</span>
<span class=hs-linenum>11: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>getAgInfo</span>
<span class=hs-linenum>12: </span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>13: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Monad.IO.Class</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>14: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.ByteString.Lazy.Char8</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>LB</span>
<span class=hs-linenum>15: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Data.ByteString.Char8</span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<span class=hs-linenum>17: </span><span class='hs-comment'>--import GHC.Integer.Logarithms ()</span>
<span class=hs-linenum>18: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text.Encoding</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TSE</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>19: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text.Lazy.Encoding</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TLE</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>20: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.ByteString.UTF8</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>BSU</span> <span class='hs-layout'>(</span> <span class='hs-varid'>toString</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>21: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>22: </span>
<span class=hs-linenum>23: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Weather.OpenWeatherAPI</span>
<span class=hs-linenum>24: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>getWeatherForTown</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>25: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Weather.PirateWeatherAPI</span>
<span class=hs-linenum>26: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>weatherCurrentForecastMini</span><span class='hs-layout'>,</span>
<span class=hs-linenum>27: </span>      <span class='hs-sel'>_getWeatherForTown</span><span class='hs-layout'>,</span>
<span class=hs-linenum>28: </span>      <span class='hs-varid'>weatherCurrentForecast</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>29: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.IP.IP2Location</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>30: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Water.MH.Core.WaterLevelLakes</span>
<span class=hs-linenum>31: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>getWaterLakeLevelForPlace_LiveToday_wrtStorage</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>32: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Water.MH.Core.WaterLevelHeaders</span>
<span class=hs-linenum>33: </span>    <span class='hs-layout'>(</span> <span class='hs-conid'>PercentLiveStorage</span><span class='hs-layout'>(</span><span class='hs-varid'>percent_Today</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Region</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>34: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Utils.HttpHeadersPathDefinitions</span>
<span class=hs-linenum>35: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>extractXForwardedForHeader</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>36: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Preferences</span>
<span class=hs-linenum>37: </span>    <span class='hs-layout'>(</span> <span class='hs-conid'>Timespan</span><span class='hs-layout'>(</span><span class='hs-conid'>RightNow</span><span class='hs-layout'>,</span> <span class='hs-conid'>NearForecast</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum>38: </span>      <span class='hs-conid'>Datasize</span><span class='hs-layout'>(</span><span class='hs-conid'>Mini</span><span class='hs-layout'>,</span> <span class='hs-conid'>Detailed</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum>39: </span>      <span class='hs-conid'>Agdata</span><span class='hs-layout'>(</span><span class='hs-conid'>WaterLevels</span><span class='hs-layout'>,</span> <span class='hs-conid'>WeatherWaterLevels</span><span class='hs-layout'>,</span> <span class='hs-conid'>Weather</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum>40: </span>      <span class='hs-conid'>Preferences</span><span class='hs-layout'>(</span><span class='hs-conid'>Preferences</span><span class='hs-layout'>,</span> <span class='hs-varid'>userdata</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span><span class='hs-layout'>)</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>41: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>UseCases.WWI</span> <span class='hs-layout'>(</span><span class='hs-conid'>UserAsk</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>PlaceName</span><span class='hs-layout'>,</span> <span class='hs-conid'>TheWeatherThere</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>42: </span>
<span class=hs-linenum>43: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>PreprocessedHeaders</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>LB.ByteString</span>
<span class=hs-linenum>44: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>WaterLevel</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>String</span>
<span class=hs-linenum>45: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>WeatherText</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>46: </span>
<span class=hs-linenum>47: </span><span class='hs-sel'>_getTownNameWeatherFromIp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>48: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##4898:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromIp</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>town</span></a>
<span class=hs-linenum>49: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4925 : Data.Text.Internal.Text | len lq_anf$##7205759403794008121##d55X3 == stringlen lq_tmp$x##4925
                                            &amp;&amp; lq_anf$##7205759403794008121##d55X3 ~~ lq_tmp$x##4925}</span><span class='hs-str'>"Fail"</span></a> <span class='hs-varop'>`T.isPrefixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4942 : Data.Text.Internal.Text | lq_tmp$x##4942 == town##a55PR}</span><span class='hs-varid'>town</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5007 : (GHC.Base.Monad GHC.Types.IO) | lq_tmp$x##5007 == GHC.Base.$fMonadIO}</span><span class='hs-varid'>return</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4987 : Data.Text.Internal.Text | len lq_anf$##7205759403794008126##d55X8 == stringlen lq_tmp$x##4987
                                            &amp;&amp; lq_anf$##7205759403794008126##d55X8 ~~ lq_tmp$x##4987}</span><span class='hs-str'>"Fail:getTownNameWeatherFromIp | town"</span></a>
<span class=hs-linenum>50: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4955:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromTown</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4956 : Data.Text.Internal.Text | lq_tmp$x##4956 == town##a55PR}</span><span class='hs-varid'>town</span></a>
<span class=hs-linenum>51: </span>
<span class=hs-linenum>52: </span><span class='hs-comment'>-- | water levels of lakes in a region as percent of same time last year or full capacity</span>
<span class=hs-linenum>53: </span><span class='hs-comment'>-- | from Water modules </span>
<span class=hs-linenum>54: </span><span class='hs-sel'>_helperLivePercent</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>Region</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>PercentLiveStorage</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>String</span>
<span class=hs-linenum>55: </span><a class=annot href="#"><span class=annottext>ds_d55Uo:{VV##3765 : ({VV##3754 : (GHC.Maybe.Maybe {VV##3752 : Data.ByteString.Internal.ByteString | $k_##3753}) | $k_##3755}, {VV##3758 : (GHC.Maybe.Maybe {VV##3756 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3757}) | $k_##3759})&lt;\lq_tmp$x##3760 VV -&gt; {VV##3763 : (GHC.Maybe.Maybe {VV##3761 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3762}) | $k_##3764}&gt; | $k_##3766} -&gt; {VV##3775 : (GHC.Types.IO {VV##3773 : [{VV##3768 : GHC.Types.Char | $k_##3769}]&lt;\lq_tmp$x##3770 VV -&gt; {VV##3771 : GHC.Types.Char | $k_##3772}&gt; | $k_##3774}) | $k_##3776}</span><span class='hs-sel'>_helperLivePercent</span></a> <span class='hs-layout'>(</span> <span class='hs-conid'>Nothing</span> <span class='hs-layout'>,</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3855 : (GHC.Base.Applicative GHC.Types.IO) | lq_tmp$x##3855 == GHC.Base.$fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3838 : [GHC.Types.Char] | len lq_tmp$x##3838 == strLen lq_anf$##7205759403794008092##d55WA
                                     &amp;&amp; lq_tmp$x##3838 ~~ lq_anf$##7205759403794008092##d55WA}</span><span class='hs-str'>" No Region detectable for determining lake levels "</span></a>
<span class=hs-linenum>56: </span><span class='hs-sel'>_helperLivePercent</span> <span class='hs-layout'>(</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>,</span> <span class='hs-conid'>Nothing</span> <span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3920 : (GHC.Base.Applicative GHC.Types.IO) | lq_tmp$x##3920 == GHC.Base.$fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3903 : [GHC.Types.Char] | len lq_tmp$x##3903 == strLen lq_anf$##7205759403794008089##d55Wx
                                     &amp;&amp; lq_tmp$x##3903 ~~ lq_anf$##7205759403794008089##d55Wx}</span><span class='hs-str'>" No Water Data can be found for place provided "</span></a>
<span class=hs-linenum>57: </span><span class='hs-sel'>_helperLivePercent</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##16:{lq_tmp$x##4226 : [{lq_tmp$x##4223 : GHC.Types.Char | $k_##4217[VV##4216:=lq_tmp$x##4223][VV##4221:=lq_tmp$x##4226]}]&lt;\lq_tmp$x##4224 VV -&gt; {lq_tmp$x##4225 : GHC.Types.Char | $k_##4220[VV##4219:=lq_tmp$x##4225][VV##4221:=lq_tmp$x##4226][lq_tmp$x##4218:=lq_tmp$x##4224]}&gt; | $k_##4222[VV##4221:=lq_tmp$x##4226]} -&gt; (GHC.Types.IO {lq_tmp$x##4226 : [{lq_tmp$x##4223 : GHC.Types.Char | $k_##4217[VV##4216:=lq_tmp$x##4223][VV##4221:=lq_tmp$x##4226]}]&lt;\lq_tmp$x##4224 VV -&gt; {lq_tmp$x##4225 : GHC.Types.Char | $k_##4220[VV##4219:=lq_tmp$x##4225][VV##4221:=lq_tmp$x##4226][lq_tmp$x##4218:=lq_tmp$x##4224]}&gt; | $k_##4222[VV##4221:=lq_tmp$x##4226]})</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4055 : [GHC.Types.Char] | len lq_tmp$x##4055 == strLen lq_anf$##7205759403794008079##d55Wn
                                     &amp;&amp; lq_tmp$x##4055 ~~ lq_anf$##7205759403794008079##d55Wn}</span><span class='hs-str'>" % livelake level at "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>BSU.toString</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4069 : Data.ByteString.Internal.ByteString | lq_tmp$x##4069 == a##a55PS
                                                        &amp;&amp; $k_##3753[VV##3752:=lq_tmp$x##4069][VV##3754:=lq_anf$##7205759403794008075##d55Wj][VV##3765:=lq_anf$##7205759403794008072##d55Wg][liquid_internal_this:=lq_anf$##7205759403794008072##d55Wg][lq_tmp$x##3777:=lq_tmp$x##4069][lq_tmp$x##3778:=lq_anf$##7205759403794008075##d55Wj][lq_tmp$x##3784:=lq_anf$##7205759403794008072##d55Wg][lq_tmp$x##3787:=lq_tmp$x##4069][lq_tmp$x##3788:=lq_anf$##7205759403794008075##d55Wj][lq_tmp$x##3794:=lq_anf$##7205759403794008072##d55Wg][lq_tmp$x##3951:=lq_tmp$x##4069][lq_tmp$x##3952:=lq_anf$##7205759403794008075##d55Wj][lq_tmp$x##3986:=lq_tmp$x##4069][lq_tmp$x##3987:=lq_anf$##7205759403794008075##d55Wj]}</span><span class='hs-varid'>a</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4077 : [GHC.Types.Char] | len lq_tmp$x##4077 == strLen lq_anf$##7205759403794008082##d55Wq
                                     &amp;&amp; lq_tmp$x##4077 ~~ lq_anf$##7205759403794008082##d55Wq}</span><span class='hs-str'>" is "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>BSU.toString</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-layout'>(</span></a><span class='hs-varid'>percent_Today</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4087 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | lq_tmp$x##4087 == b##a55PT
                                                                                         &amp;&amp; $k_##3757[VV##3756:=lq_tmp$x##4087][VV##3758:=lq_anf$##7205759403794008077##d55Wl][VV##3765:=lq_anf$##7205759403794008072##d55Wg][liquid_internal_this:=lq_anf$##7205759403794008072##d55Wg][lq_tmp$x##3779:=lq_tmp$x##4087][lq_tmp$x##3780:=lq_anf$##7205759403794008077##d55Wl][lq_tmp$x##3784:=lq_anf$##7205759403794008072##d55Wg][lq_tmp$x##3789:=lq_tmp$x##4087][lq_tmp$x##3790:=lq_anf$##7205759403794008077##d55Wl][lq_tmp$x##3792:=lq_tmp$x##4087][lq_tmp$x##3793:=lq_anf$##7205759403794008077##d55Wl][lq_tmp$x##3794:=lq_anf$##7205759403794008072##d55Wg][lq_tmp$x##3805:=ds_d55UI][lq_tmp$x##4000:=lq_tmp$x##4087][lq_tmp$x##4001:=lq_anf$##7205759403794008077##d55Wl][lq_tmp$x##4035:=lq_tmp$x##4087][lq_tmp$x##4036:=lq_anf$##7205759403794008077##d55Wl]
                                                                                         &amp;&amp; $k_##3762[VV##3761:=lq_tmp$x##4087][VV##3763:=lq_anf$##7205759403794008077##d55Wl][VV##3765:=lq_anf$##7205759403794008072##d55Wg][liquid_internal_this:=lq_anf$##7205759403794008072##d55Wg][lq_tmp$x##3760:=ds_d55UI][lq_tmp$x##3781:=ds_d55UI][lq_tmp$x##3782:=lq_tmp$x##4087][lq_tmp$x##3783:=lq_anf$##7205759403794008077##d55Wl][lq_tmp$x##3784:=lq_anf$##7205759403794008072##d55Wg][lq_tmp$x##3785:=ds_d55UI][lq_tmp$x##3789:=lq_tmp$x##4087][lq_tmp$x##3790:=lq_anf$##7205759403794008077##d55Wl][lq_tmp$x##3791:=ds_d55UI][lq_tmp$x##3792:=lq_tmp$x##4087][lq_tmp$x##3793:=lq_anf$##7205759403794008077##d55Wl][lq_tmp$x##3794:=lq_anf$##7205759403794008072##d55Wg][lq_tmp$x##3795:=ds_d55UI][lq_tmp$x##3805:=ds_d55UI][lq_tmp$x##4000:=lq_tmp$x##4087][lq_tmp$x##4001:=lq_anf$##7205759403794008077##d55Wl][lq_tmp$x##4035:=lq_tmp$x##4087][lq_tmp$x##4036:=lq_anf$##7205759403794008077##d55Wl]}</span><span class='hs-varid'>b</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>58: </span>
<span class=hs-linenum>59: </span><span class='hs-sel'>_mkWeatherThere</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WeatherText</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WaterLevel</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>60: </span><a class=annot href="#"><span class=annottext>twn##a55PU:{VV##4233 : Data.Text.Internal.Text | $k_##4234} -&gt; ds_d55U9:{VV##4236 : Data.Text.Internal.Text | $k_##4237} -&gt; wl##a55PV:{VV##4244 : [{VV##4239 : GHC.Types.Char | $k_##4240}]&lt;\lq_tmp$x##4241 VV -&gt; {VV##4242 : GHC.Types.Char | $k_##4243}&gt; | $k_##4245} -&gt; {VV##4249 : (GHC.Types.IO {VV##4247 : Data.Text.Internal.Text | $k_##4248}) | $k_##4250}</span><span class='hs-sel'>_mkWeatherThere</span></a> <a class=annot href="#"><span class=annottext>{VV##4233 : Data.Text.Internal.Text | $k_##4234}</span><span class='hs-varid'>twn</span></a> <span class='hs-layout'>(</span><span class='hs-str'>""</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span><span class='hs-layout'>)</span>  <a class=annot href="#"><span class=annottext>{VV##4244 : [{VV##4239 : GHC.Types.Char | $k_##4240}]&lt;\lq_tmp$x##4241 VV -&gt; {VV##4242 : GHC.Types.Char | $k_##4243}&gt; | $k_##4245}</span><span class='hs-varid'>wl</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##16:{lq_tmp$x##4594 : Data.Text.Internal.Text | $k_##4593[VV##4592:=lq_tmp$x##4594]} -&gt; (GHC.Types.IO {lq_tmp$x##4594 : Data.Text.Internal.Text | $k_##4593[VV##4592:=lq_tmp$x##4594]})</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Data.ByteString.Char8.pack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4541 : [{lq_tmp$x##4553 : GHC.Types.Char | $k_##4552[VV##4551:=lq_tmp$x##4553][lq_tmp$x##4546:=lq_anf$##7205759403794008109##d55WR][lq_tmp$x##4547:=wl##a55PV]}] | len lq_tmp$x##4541 == len lq_anf$##7205759403794008109##d55WR + len wl##a55PV}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>Data.ByteString.Char8.unpack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4511 : Data.Text.Internal.Text | len lq_anf$##7205759403794008107##d55WP == stringlen lq_tmp$x##4511
                                            &amp;&amp; lq_anf$##7205759403794008107##d55WP ~~ lq_tmp$x##4511}</span><span class='hs-str'>""</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4562 : [{lq_tmp$x##4559 : GHC.Types.Char | $k_##4240[VV##4239:=lq_tmp$x##4559][VV##4244:=lq_tmp$x##4562]}]&lt;\lq_tmp$x##4563 VV -&gt; {lq_tmp$x##4561 : GHC.Types.Char | $k_##4243[VV##4242:=lq_tmp$x##4561][VV##4244:=lq_tmp$x##4562][lq_tmp$x##4241:=lq_tmp$x##4563][lq_tmp$x##4560:=lq_tmp$x##4563]}&gt; | lq_tmp$x##4562 == wl##a55PV
                                                                                                                                                                                                                                                                                                                 &amp;&amp; len lq_tmp$x##4562 &gt;= 0
                                                                                                                                                                                                                                                                                                                 &amp;&amp; $k_##4245[VV##4244:=lq_tmp$x##4562]}</span><span class='hs-varid'>wl</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>61: </span><span class='hs-sel'>_mkWeatherThere</span> <span class='hs-varid'>twn</span> <span class='hs-varid'>wt</span> <span class='hs-varid'>wl</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##16:{lq_tmp$x##4478 : Data.Text.Internal.Text | $k_##4477[VV##4476:=lq_tmp$x##4478]} -&gt; (GHC.Types.IO {lq_tmp$x##4478 : Data.Text.Internal.Text | $k_##4477[VV##4476:=lq_tmp$x##4478]})</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Data.ByteString.Char8.pack</span></a>  <a class=annot href="#"><span class=annottext>{lq_tmp$x##4425 : [{lq_tmp$x##4437 : GHC.Types.Char | $k_##4436[VV##4435:=lq_tmp$x##4437][lq_tmp$x##4430:=lq_anf$##7205759403794008099##d55WH][lq_tmp$x##4431:=lq_anf$##7205759403794008104##d55WM]}] | len lq_tmp$x##4425 == len lq_anf$##7205759403794008099##d55WH + len lq_anf$##7205759403794008104##d55WM}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>Data.ByteString.Char8.unpack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4320 : Data.Text.Internal.Text | lq_tmp$x##4320 == twn##a55PU
                                            &amp;&amp; $k_##4234[VV##4233:=lq_tmp$x##4320]}</span><span class='hs-varid'>twn</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4328 : [GHC.Types.Char] | len lq_tmp$x##4328 == strLen lq_anf$##7205759403794008100##d55WI
                                     &amp;&amp; lq_tmp$x##4328 ~~ lq_anf$##7205759403794008100##d55WI}</span><span class='hs-str'>" is "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>Data.ByteString.Char8.unpack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4342 : Data.Text.Internal.Text | lq_tmp$x##4342 == ds_d55U9
                                            &amp;&amp; $k_##4237[VV##4236:=lq_tmp$x##4342]}</span><span class='hs-varid'>wt</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4376 : [{lq_tmp$x##4373 : GHC.Types.Char | $k_##4240[VV##4239:=lq_tmp$x##4373][VV##4244:=lq_tmp$x##4376]}]&lt;\lq_tmp$x##4377 VV -&gt; {lq_tmp$x##4375 : GHC.Types.Char | $k_##4243[VV##4242:=lq_tmp$x##4375][VV##4244:=lq_tmp$x##4376][lq_tmp$x##4241:=lq_tmp$x##4377][lq_tmp$x##4374:=lq_tmp$x##4377]}&gt; | lq_tmp$x##4376 == wl##a55PV
                                                                                                                                                                                                                                                                                                                 &amp;&amp; len lq_tmp$x##4376 &gt;= 0
                                                                                                                                                                                                                                                                                                                 &amp;&amp; $k_##4245[VV##4244:=lq_tmp$x##4376]}</span><span class='hs-varid'>wl</span></a> <span class='hs-layout'>)</span>
<span class=hs-linenum>62: </span>
<span class=hs-linenum>63: </span><span class='hs-sel'>_handlePirateResponse</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>WeatherText</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WaterLevel</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>64: </span><a class=annot href="#"><span class=annottext>weather1##a55PZ:{VV##4597 : Data.Text.Internal.Text | $k_##4598} -&gt; town##a55Q0:{VV##4600 : Data.Text.Internal.Text | $k_##4601} -&gt; wll##a55Q1:{VV##4608 : [{VV##4603 : GHC.Types.Char | $k_##4604}]&lt;\lq_tmp$x##4605 VV -&gt; {VV##4606 : GHC.Types.Char | $k_##4607}&gt; | $k_##4609} -&gt; {VV##4613 : (GHC.Types.IO {VV##4611 : Data.Text.Internal.Text | $k_##4612}) | $k_##4614}</span><span class='hs-sel'>_handlePirateResponse</span></a> <a class=annot href="#"><span class=annottext>{VV##4597 : Data.Text.Internal.Text | $k_##4598}</span><span class='hs-varid'>weather1</span></a> <a class=annot href="#"><span class=annottext>{VV##4600 : Data.Text.Internal.Text | $k_##4601}</span><span class='hs-varid'>town</span></a> <a class=annot href="#"><span class=annottext>{VV##4608 : [{VV##4603 : GHC.Types.Char | $k_##4604}]&lt;\lq_tmp$x##4605 VV -&gt; {VV##4606 : GHC.Types.Char | $k_##4607}&gt; | $k_##4609}</span><span class='hs-varid'>wll</span></a>
<span class=hs-linenum>65: </span>   <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4640 : Data.Text.Internal.Text | len lq_anf$##7205759403794008113##d55WV == stringlen lq_tmp$x##4640
                                            &amp;&amp; lq_anf$##7205759403794008113##d55WV ~~ lq_tmp$x##4640}</span><span class='hs-str'>"Fail:"</span></a> <span class='hs-varop'>`T.isPrefixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4657 : Data.Text.Internal.Text | lq_tmp$x##4657 == weather1##a55PZ
                                            &amp;&amp; $k_##4598[VV##4597:=lq_tmp$x##4657]}</span><span class='hs-varid'>weather1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-conid'>InterfaceAdapters.Weather.OpenWeatherAPI.getWeatherForTown</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Data.ByteString.Char8.unpack</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4702 : Data.Text.Internal.Text | lq_tmp$x##4702 == town##a55Q0
                                            &amp;&amp; $k_##4601[VV##4600:=lq_tmp$x##4702]}</span><span class='hs-varid'>town</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4727 : (GHC.Types.IO {lq_tmp$x##4726 : Data.Text.Internal.Text | $k_##4248[VV##4247:=lq_tmp$x##4726][VV##4249:=lq_tmp$x##4727][ds_d55U9:=weather2##a55Q2][lq_tmp$x##4732:=town##a55Q0][lq_tmp$x##4733:=weather2##a55Q2][lq_tmp$x##4734:=wll##a55Q1][twn##a55PU:=town##a55Q0][wl##a55PV:=wll##a55Q1]}) | $k_##4250[VV##4249:=lq_tmp$x##4727][ds_d55U9:=weather2##a55Q2][lq_tmp$x##4732:=town##a55Q0][lq_tmp$x##4733:=weather2##a55Q2][lq_tmp$x##4734:=wll##a55Q1][twn##a55PU:=town##a55Q0][wl##a55PV:=wll##a55Q1]}</span><span class='hs-layout'>(</span></a><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>weather2</span></a> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-sel'>_mkWeatherThere</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4736 : Data.Text.Internal.Text | lq_tmp$x##4736 == town##a55Q0
                                            &amp;&amp; $k_##4601[VV##4600:=lq_tmp$x##4736]}</span><span class='hs-varid'>town</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4737 : Data.Text.Internal.Text | lq_tmp$x##4737 == weather2##a55Q2}</span><span class='hs-varid'>weather2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4741 : [{lq_tmp$x##4738 : GHC.Types.Char | $k_##4604[VV##4603:=lq_tmp$x##4738][VV##4608:=lq_tmp$x##4741]}]&lt;\lq_tmp$x##4742 VV -&gt; {lq_tmp$x##4740 : GHC.Types.Char | $k_##4607[VV##4606:=lq_tmp$x##4740][VV##4608:=lq_tmp$x##4741][lq_tmp$x##4605:=lq_tmp$x##4742][lq_tmp$x##4739:=lq_tmp$x##4742]}&gt; | lq_tmp$x##4741 == wll##a55Q1
                                                                                                                                                                                                                                                                                                                 &amp;&amp; len lq_tmp$x##4741 &gt;= 0
                                                                                                                                                                                                                                                                                                                 &amp;&amp; $k_##4609[VV##4608:=lq_tmp$x##4741]}</span><span class='hs-varid'>wll</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>66: </span>   <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>lq_tmp$x##4678:{lq_tmp$x##4666 : Data.Text.Internal.Text | $k_##4234[VV##4233:=lq_tmp$x##4666]} -&gt; lq_tmp$x##4679:{lq_tmp$x##4667 : Data.Text.Internal.Text | $k_##4237[VV##4236:=lq_tmp$x##4667][twn##a55PU:=lq_tmp$x##4678]} -&gt; lq_tmp$x##4680:{lq_tmp$x##4671 : [{lq_tmp$x##4668 : GHC.Types.Char | $k_##4240[VV##4239:=lq_tmp$x##4668][VV##4244:=lq_tmp$x##4671][ds_d55U9:=lq_tmp$x##4679][twn##a55PU:=lq_tmp$x##4678]}]&lt;\lq_tmp$x##4681 VV -&gt; {lq_tmp$x##4670 : GHC.Types.Char | $k_##4243[VV##4242:=lq_tmp$x##4670][VV##4244:=lq_tmp$x##4671][ds_d55U9:=lq_tmp$x##4679][lq_tmp$x##4241:=lq_tmp$x##4681][lq_tmp$x##4669:=lq_tmp$x##4681][lq_tmp$x##4677:=lq_tmp$x##4681][twn##a55PU:=lq_tmp$x##4678]}&gt; | $k_##4245[VV##4244:=lq_tmp$x##4671][ds_d55U9:=lq_tmp$x##4679][twn##a55PU:=lq_tmp$x##4678]} -&gt; {lq_tmp$x##4673 : (GHC.Types.IO {lq_tmp$x##4672 : Data.Text.Internal.Text | $k_##4248[VV##4247:=lq_tmp$x##4672][VV##4249:=lq_tmp$x##4673][ds_d55U9:=lq_tmp$x##4679][twn##a55PU:=lq_tmp$x##4678][wl##a55PV:=lq_tmp$x##4680]}) | $k_##4250[VV##4249:=lq_tmp$x##4673][ds_d55U9:=lq_tmp$x##4679][twn##a55PU:=lq_tmp$x##4678][wl##a55PV:=lq_tmp$x##4680]}</span><span class='hs-sel'>_mkWeatherThere</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4682 : Data.Text.Internal.Text | lq_tmp$x##4682 == town##a55Q0
                                            &amp;&amp; $k_##4601[VV##4600:=lq_tmp$x##4682]}</span><span class='hs-varid'>town</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4683 : Data.Text.Internal.Text | lq_tmp$x##4683 == weather1##a55PZ
                                            &amp;&amp; $k_##4598[VV##4597:=lq_tmp$x##4683]}</span><span class='hs-varid'>weather1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4687 : [{lq_tmp$x##4684 : GHC.Types.Char | $k_##4604[VV##4603:=lq_tmp$x##4684][VV##4608:=lq_tmp$x##4687]}]&lt;\lq_tmp$x##4688 VV -&gt; {lq_tmp$x##4686 : GHC.Types.Char | $k_##4607[VV##4606:=lq_tmp$x##4686][VV##4608:=lq_tmp$x##4687][lq_tmp$x##4605:=lq_tmp$x##4688][lq_tmp$x##4685:=lq_tmp$x##4688]}&gt; | lq_tmp$x##4687 == wll##a55Q1
                                                                                                                                                                                                                                                                                                                 &amp;&amp; len lq_tmp$x##4687 &gt;= 0
                                                                                                                                                                                                                                                                                                                 &amp;&amp; $k_##4609[VV##4608:=lq_tmp$x##4687]}</span><span class='hs-varid'>wll</span></a>
<span class=hs-linenum>67: </span>
<span class=hs-linenum>68: </span><span class='hs-sel'>_getTownNameWeatherFromTown</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>69: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##4744:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromTown</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>town</span></a> <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##4814 : [{lq_tmp$x##4811 : GHC.Types.Char | $k_##4805[VV##4804:=lq_tmp$x##4811][VV##4809:=lq_tmp$x##4814][lq_tmp$x##8:=lq_anf$##7205759403794008118##d55X0][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##4812 VV -&gt; {lq_tmp$x##4813 : GHC.Types.Char | $k_##4808[VV##4807:=lq_tmp$x##4813][VV##4809:=lq_tmp$x##4814][lq_tmp$x##4806:=lq_tmp$x##4812][lq_tmp$x##8:=lq_anf$##7205759403794008118##d55X0][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | $k_##4810[VV##4809:=lq_tmp$x##4814][lq_tmp$x##8:=lq_anf$##7205759403794008118##d55X0][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]})</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Types.IO ((GHC.Maybe.Maybe Data.ByteString.Internal.ByteString), (GHC.Maybe.Maybe InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage)))</span><span class='hs-varid'>getWaterLakeLevelForPlace_LiveToday_wrtStorage</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4759 : Data.Text.Internal.Text | lq_tmp$x##4759 == town##a55Q3}</span><span class='hs-varid'>town</span></a> <span class='hs-varop'>&gt;&gt;=</span>  <a class=annot href="#"><span class=annottext>lq_tmp$x##4840:{lq_tmp$x##4832 : ({lq_tmp$x##4826 : (GHC.Maybe.Maybe {lq_tmp$x##4825 : Data.ByteString.Internal.ByteString | $k_##3753[VV##3752:=lq_tmp$x##4825][VV##3754:=lq_tmp$x##4826][VV##3765:=lq_tmp$x##4832]}) | $k_##3755[VV##3754:=lq_tmp$x##4826][VV##3765:=lq_tmp$x##4832]}, {lq_tmp$x##4828 : (GHC.Maybe.Maybe {lq_tmp$x##4827 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3757[VV##3756:=lq_tmp$x##4827][VV##3758:=lq_tmp$x##4828][VV##3765:=lq_tmp$x##4832]}) | $k_##3759[VV##3758:=lq_tmp$x##4828][VV##3765:=lq_tmp$x##4832]})&lt;\lq_tmp$x##4841 VV -&gt; {lq_tmp$x##4831 : (GHC.Maybe.Maybe {lq_tmp$x##4830 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3762[VV##3761:=lq_tmp$x##4830][VV##3763:=lq_tmp$x##4831][VV##3765:=lq_tmp$x##4832][lq_tmp$x##3760:=lq_tmp$x##4841][lq_tmp$x##4829:=lq_tmp$x##4841][lq_tmp$x##4839:=lq_tmp$x##4841]}) | $k_##3764[VV##3763:=lq_tmp$x##4831][VV##3765:=lq_tmp$x##4832][lq_tmp$x##3760:=lq_tmp$x##4841][lq_tmp$x##4829:=lq_tmp$x##4841][lq_tmp$x##4839:=lq_tmp$x##4841]}&gt; | $k_##3766[VV##3765:=lq_tmp$x##4832]} -&gt; {lq_tmp$x##4837 : (GHC.Types.IO {lq_tmp$x##4836 : [{lq_tmp$x##4833 : GHC.Types.Char | $k_##3769[VV##3768:=lq_tmp$x##4833][VV##3773:=lq_tmp$x##4836][VV##3775:=lq_tmp$x##4837][ds_d55Uo:=lq_tmp$x##4840]}]&lt;\lq_tmp$x##4842 VV -&gt; {lq_tmp$x##4835 : GHC.Types.Char | $k_##3772[VV##3771:=lq_tmp$x##4835][VV##3773:=lq_tmp$x##4836][VV##3775:=lq_tmp$x##4837][ds_d55Uo:=lq_tmp$x##4840][lq_tmp$x##3770:=lq_tmp$x##4842][lq_tmp$x##4834:=lq_tmp$x##4842]}&gt; | $k_##3774[VV##3773:=lq_tmp$x##4836][VV##3775:=lq_tmp$x##4837][ds_d55Uo:=lq_tmp$x##4840]}) | $k_##3776[VV##3775:=lq_tmp$x##4837][ds_d55Uo:=lq_tmp$x##4840]}</span><span class='hs-sel'>_helperLivePercent</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span>
<span class=hs-linenum>70: </span>  <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4814 : [{lq_tmp$x##4811 : GHC.Types.Char | $k_##4805[VV##4804:=lq_tmp$x##4811][VV##4809:=lq_tmp$x##4814][lq_tmp$x##8:=lq_anf$##7205759403794008118##d55X0][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##4812 VV -&gt; {lq_tmp$x##4813 : GHC.Types.Char | $k_##4808[VV##4807:=lq_tmp$x##4813][VV##4809:=lq_tmp$x##4814][lq_tmp$x##4806:=lq_tmp$x##4812][lq_tmp$x##8:=lq_anf$##7205759403794008118##d55X0][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | $k_##4810[VV##4809:=lq_tmp$x##4814][lq_tmp$x##8:=lq_anf$##7205759403794008118##d55X0][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}</span><span class='hs-varid'>wl</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-conid'>InterfaceAdapters.Weather.PirateWeatherAPI._getWeatherForTown</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Data.ByteString.Char8.unpack</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4856 : Data.Text.Internal.Text | lq_tmp$x##4856 == town##a55Q3}</span><span class='hs-varid'>town</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span>
<span class=hs-linenum>71: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##4881 : (GHC.Types.IO {lq_tmp$x##4880 : Data.Text.Internal.Text | $k_##4612[VV##4611:=lq_tmp$x##4880][VV##4613:=lq_tmp$x##4881][lq_tmp$x##4886:=w##a55Q5][lq_tmp$x##4887:=town##a55Q3][lq_tmp$x##4888:=wl##a55Q4][town##a55Q0:=town##a55Q3][weather1##a55PZ:=w##a55Q5][wll##a55Q1:=wl##a55Q4]}) | $k_##4614[VV##4613:=lq_tmp$x##4881][lq_tmp$x##4886:=w##a55Q5][lq_tmp$x##4887:=town##a55Q3][lq_tmp$x##4888:=wl##a55Q4][town##a55Q0:=town##a55Q3][weather1##a55PZ:=w##a55Q5][wll##a55Q1:=wl##a55Q4]}</span><span class='hs-layout'>(</span></a><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>w</span></a> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-sel'>_handlePirateResponse</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4890 : Data.Text.Internal.Text | lq_tmp$x##4890 == w##a55Q5}</span><span class='hs-varid'>w</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4891 : Data.Text.Internal.Text | lq_tmp$x##4891 == town##a55Q3}</span><span class='hs-varid'>town</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4895 : [{lq_tmp$x##4892 : GHC.Types.Char | $k_##4805[VV##4804:=lq_tmp$x##4892][VV##4809:=lq_tmp$x##4895][lq_tmp$x##4811:=lq_tmp$x##4892][lq_tmp$x##4814:=lq_tmp$x##4895][lq_tmp$x##8:=lq_anf$##7205759403794008118##d55X0][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##4896 VV -&gt; {lq_tmp$x##4894 : GHC.Types.Char | $k_##4808[VV##4807:=lq_tmp$x##4894][VV##4809:=lq_tmp$x##4895][lq_tmp$x##4806:=lq_tmp$x##4896][lq_tmp$x##4812:=lq_tmp$x##4896][lq_tmp$x##4813:=lq_tmp$x##4894][lq_tmp$x##4814:=lq_tmp$x##4895][lq_tmp$x##4893:=lq_tmp$x##4896][lq_tmp$x##8:=lq_anf$##7205759403794008118##d55X0][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | lq_tmp$x##4895 == wl##a55Q4
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &amp;&amp; len lq_tmp$x##4895 &gt;= 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &amp;&amp; $k_##4810[VV##4809:=lq_tmp$x##4895][lq_tmp$x##4814:=lq_tmp$x##4895][lq_tmp$x##8:=lq_anf$##7205759403794008118##d55X0][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}</span><span class='hs-varid'>wl</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>72: </span>
<span class=hs-linenum>73: </span><span class='hs-definition'>getWeather</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>PreprocessedHeaders</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>PlaceName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>74: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##5013:(GHC.Maybe.Maybe Data.ByteString.Lazy.Internal.ByteString) -&gt; lq_tmp$x##5014:(GHC.Maybe.Maybe Data.Text.Internal.Text) -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-definition'>getWeather</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-varid'>extractXForwardedForHeader</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5221 : Data.ByteString.Lazy.Internal.ByteString | lq_tmp$x##5221 == p##a55Q6}</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5255:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromIp</span></a>
<span class=hs-linenum>75: </span><span class='hs-definition'>getWeather</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5431:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromTown</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5432 : Data.Text.Internal.Text | lq_tmp$x##5432 == pl##a55Q7}</span><span class='hs-varid'>pl</span></a>
<span class=hs-linenum>76: </span><span class='hs-definition'>getWeather</span> <span class='hs-conid'>Nothing</span> <span class='hs-conid'>Nothing</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5348 : (GHC.Base.Applicative GHC.Types.IO) | lq_tmp$x##5348 == GHC.Base.$fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5328 : Data.Text.Internal.Text | len lq_anf$##7205759403794008146##d55Xs == stringlen lq_tmp$x##5328
                                            &amp;&amp; lq_anf$##7205759403794008146##d55Xs ~~ lq_tmp$x##5328}</span><span class='hs-layout'>(</span></a><span class='hs-str'>"Hmmm... Something Deeply Wrong"</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TheWeatherThere</span><span class='hs-layout'>)</span>
<span class=hs-linenum>77: </span>
<span class=hs-linenum>78: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-keyglyph'>::</span>  <span class='hs-conid'>UserAsk</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>TheWeatherThere</span>
<span class=hs-linenum>79: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##5435:UseCases.WWI.UserAsk -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-definition'>getAgInfo</span></a> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>"/prefs"</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##12:{lq_tmp$x##7462 : Data.Text.Internal.Text | $k_##7461[VV##7460:=lq_tmp$x##7462]} -&gt; (GHC.Types.IO {lq_tmp$x##7462 : Data.Text.Internal.Text | $k_##7461[VV##7460:=lq_tmp$x##7462]})</span><span class='hs-varid'>return</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Data.ByteString.Char8.pack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7427 : [GHC.Types.Char] | len lq_tmp$x##7427 == strLen lq_anf$##7205759403794008206##d55Yq
                                     &amp;&amp; lq_tmp$x##7427 ~~ lq_anf$##7205759403794008206##d55Yq}</span><span class='hs-str'>"/Preferences related  "</span></a>
<span class=hs-linenum>80: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>"/start"</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##12:{lq_tmp$x##7414 : Data.Text.Internal.Text | $k_##7413[VV##7412:=lq_tmp$x##7414]} -&gt; (GHC.Types.IO {lq_tmp$x##7414 : Data.Text.Internal.Text | $k_##7413[VV##7412:=lq_tmp$x##7414]})</span><span class='hs-varid'>return</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Data.ByteString.Char8.pack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7379 : [GHC.Types.Char] | len lq_tmp$x##7379 == strLen lq_anf$##7205759403794008203##d55Yn
                                     &amp;&amp; lq_tmp$x##7379 ~~ lq_anf$##7205759403794008203##d55Yn}</span><span class='hs-str'>"/Start related  "</span></a>
<span class=hs-linenum>81: </span>
<span class=hs-linenum>82: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pfs</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Weather</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5629:[GHC.Types.Char] -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-varid'>weatherCurrentForecast</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5631 : InterfaceAdapters.Preferences.Preferences | lq_tmp$x##5631 == ds_d55VB}</span><span class='hs-varid'>pfs</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-conid'>Data.ByteString.Char8.unpack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5616 : Data.Text.Internal.Text | lq_tmp$x##5616 == ds_d55VA}</span><span class='hs-varid'>pl</span></a>
<span class=hs-linenum>83: </span><span class='hs-comment'>-- getAgInfo UserAsk {placeName = pl, prefs = Preferences {userdata = Weather, usersize = Mini, usertimespan = RightNow}} = weatherCurrentForecastMini $ Data.ByteString.Char8.unpack pl</span>
<span class=hs-linenum>84: </span><span class='hs-comment'>-- getAgInfo UserAsk {placeName = pl, prefs = Preferences {userdata = Weather, usersize = _, usertimespan = _}} = weatherCurrentForecastMini $ Data.ByteString.Char8.unpack pl</span>
<span class=hs-linenum>85: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WaterLevels</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mini</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RightNow</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##5724 : [{lq_tmp$x##5721 : GHC.Types.Char | $k_##5715[VV##5714:=lq_tmp$x##5721][VV##5719:=lq_tmp$x##5724][lq_tmp$x##8:=lq_anf$##7205759403794008181##d55Y1][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##5722 VV -&gt; {lq_tmp$x##5723 : GHC.Types.Char | $k_##5718[VV##5717:=lq_tmp$x##5723][VV##5719:=lq_tmp$x##5724][lq_tmp$x##5716:=lq_tmp$x##5722][lq_tmp$x##8:=lq_anf$##7205759403794008181##d55Y1][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | $k_##5720[VV##5719:=lq_tmp$x##5724][lq_tmp$x##8:=lq_anf$##7205759403794008181##d55Y1][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]})</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Types.IO ((GHC.Maybe.Maybe Data.ByteString.Internal.ByteString), (GHC.Maybe.Maybe InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage)))</span><span class='hs-varid'>getWaterLakeLevelForPlace_LiveToday_wrtStorage</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5669 : Data.Text.Internal.Text | lq_tmp$x##5669 == ds_d55VA}</span><span class='hs-varid'>pl</span></a> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5750:{lq_tmp$x##5742 : ({lq_tmp$x##5736 : (GHC.Maybe.Maybe {lq_tmp$x##5735 : Data.ByteString.Internal.ByteString | $k_##3753[VV##3752:=lq_tmp$x##5735][VV##3754:=lq_tmp$x##5736][VV##3765:=lq_tmp$x##5742]}) | $k_##3755[VV##3754:=lq_tmp$x##5736][VV##3765:=lq_tmp$x##5742]}, {lq_tmp$x##5738 : (GHC.Maybe.Maybe {lq_tmp$x##5737 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3757[VV##3756:=lq_tmp$x##5737][VV##3758:=lq_tmp$x##5738][VV##3765:=lq_tmp$x##5742]}) | $k_##3759[VV##3758:=lq_tmp$x##5738][VV##3765:=lq_tmp$x##5742]})&lt;\lq_tmp$x##5751 VV -&gt; {lq_tmp$x##5741 : (GHC.Maybe.Maybe {lq_tmp$x##5740 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3762[VV##3761:=lq_tmp$x##5740][VV##3763:=lq_tmp$x##5741][VV##3765:=lq_tmp$x##5742][lq_tmp$x##3760:=lq_tmp$x##5751][lq_tmp$x##5739:=lq_tmp$x##5751][lq_tmp$x##5749:=lq_tmp$x##5751]}) | $k_##3764[VV##3763:=lq_tmp$x##5741][VV##3765:=lq_tmp$x##5742][lq_tmp$x##3760:=lq_tmp$x##5751][lq_tmp$x##5739:=lq_tmp$x##5751][lq_tmp$x##5749:=lq_tmp$x##5751]}&gt; | $k_##3766[VV##3765:=lq_tmp$x##5742]} -&gt; {lq_tmp$x##5747 : (GHC.Types.IO {lq_tmp$x##5746 : [{lq_tmp$x##5743 : GHC.Types.Char | $k_##3769[VV##3768:=lq_tmp$x##5743][VV##3773:=lq_tmp$x##5746][VV##3775:=lq_tmp$x##5747][ds_d55Uo:=lq_tmp$x##5750]}]&lt;\lq_tmp$x##5752 VV -&gt; {lq_tmp$x##5745 : GHC.Types.Char | $k_##3772[VV##3771:=lq_tmp$x##5745][VV##3773:=lq_tmp$x##5746][VV##3775:=lq_tmp$x##5747][ds_d55Uo:=lq_tmp$x##5750][lq_tmp$x##3770:=lq_tmp$x##5752][lq_tmp$x##5744:=lq_tmp$x##5752]}&gt; | $k_##3774[VV##3773:=lq_tmp$x##5746][VV##3775:=lq_tmp$x##5747][ds_d55Uo:=lq_tmp$x##5750]}) | $k_##3776[VV##3775:=lq_tmp$x##5747][ds_d55Uo:=lq_tmp$x##5750]}</span><span class='hs-sel'>_helperLivePercent</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5803:{lq_tmp$x##5794 : [{lq_tmp$x##5791 : GHC.Types.Char | $k_##4240[VV##4239:=lq_tmp$x##5791][VV##4244:=lq_tmp$x##5794][ds_d55U9:=lq_anf$##7205759403794008184##d55Y4][lq_tmp$x##5801:=ds_d55VA][lq_tmp$x##5802:=lq_anf$##7205759403794008184##d55Y4][twn##a55PU:=ds_d55VA]}]&lt;\lq_tmp$x##5804 VV -&gt; {lq_tmp$x##5793 : GHC.Types.Char | $k_##4243[VV##4242:=lq_tmp$x##5793][VV##4244:=lq_tmp$x##5794][ds_d55U9:=lq_anf$##7205759403794008184##d55Y4][lq_tmp$x##4241:=lq_tmp$x##5804][lq_tmp$x##5792:=lq_tmp$x##5804][lq_tmp$x##5800:=lq_tmp$x##5804][lq_tmp$x##5801:=ds_d55VA][lq_tmp$x##5802:=lq_anf$##7205759403794008184##d55Y4][twn##a55PU:=ds_d55VA]}&gt; | $k_##4245[VV##4244:=lq_tmp$x##5794][ds_d55U9:=lq_anf$##7205759403794008184##d55Y4][lq_tmp$x##5801:=ds_d55VA][lq_tmp$x##5802:=lq_anf$##7205759403794008184##d55Y4][twn##a55PU:=ds_d55VA]} -&gt; {lq_tmp$x##5796 : (GHC.Types.IO {lq_tmp$x##5795 : Data.Text.Internal.Text | $k_##4248[VV##4247:=lq_tmp$x##5795][VV##4249:=lq_tmp$x##5796][ds_d55U9:=lq_anf$##7205759403794008184##d55Y4][lq_tmp$x##5801:=ds_d55VA][lq_tmp$x##5802:=lq_anf$##7205759403794008184##d55Y4][twn##a55PU:=ds_d55VA][wl##a55PV:=lq_tmp$x##5803]}) | $k_##4250[VV##4249:=lq_tmp$x##5796][ds_d55U9:=lq_anf$##7205759403794008184##d55Y4][lq_tmp$x##5801:=ds_d55VA][lq_tmp$x##5802:=lq_anf$##7205759403794008184##d55Y4][twn##a55PU:=ds_d55VA][wl##a55PV:=lq_tmp$x##5803]}</span><span class='hs-sel'>_mkWeatherThere</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5805 : Data.Text.Internal.Text | lq_tmp$x##5805 == ds_d55VA}</span><span class='hs-varid'>pl</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5780 : Data.Text.Internal.Text | len lq_anf$##7205759403794008183##d55Y3 == stringlen lq_tmp$x##5780
                                            &amp;&amp; lq_anf$##7205759403794008183##d55Y3 ~~ lq_tmp$x##5780}</span><span class='hs-str'>""</span></a>
<span class=hs-linenum>86: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WaterLevels</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mini</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NearForecast</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##6138 : [{lq_tmp$x##6135 : GHC.Types.Char | $k_##6129[VV##6128:=lq_tmp$x##6135][VV##6133:=lq_tmp$x##6138][lq_tmp$x##8:=lq_anf$##7205759403794008186##d55Y6][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##6136 VV -&gt; {lq_tmp$x##6137 : GHC.Types.Char | $k_##6132[VV##6131:=lq_tmp$x##6137][VV##6133:=lq_tmp$x##6138][lq_tmp$x##6130:=lq_tmp$x##6136][lq_tmp$x##8:=lq_anf$##7205759403794008186##d55Y6][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | $k_##6134[VV##6133:=lq_tmp$x##6138][lq_tmp$x##8:=lq_anf$##7205759403794008186##d55Y6][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]})</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Types.IO ((GHC.Maybe.Maybe Data.ByteString.Internal.ByteString), (GHC.Maybe.Maybe InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage)))</span><span class='hs-varid'>getWaterLakeLevelForPlace_LiveToday_wrtStorage</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6083 : Data.Text.Internal.Text | lq_tmp$x##6083 == ds_d55VA}</span><span class='hs-varid'>pl</span></a> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##6164:{lq_tmp$x##6156 : ({lq_tmp$x##6150 : (GHC.Maybe.Maybe {lq_tmp$x##6149 : Data.ByteString.Internal.ByteString | $k_##3753[VV##3752:=lq_tmp$x##6149][VV##3754:=lq_tmp$x##6150][VV##3765:=lq_tmp$x##6156]}) | $k_##3755[VV##3754:=lq_tmp$x##6150][VV##3765:=lq_tmp$x##6156]}, {lq_tmp$x##6152 : (GHC.Maybe.Maybe {lq_tmp$x##6151 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3757[VV##3756:=lq_tmp$x##6151][VV##3758:=lq_tmp$x##6152][VV##3765:=lq_tmp$x##6156]}) | $k_##3759[VV##3758:=lq_tmp$x##6152][VV##3765:=lq_tmp$x##6156]})&lt;\lq_tmp$x##6165 VV -&gt; {lq_tmp$x##6155 : (GHC.Maybe.Maybe {lq_tmp$x##6154 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3762[VV##3761:=lq_tmp$x##6154][VV##3763:=lq_tmp$x##6155][VV##3765:=lq_tmp$x##6156][lq_tmp$x##3760:=lq_tmp$x##6165][lq_tmp$x##6153:=lq_tmp$x##6165][lq_tmp$x##6163:=lq_tmp$x##6165]}) | $k_##3764[VV##3763:=lq_tmp$x##6155][VV##3765:=lq_tmp$x##6156][lq_tmp$x##3760:=lq_tmp$x##6165][lq_tmp$x##6153:=lq_tmp$x##6165][lq_tmp$x##6163:=lq_tmp$x##6165]}&gt; | $k_##3766[VV##3765:=lq_tmp$x##6156]} -&gt; {lq_tmp$x##6161 : (GHC.Types.IO {lq_tmp$x##6160 : [{lq_tmp$x##6157 : GHC.Types.Char | $k_##3769[VV##3768:=lq_tmp$x##6157][VV##3773:=lq_tmp$x##6160][VV##3775:=lq_tmp$x##6161][ds_d55Uo:=lq_tmp$x##6164]}]&lt;\lq_tmp$x##6166 VV -&gt; {lq_tmp$x##6159 : GHC.Types.Char | $k_##3772[VV##3771:=lq_tmp$x##6159][VV##3773:=lq_tmp$x##6160][VV##3775:=lq_tmp$x##6161][ds_d55Uo:=lq_tmp$x##6164][lq_tmp$x##3770:=lq_tmp$x##6166][lq_tmp$x##6158:=lq_tmp$x##6166]}&gt; | $k_##3774[VV##3773:=lq_tmp$x##6160][VV##3775:=lq_tmp$x##6161][ds_d55Uo:=lq_tmp$x##6164]}) | $k_##3776[VV##3775:=lq_tmp$x##6161][ds_d55Uo:=lq_tmp$x##6164]}</span><span class='hs-sel'>_helperLivePercent</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##6217:{lq_tmp$x##6208 : [{lq_tmp$x##6205 : GHC.Types.Char | $k_##4240[VV##4239:=lq_tmp$x##6205][VV##4244:=lq_tmp$x##6208][ds_d55U9:=lq_anf$##7205759403794008189##d55Y9][lq_tmp$x##6215:=ds_d55VA][lq_tmp$x##6216:=lq_anf$##7205759403794008189##d55Y9][twn##a55PU:=ds_d55VA]}]&lt;\lq_tmp$x##6218 VV -&gt; {lq_tmp$x##6207 : GHC.Types.Char | $k_##4243[VV##4242:=lq_tmp$x##6207][VV##4244:=lq_tmp$x##6208][ds_d55U9:=lq_anf$##7205759403794008189##d55Y9][lq_tmp$x##4241:=lq_tmp$x##6218][lq_tmp$x##6206:=lq_tmp$x##6218][lq_tmp$x##6214:=lq_tmp$x##6218][lq_tmp$x##6215:=ds_d55VA][lq_tmp$x##6216:=lq_anf$##7205759403794008189##d55Y9][twn##a55PU:=ds_d55VA]}&gt; | $k_##4245[VV##4244:=lq_tmp$x##6208][ds_d55U9:=lq_anf$##7205759403794008189##d55Y9][lq_tmp$x##6215:=ds_d55VA][lq_tmp$x##6216:=lq_anf$##7205759403794008189##d55Y9][twn##a55PU:=ds_d55VA]} -&gt; {lq_tmp$x##6210 : (GHC.Types.IO {lq_tmp$x##6209 : Data.Text.Internal.Text | $k_##4248[VV##4247:=lq_tmp$x##6209][VV##4249:=lq_tmp$x##6210][ds_d55U9:=lq_anf$##7205759403794008189##d55Y9][lq_tmp$x##6215:=ds_d55VA][lq_tmp$x##6216:=lq_anf$##7205759403794008189##d55Y9][twn##a55PU:=ds_d55VA][wl##a55PV:=lq_tmp$x##6217]}) | $k_##4250[VV##4249:=lq_tmp$x##6210][ds_d55U9:=lq_anf$##7205759403794008189##d55Y9][lq_tmp$x##6215:=ds_d55VA][lq_tmp$x##6216:=lq_anf$##7205759403794008189##d55Y9][twn##a55PU:=ds_d55VA][wl##a55PV:=lq_tmp$x##6217]}</span><span class='hs-sel'>_mkWeatherThere</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6219 : Data.Text.Internal.Text | lq_tmp$x##6219 == ds_d55VA}</span><span class='hs-varid'>pl</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6194 : Data.Text.Internal.Text | len lq_anf$##7205759403794008188##d55Y8 == stringlen lq_tmp$x##6194
                                            &amp;&amp; lq_anf$##7205759403794008188##d55Y8 ~~ lq_tmp$x##6194}</span><span class='hs-str'>""</span></a>
<span class=hs-linenum>87: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WaterLevels</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>_</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##6759 : [{lq_tmp$x##6756 : GHC.Types.Char | $k_##6750[VV##6749:=lq_tmp$x##6756][VV##6754:=lq_tmp$x##6759][lq_tmp$x##8:=lq_anf$##7205759403794008170##d55XQ][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}]&lt;\lq_tmp$x##6757 VV -&gt; {lq_tmp$x##6758 : GHC.Types.Char | $k_##6753[VV##6752:=lq_tmp$x##6758][VV##6754:=lq_tmp$x##6759][lq_tmp$x##6751:=lq_tmp$x##6757][lq_tmp$x##8:=lq_anf$##7205759403794008170##d55XQ][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]}&gt; | $k_##6755[VV##6754:=lq_tmp$x##6759][lq_tmp$x##8:=lq_anf$##7205759403794008170##d55XQ][lq_tmp$x##9:=InterfaceAdapters.Weather.Weather._helperLivePercent]})</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Types.IO ((GHC.Maybe.Maybe Data.ByteString.Internal.ByteString), (GHC.Maybe.Maybe InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage)))</span><span class='hs-varid'>getWaterLakeLevelForPlace_LiveToday_wrtStorage</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6704 : Data.Text.Internal.Text | lq_tmp$x##6704 == ds_d55VA}</span><span class='hs-varid'>pl</span></a> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##6785:{lq_tmp$x##6777 : ({lq_tmp$x##6771 : (GHC.Maybe.Maybe {lq_tmp$x##6770 : Data.ByteString.Internal.ByteString | $k_##3753[VV##3752:=lq_tmp$x##6770][VV##3754:=lq_tmp$x##6771][VV##3765:=lq_tmp$x##6777]}) | $k_##3755[VV##3754:=lq_tmp$x##6771][VV##3765:=lq_tmp$x##6777]}, {lq_tmp$x##6773 : (GHC.Maybe.Maybe {lq_tmp$x##6772 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3757[VV##3756:=lq_tmp$x##6772][VV##3758:=lq_tmp$x##6773][VV##3765:=lq_tmp$x##6777]}) | $k_##3759[VV##3758:=lq_tmp$x##6773][VV##3765:=lq_tmp$x##6777]})&lt;\lq_tmp$x##6786 VV -&gt; {lq_tmp$x##6776 : (GHC.Maybe.Maybe {lq_tmp$x##6775 : InterfaceAdapters.Water.MH.Core.WaterLevelHeaders.PercentLiveStorage | $k_##3762[VV##3761:=lq_tmp$x##6775][VV##3763:=lq_tmp$x##6776][VV##3765:=lq_tmp$x##6777][lq_tmp$x##3760:=lq_tmp$x##6786][lq_tmp$x##6774:=lq_tmp$x##6786][lq_tmp$x##6784:=lq_tmp$x##6786]}) | $k_##3764[VV##3763:=lq_tmp$x##6776][VV##3765:=lq_tmp$x##6777][lq_tmp$x##3760:=lq_tmp$x##6786][lq_tmp$x##6774:=lq_tmp$x##6786][lq_tmp$x##6784:=lq_tmp$x##6786]}&gt; | $k_##3766[VV##3765:=lq_tmp$x##6777]} -&gt; {lq_tmp$x##6782 : (GHC.Types.IO {lq_tmp$x##6781 : [{lq_tmp$x##6778 : GHC.Types.Char | $k_##3769[VV##3768:=lq_tmp$x##6778][VV##3773:=lq_tmp$x##6781][VV##3775:=lq_tmp$x##6782][ds_d55Uo:=lq_tmp$x##6785]}]&lt;\lq_tmp$x##6787 VV -&gt; {lq_tmp$x##6780 : GHC.Types.Char | $k_##3772[VV##3771:=lq_tmp$x##6780][VV##3773:=lq_tmp$x##6781][VV##3775:=lq_tmp$x##6782][ds_d55Uo:=lq_tmp$x##6785][lq_tmp$x##3770:=lq_tmp$x##6787][lq_tmp$x##6779:=lq_tmp$x##6787]}&gt; | $k_##3774[VV##3773:=lq_tmp$x##6781][VV##3775:=lq_tmp$x##6782][ds_d55Uo:=lq_tmp$x##6785]}) | $k_##3776[VV##3775:=lq_tmp$x##6782][ds_d55Uo:=lq_tmp$x##6785]}</span><span class='hs-sel'>_helperLivePercent</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##6838:{lq_tmp$x##6829 : [{lq_tmp$x##6826 : GHC.Types.Char | $k_##4240[VV##4239:=lq_tmp$x##6826][VV##4244:=lq_tmp$x##6829][ds_d55U9:=lq_anf$##7205759403794008173##d55XT][lq_tmp$x##6836:=ds_d55VA][lq_tmp$x##6837:=lq_anf$##7205759403794008173##d55XT][twn##a55PU:=ds_d55VA]}]&lt;\lq_tmp$x##6839 VV -&gt; {lq_tmp$x##6828 : GHC.Types.Char | $k_##4243[VV##4242:=lq_tmp$x##6828][VV##4244:=lq_tmp$x##6829][ds_d55U9:=lq_anf$##7205759403794008173##d55XT][lq_tmp$x##4241:=lq_tmp$x##6839][lq_tmp$x##6827:=lq_tmp$x##6839][lq_tmp$x##6835:=lq_tmp$x##6839][lq_tmp$x##6836:=ds_d55VA][lq_tmp$x##6837:=lq_anf$##7205759403794008173##d55XT][twn##a55PU:=ds_d55VA]}&gt; | $k_##4245[VV##4244:=lq_tmp$x##6829][ds_d55U9:=lq_anf$##7205759403794008173##d55XT][lq_tmp$x##6836:=ds_d55VA][lq_tmp$x##6837:=lq_anf$##7205759403794008173##d55XT][twn##a55PU:=ds_d55VA]} -&gt; {lq_tmp$x##6831 : (GHC.Types.IO {lq_tmp$x##6830 : Data.Text.Internal.Text | $k_##4248[VV##4247:=lq_tmp$x##6830][VV##4249:=lq_tmp$x##6831][ds_d55U9:=lq_anf$##7205759403794008173##d55XT][lq_tmp$x##6836:=ds_d55VA][lq_tmp$x##6837:=lq_anf$##7205759403794008173##d55XT][twn##a55PU:=ds_d55VA][wl##a55PV:=lq_tmp$x##6838]}) | $k_##4250[VV##4249:=lq_tmp$x##6831][ds_d55U9:=lq_anf$##7205759403794008173##d55XT][lq_tmp$x##6836:=ds_d55VA][lq_tmp$x##6837:=lq_anf$##7205759403794008173##d55XT][twn##a55PU:=ds_d55VA][wl##a55PV:=lq_tmp$x##6838]}</span><span class='hs-sel'>_mkWeatherThere</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6840 : Data.Text.Internal.Text | lq_tmp$x##6840 == ds_d55VA}</span><span class='hs-varid'>pl</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6815 : Data.Text.Internal.Text | len lq_anf$##7205759403794008172##d55XS == stringlen lq_tmp$x##6815
                                            &amp;&amp; lq_anf$##7205759403794008172##d55XS ~~ lq_tmp$x##6815}</span><span class='hs-str'>""</span></a>
<span class=hs-linenum>88: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WeatherWaterLevels</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Detailed</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NearForecast</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##7222:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromTown</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7223 : Data.Text.Internal.Text | lq_tmp$x##7223 == ds_d55VA}</span><span class='hs-varid'>pl</span></a>
<span class=hs-linenum>89: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-conid'>UserAsk</span> <span class='hs-layout'>{</span><span class='hs-varid'>placeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WeatherWaterLevels</span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mini</span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RightNow</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##6916:Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-sel'>_getTownNameWeatherFromTown</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6917 : Data.Text.Internal.Text | lq_tmp$x##6917 == ds_d55VA}</span><span class='hs-varid'>pl</span></a>
<span class=hs-linenum>90: </span>
<span class=hs-linenum>91: </span><span class='hs-definition'>getAgInfo</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##12:{lq_tmp$x##7366 : Data.Text.Internal.Text | $k_##7365[VV##7364:=lq_tmp$x##7366]} -&gt; (GHC.Types.IO {lq_tmp$x##7366 : Data.Text.Internal.Text | $k_##7365[VV##7364:=lq_tmp$x##7366]})</span><span class='hs-varid'>return</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Data.ByteString.Char8.pack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7331 : [GHC.Types.Char] | len lq_tmp$x##7331 == strLen lq_anf$##7205759403794008165##d55XL
                                     &amp;&amp; lq_tmp$x##7331 ~~ lq_anf$##7205759403794008165##d55XL}</span><span class='hs-str'>"Are your preferences set right? Use /prefs &lt;Weather or WaterLevels or WeatherWaterLevels or Monsoon or All&gt; &lt;Mini or Standard or Detailed&gt; &lt;RightNow or Alerts or NearForecast or LongRange&gt; For ex: /prefs weather mini rightnow "</span></a> 
<span class=hs-linenum>92: </span><span class='hs-comment'>-- getAgInfo UserAsk {placeName = pl, prefs = Preferences {userdata = Weather, usersize = Mini, usertimespan = Alerts}} = weatherCurrentAlerts $ Data.ByteString.Char8.unpack pl </span>
</pre>
</body>
</html>