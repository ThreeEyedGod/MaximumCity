<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/InterfaceAdapters/Water/MH/Core/ParserHelper.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><span class='hs-comment'>{-# LANGUAGE OverloadedStrings #-}</span>
<span class=hs-linenum>  2: </span><span class='hs-comment'>{-# LANGUAGE PatternSynonyms #-}</span>
<span class=hs-linenum>  3: </span><span class='hs-comment'>{-# LANGUAGE FlexibleContexts #-}</span>
<span class=hs-linenum>  4: </span>
<span class=hs-linenum>  5: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>InterfaceAdapters.Water.MH.Core.ParserHelper</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  6: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Debug.Trace</span> 
<span class=hs-linenum>  7: </span>
<span class=hs-linenum>  8: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Attoparsec.ByteString</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Att</span>
<span class=hs-linenum>  9: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Attoparsec.ByteString.Char8</span> <span class='hs-layout'>(</span><span class='hs-varid'>skipSpace</span><span class='hs-layout'>,</span> <span class='hs-varid'>isDigit_w8</span><span class='hs-layout'>,</span> <span class='hs-varid'>manyTill</span><span class='hs-layout'>,</span> <span class='hs-varid'>isHorizontalSpace</span><span class='hs-layout'>,</span> <span class='hs-varid'>endOfLine</span><span class='hs-layout'>,</span> <span class='hs-varid'>char</span><span class='hs-layout'>,</span> <span class='hs-varid'>decimal</span><span class='hs-layout'>,</span> <span class='hs-varid'>space</span><span class='hs-layout'>,</span> <span class='hs-varid'>double</span><span class='hs-layout'>,</span> <span class='hs-varid'>letter_ascii</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Word8</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>W</span>
<span class=hs-linenum> 11: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Word</span>
<span class=hs-linenum> 12: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.ByteString</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>BS</span>
<span class=hs-linenum> 13: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.ByteString.Char8</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>BSC</span>
<span class=hs-linenum> 14: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.ByteString</span> <span class='hs-layout'>(</span> <span class='hs-conid'>ByteString</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 15: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Monad</span>
<span class=hs-linenum> 16: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Applicative</span>
<span class=hs-linenum> 17: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Char</span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>takeWhile</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 19: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Water.MH.Core.WaterLevelHeaders</span>
<span class=hs-linenum> 20: </span>
<span class=hs-linenum> 21: </span><span class='hs-definition'>pattern</span> <span class='hs-conid'>LF</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span>
<span class=hs-linenum> 22: </span><span class='hs-definition'>pattern</span> <span class='hs-conid'>LF</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>10</span>
<span class=hs-linenum> 23: </span>
<span class=hs-linenum> 24: </span><span class='hs-definition'>pattern</span> <span class='hs-conid'>CR</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span>
<span class=hs-linenum> 25: </span><span class='hs-definition'>pattern</span> <span class='hs-conid'>CR</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>13</span>
<span class=hs-linenum> 26: </span>
<span class=hs-linenum> 27: </span><span class='hs-definition'>pattern</span> <span class='hs-conid'>PCT</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span>
<span class=hs-linenum> 28: </span><span class='hs-definition'>pattern</span> <span class='hs-conid'>PCT</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>37</span>
<span class=hs-linenum> 29: </span>
<span class=hs-linenum> 30: </span><span class='hs-definition'>percentage</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 31: </span><span class='hs-definition'>percentage</span> <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>void</span> <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'%'</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;?&gt;</span> <span class='hs-str'>"percentage"</span>
<span class=hs-linenum> 32: </span>
<span class=hs-linenum> 33: </span><span class='hs-sel'>_takeWhileNOT_1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 34: </span><span class='hs-sel'>_takeWhileNOT_1</span> <span class='hs-varid'>w8</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>takeWhile</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>c</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span> <span class='hs-varop'>/=</span> <span class='hs-varid'>w8</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 35: </span>
<span class=hs-linenum> 36: </span><span class='hs-definition'>lFtextTillCRNL</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 37: </span><span class='hs-definition'>lFtextTillCRNL</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>endOfLine</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>textTillCRNL</span>
<span class=hs-linenum> 38: </span>
<span class=hs-linenum> 39: </span><span class='hs-definition'>lFtextTillDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 40: </span><span class='hs-definition'>lFtextTillDigit</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>endOfLine</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>textTillaDigit</span>
<span class=hs-linenum> 41: </span>
<span class=hs-linenum> 42: </span><span class='hs-definition'>textTillCRNL</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 43: </span><span class='hs-definition'>textTillCRNL</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>takeWhile</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>c</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span> <span class='hs-varop'>/=</span> <span class='hs-conid'>LF</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>c</span> <span class='hs-varop'>/=</span> <span class='hs-conid'>CR</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 44: </span>
<span class=hs-linenum> 45: </span><span class='hs-definition'>textTillPCT</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 46: </span><span class='hs-definition'>textTillPCT</span> <span class='hs-keyglyph'>=</span> <span class='hs-sel'>_takeWhileNOT_1</span> <span class='hs-conid'>PCT</span>
<span class=hs-linenum> 47: </span>
<span class=hs-linenum> 48: </span><span class='hs-definition'>textTillaDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 49: </span><span class='hs-definition'>textTillaDigit</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>takeWhile1</span> <span class='hs-sel'>_isAlpha_ascii</span> 
<span class=hs-linenum> 50: </span>
<span class=hs-linenum> 51: </span><span class='hs-sel'>_isAlpha_ascii</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum> 52: </span><span class='hs-sel'>_isAlpha_ascii</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-varop'>$</span> <span class='hs-varid'>isDigit_w8</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 53: </span>
<span class=hs-linenum> 54: </span>
<span class=hs-linenum> 55: </span><span class='hs-comment'>-- | Begin Maharashtra  ********</span>
<span class=hs-linenum> 56: </span><span class='hs-comment'>-- | parser for the Water Level pdf</span>
<span class=hs-linenum> 57: </span><span class='hs-definition'>colHeaderParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>ColHeader</span>
<span class=hs-linenum> 58: </span><span class='hs-definition'>colHeaderParser</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>string</span> <span class='hs-str'>"\nSR. SR.\nNO. NO.\nNO. OF NO. OF\nDAMS DAMS\nDESIGNED STORAGE DESIGNED STORAGE (Mcum) (Mcum)\nTODAY'S LIVE TODAY'S LIVE\nSTORAGE STORAGE (Mcum) (Mcum)\nPERCENTAGE OF PERCENTAGE OF\nLIVE STORAGE LIVE STORAGE\nW.R.T. DESIGNED W.R.T. DESIGNED\nLIVE STORAGE LIVE STORAGE\nDEAD DEAD LIVE LIVE GROSS GROSS LIVE LIVE GROSS GROSS\nFOR FOR\nTODAY TODAY\nSAME SAME\nDATE DATE\nOF LAST OF LAST\nYEAR YEAR\n"</span>
<span class=hs-linenum> 59: </span>
<span class=hs-linenum> 60: </span><span class='hs-definition'>colNumbersParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>ColumnNos</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 61: </span><span class='hs-definition'>colNumbersParser</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> 
<span class=hs-linenum> 62: </span>    <span class='hs-varid'>x</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>decimal</span> <span class='hs-varop'>`sepBy1`</span> <span class='hs-varid'>char</span> <span class='hs-chr'>' '</span>
<span class=hs-linenum> 63: </span>    <span class='hs-varid'>endOfLine</span>
<span class=hs-linenum> 64: </span>    <span class='hs-varid'>return</span> <span class='hs-varid'>x</span>
<span class=hs-linenum> 65: </span>
<span class=hs-linenum> 66: </span><span class='hs-definition'>justSectionHeadersParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>JustSectionHeaders</span>
<span class=hs-linenum> 67: </span><span class='hs-definition'>justSectionHeadersParser</span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 68: </span>    <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>lFtextTillCRNL</span>
<span class=hs-linenum> 69: </span>    <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>lFtextTillCRNL</span>
<span class=hs-linenum> 70: </span>    <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>lFtextTillCRNL</span>
<span class=hs-linenum> 71: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>JustSectionHeaders</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-definition'>sectionHeadersParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>SectionHeaders</span>
<span class=hs-linenum> 74: </span><span class='hs-definition'>sectionHeadersParser</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 75: </span>    <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>justSectionHeadersParser</span>
<span class=hs-linenum> 76: </span>    <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>colHeaderParser</span>
<span class=hs-linenum> 77: </span>    <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>colNumbersParser</span>
<span class=hs-linenum> 78: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>SectionHeaders</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 79: </span>
<span class=hs-linenum> 80: </span><span class='hs-definition'>page8PageParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>Page8Page9</span>
<span class=hs-linenum> 81: </span><span class='hs-definition'>page8PageParser</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 82: </span>    <span class='hs-varid'>pageHeaders</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>sectionHeadersParser</span>
<span class=hs-linenum> 83: </span>    <span class='hs-varid'>mjrPjs</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>categoryProjectsParser</span>
<span class=hs-linenum> 84: </span>    <span class='hs-varid'>endOfLine</span>
<span class=hs-linenum> 85: </span>    <span class='hs-varid'>medPjs</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>categoryProjectsParser</span>
<span class=hs-linenum> 86: </span>    <span class='hs-varid'>endOfLine</span>
<span class=hs-linenum> 87: </span>    <span class='hs-varid'>minPjs</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>categoryProjectsParser</span>
<span class=hs-linenum> 88: </span>    <span class='hs-varid'>endOfLine</span>
<span class=hs-linenum> 89: </span>    <span class='hs-varid'>allPjs</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>categoryProjectsParser</span> 
<span class=hs-linenum> 90: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Page8Page9</span> <span class='hs-varid'>pageHeaders</span> <span class='hs-varid'>mjrPjs</span> <span class='hs-varid'>medPjs</span> <span class='hs-varid'>minPjs</span> <span class='hs-varid'>allPjs</span>
<span class=hs-linenum> 91: </span>
<span class=hs-linenum> 92: </span><span class='hs-definition'>categoryHeaderParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>ProjectHeader</span>
<span class=hs-linenum> 93: </span><span class='hs-definition'>categoryHeaderParser</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>textTillCRNL</span>
<span class=hs-linenum> 94: </span>
<span class=hs-linenum> 95: </span><span class='hs-comment'>-- order matters within the chomp for pattern matching. </span>
<span class=hs-linenum> 96: </span><span class='hs-comment'>-- decimals/precision changes in prior fields seem to make a difference to the strings below!</span>
<span class=hs-linenum> 97: </span><span class='hs-definition'>chomp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 98: </span><span class='hs-definition'>chomp</span> <span class='hs-keyglyph'>=</span>  <span class='hs-str'>"\nREVENUE REVENUE REGION REGION\nSR. SR.\nNO. NO.\nNO. OF NO. OF\nDAMS DAMS\nDESIGNED STORAGE DESIGNED STORAGE\n(Mcum) (Mcum)\nTODAY'S LIVE TODAY'S LIVE\nSTORAGE STORAGE\n(Mcum) (Mcum)\nPERCENTAGE OF PERCENTAGE OF\nLIVE STORAGE LIVE STORAGE\nW.R.T. W.R.T. DESIGNED DESIGNED\nLIVE STORAGE LIVE STORAGE\nDEAD DEAD LIVE LIVE GROSS GROSS LIVE LIVE GROSS GROSS\nFOR FOR\nTODAY TODAY\nSAME SAME\nDATE OF DATE OF\nLAST LAST\nYEAR YEAR\n1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 10 10"</span>  <span class='hs-varop'>&lt;|&gt;</span> <span class='hs-str'>"\nREVENUE REVENUE REGION REGION\nSR. SR.\nNO. NO.\nNO. OF NO. OF\nDAMS DAMS\nDESIGNED STORAGE DESIGNED STORAGE\n(Mcum) (Mcum)\nTODAY'S LIVE TODAY'S LIVE\nSTORAGE STORAGE (Mcum) (Mcum)\nPERCENTAGE OF PERCENTAGE OF\nLIVE STORAGE LIVE STORAGE\nW.R.T. W.R.T. DESIGNED DESIGNED\nLIVE STORAGE LIVE STORAGE\nDEAD DEAD LIVE LIVE GROSS GROSS LIVE LIVE GROSS GROSS\nFOR FOR\nTODAY TODAY\nSAME SAME\nDATE OF DATE OF\nLAST LAST\nYEAR YEAR\n1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 10 10"</span> <span class='hs-varop'>&lt;|&gt;</span> <span class='hs-varid'>string</span> <span class='hs-str'>"\nREVENUE REVENUE REGION REGION\nSR. SR.\nNO. NO.\nNO. OF NO. OF\nDAMS DAMS\nDESIGNED STORAGE DESIGNED STORAGE\n(Mcum) (Mcum)\nTODAY'S LIVE TODAY'S LIVE\nSTORAGE STORAGE (Mcum) (Mcum)\nPERCENTAGE OF PERCENTAGE OF\nLIVE STORAGE LIVE STORAGE\nW.R.T. W.R.T. DESIGNED DESIGNED\nLIVE STORAGE LIVE STORAGE\nDEAD DEAD LIVE LIVE GROSS GROSS LIVE LIVE GROSS GROSS\nFOR FOR\nTODAY TODAY\nSAME SAME\nDATE DATE\nOF LAST OF LAST\nYEAR YEAR\n1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 10 10"</span> <span class='hs-varop'>&lt;|&gt;</span> <span class='hs-varid'>string</span> <span class='hs-str'>""</span>
<span class=hs-linenum> 99: </span>
<span class=hs-linenum>100: </span><span class='hs-comment'>-- "\n1 Amravati 10 589.95 2363.93 2953.88 1499.27 2111.88 63.42% 76.51%\n2 Aurangabad 45 1444.86 4505.36 5950.21 2283.74 3716.54 50.69% 62.14%\n3 Kokan 11 123.37 2459.4 2582.77 2132.26 2248.38 86.7% 79.21%\n4 Nagpur 16 839.5 3462.92 4302.42 1766.13 2605.63 51.0% 70.85%\n5 Nashik 24 529.18 3738.75 4267.93 2238.47 2767.63 59.87% 66.87%\n6 Pune 35 2950.74 12444.02 15394.75 10267.09 13220.26 82.51% 72.67%\nTotal Major Projects"</span>
<span class=hs-linenum>101: </span><span class='hs-definition'>categoryProjectsLinedataParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>RegionEntry</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>102: </span><span class='hs-definition'>categoryProjectsLinedataParser</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>manyTill</span> <span class='hs-varid'>regionEntryParser</span> <span class='hs-layout'>(</span><span class='hs-varid'>string</span> <span class='hs-str'>"\nTotal"</span><span class='hs-layout'>)</span>
<span class=hs-linenum>103: </span>
<span class=hs-linenum>104: </span><span class='hs-comment'>-- | Major Projects 141 6477.59 28974.36 35451.96 20186.96 26670.32 69.67% 70.94% </span>
<span class=hs-linenum>105: </span><span class='hs-definition'>totalCategoryProjectsParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>TotalProjectFooter</span>
<span class=hs-linenum>106: </span><span class='hs-definition'>totalCategoryProjectsParser</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>107: </span>    <span class='hs-varop'>--endOfLine</span>
<span class=hs-linenum>108: </span>    <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>textTillaDigit</span>
<span class=hs-linenum>109: </span>    <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>regionWaterDataParser</span>
<span class=hs-linenum>110: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>TotalProjectFooter</span> <span class='hs-varid'>a</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>111: </span>
<span class=hs-linenum>112: </span><span class='hs-comment'>-- | \nMajor Projects\n1 Amravati 10 589.95 2363.93 2953.88 1499.27 2111.88 63.42% 76.51%\n2 Aurangabad 45 1444.86 4505.36 5950.21 2283.74 3716.54 50.69% 62.14%\n3 Kokan 11 123.37 2459.4 2582.77 2132.26 2248.38 86.7% 79.21%\n4 Nagpur 16 839.5 3462.92 4302.42 1766.13 2605.63 51.0% 70.85%\n5 Nashik 24 529.18 3738.75 4267.93 2238.47 2767.63 59.87% 66.87%\n6 Pune 35 2950.74 12444.02 15394.75 10267.09 13220.26 82.51% 72.67%\nTotal Major Projects 141 6477.59 28974.36 35451.96 20186.96 26670.32 69.67% 70.94%</span>
<span class=hs-linenum>113: </span><span class='hs-definition'>categoryProjectsParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>CategoryProjects</span>
<span class=hs-linenum>114: </span><span class='hs-definition'>categoryProjectsParser</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>115: </span>    <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>categoryHeaderParser</span>
<span class=hs-linenum>116: </span>    <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>categoryProjectsLinedataParser</span>
<span class=hs-linenum>117: </span>    <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>totalCategoryProjectsParser</span> 
<span class=hs-linenum>118: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>CategoryProjects</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> 
<span class=hs-linenum>119: </span>
<span class=hs-linenum>120: </span><span class='hs-comment'>-- | 10 589.95 2363.93 2953.88 1499.27 2111.88 63.42% 76.51%</span>
<span class=hs-linenum>121: </span><span class='hs-definition'>regionWaterDataParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>RegionWaterData</span>
<span class=hs-linenum>122: </span><span class='hs-definition'>regionWaterDataParser</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>123: </span>    <span class='hs-varid'>z</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>decimal</span>
<span class=hs-linenum>124: </span>    <span class='hs-varid'>space</span>
<span class=hs-linenum>125: </span>    <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>double</span> 
<span class=hs-linenum>126: </span>    <span class='hs-varid'>space</span>
<span class=hs-linenum>127: </span>    <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>double</span>
<span class=hs-linenum>128: </span>    <span class='hs-varid'>space</span>
<span class=hs-linenum>129: </span>    <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>double</span>
<span class=hs-linenum>130: </span>    <span class='hs-varid'>space</span>
<span class=hs-linenum>131: </span>    <span class='hs-varid'>d</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>double</span>
<span class=hs-linenum>132: </span>    <span class='hs-varid'>space</span>
<span class=hs-linenum>133: </span>    <span class='hs-varid'>e</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>double</span>
<span class=hs-linenum>134: </span>    <span class='hs-varid'>space</span>
<span class=hs-linenum>135: </span>    <span class='hs-varid'>f</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>textTillPCT</span>
<span class=hs-linenum>136: </span>    <span class='hs-varid'>percentage</span>  <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>space</span>
<span class=hs-linenum>137: </span>    <span class='hs-varid'>g</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>textTillPCT</span>
<span class=hs-linenum>138: </span>    <span class='hs-comment'>--percentage &gt;&gt; endOfLine</span>
<span class=hs-linenum>139: </span>    <span class='hs-varid'>percentage</span>
<span class=hs-linenum>140: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>RegionWaterData</span> <span class='hs-varid'>z</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> 
<span class=hs-linenum>141: </span>
<span class=hs-linenum>142: </span><span class='hs-comment'>-- | \n1 Amravati 10 589.95 2363.93 2953.88 1499.27 2111.88 63.42% 76.51%\n</span>
<span class=hs-linenum>143: </span><span class='hs-definition'>regionEntryParser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-conid'>RegionEntry</span>
<span class=hs-linenum>144: </span><span class='hs-definition'>regionEntryParser</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>145: </span>    <span class='hs-varid'>chomp</span>
<span class=hs-linenum>146: </span>    <span class='hs-varid'>endOfLine</span>
<span class=hs-linenum>147: </span>    <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>decimal</span>
<span class=hs-linenum>148: </span>    <span class='hs-varid'>space</span> 
<span class=hs-linenum>149: </span>    <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>takeTill</span> <span class='hs-varid'>isHorizontalSpace</span>
<span class=hs-linenum>150: </span>    <span class='hs-varid'>space</span>
<span class=hs-linenum>151: </span>    <span class='hs-varid'>d</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>regionWaterDataParser</span>
<span class=hs-linenum>152: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>RegionEntry</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>d</span>
<span class=hs-linenum>153: </span>
<span class=hs-linenum>154: </span><span class='hs-comment'>-- | Show me Tests</span>
<span class=hs-linenum>155: </span><span class='hs-definition'>parseCHP</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>156: </span><span class='hs-definition'>parseCHP</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseTest</span> <span class='hs-varid'>categoryHeaderParser</span>
<span class=hs-linenum>157: </span>
<span class=hs-linenum>158: </span><span class='hs-definition'>parseTest0</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>String</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum>159: </span><span class='hs-definition'>parseTest0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseOnly</span> <span class='hs-varid'>lFtextTillCRNL</span> 
<span class=hs-linenum>160: </span>
<span class=hs-linenum>161: </span><span class='hs-definition'>parseTest1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>String</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum>162: </span><span class='hs-definition'>parseTest1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseOnly</span> <span class='hs-varid'>textTillCRNL</span> 
<span class=hs-linenum>163: </span>
<span class=hs-linenum>164: </span><span class='hs-definition'>parseTest2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>165: </span><span class='hs-definition'>parseTest2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseTest</span> <span class='hs-varid'>justSectionHeadersParser</span>
<span class=hs-linenum>166: </span>
<span class=hs-linenum>167: </span><span class='hs-definition'>parseTest3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>String</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum>168: </span><span class='hs-definition'>parseTest3</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseOnly</span> <span class='hs-varid'>colHeaderParser</span>
<span class=hs-linenum>169: </span>
<span class=hs-linenum>170: </span><span class='hs-definition'>parseTest4</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>ColumnNos</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>171: </span><span class='hs-definition'>parseTest4</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseOnly</span> <span class='hs-varid'>colNumbersParser</span>
<span class=hs-linenum>172: </span>
<span class=hs-linenum>173: </span><span class='hs-definition'>parseTestSH</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>174: </span><span class='hs-definition'>parseTestSH</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseTest</span> <span class='hs-varid'>sectionHeadersParser</span>
<span class=hs-linenum>175: </span>
<span class=hs-linenum>176: </span><span class='hs-definition'>parseTestRE</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>177: </span><span class='hs-definition'>parseTestRE</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseTest</span> <span class='hs-varid'>regionEntryParser</span>
<span class=hs-linenum>178: </span>
<span class=hs-linenum>179: </span><span class='hs-definition'>parseTestWDP</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>180: </span><span class='hs-definition'>parseTestWDP</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseTest</span> <span class='hs-varid'>regionWaterDataParser</span>
<span class=hs-linenum>181: </span>
<span class=hs-linenum>182: </span><span class='hs-definition'>parseTestCPS</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>183: </span><span class='hs-definition'>parseTestCPS</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseTest</span> <span class='hs-varid'>categoryProjectsParser</span>
<span class=hs-linenum>184: </span>
<span class=hs-linenum>185: </span><span class='hs-definition'>parseTestTPFooter</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>186: </span><span class='hs-definition'>parseTestTPFooter</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseTest</span> <span class='hs-varid'>totalCategoryProjectsParser</span>
<span class=hs-linenum>187: </span>
<span class=hs-linenum>188: </span><span class='hs-definition'>parseTestCPP</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>String</span> <span class='hs-conid'>CategoryProjects</span>
<span class=hs-linenum>189: </span><span class='hs-definition'>parseTestCPP</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseOnly</span> <span class='hs-varid'>categoryProjectsParser</span>
<span class=hs-linenum>190: </span>
<span class=hs-linenum>191: </span><span class='hs-definition'>parseTestTextTillaDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>String</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum>192: </span><span class='hs-definition'>parseTestTextTillaDigit</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseOnly</span> <span class='hs-varid'>textTillaDigit</span>
<span class=hs-linenum>193: </span>
<span class=hs-linenum>194: </span><span class='hs-definition'>parseTestTTPCT</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>195: </span><span class='hs-definition'>parseTestTTPCT</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseTest</span> <span class='hs-varid'>textTillPCT</span>
<span class=hs-linenum>196: </span>
<span class=hs-linenum>197: </span><span class='hs-definition'>parseTestp8p9</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>198: </span><span class='hs-definition'>parseTestp8p9</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseTest</span> <span class='hs-varid'>page8PageParser</span>
<span class=hs-linenum>199: </span>
<span class=hs-linenum>200: </span><span class='hs-comment'>-- | End Maharashtra  ********</span>
</pre>
</body>
</html>