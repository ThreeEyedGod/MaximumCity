<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/InterfaceAdapters/Telegram/Telegram.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>{VV##1972 : GHC.Types.Module | $k_##1973}</span><span class='hs-comment'>{-# LANGUAGE OverloadedStrings #-}</span></a>
<span class=hs-linenum>  2: </span><span class='hs-comment'>{-# OPTIONS_GHC -Wno-orphans  #-}</span>
<span class=hs-linenum>  3: </span>
<span class=hs-linenum>  4: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>InterfaceAdapters.Telegram.Telegram</span> <span class='hs-layout'>(</span>
<span class=hs-linenum>  5: </span>    <span class='hs-sel'>_handleUpdate</span>
<span class=hs-linenum>  6: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>getTelegramSettings</span>
<span class=hs-linenum>  7: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>TC</span>
<span class=hs-linenum>  8: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>runTC</span>
<span class=hs-linenum>  9: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>gettheTelegram</span>
<span class=hs-linenum> 10: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>getTelegram</span>
<span class=hs-linenum> 11: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>getTelegramUser</span>
<span class=hs-linenum> 12: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>getUserId</span>
<span class=hs-linenum> 13: </span>  <span class='hs-layout'>,</span> <span class='hs-sel'>_callTelegramClient</span>
<span class=hs-linenum> 14: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>TelegramMessage</span>
<span class=hs-linenum> 15: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>parseGetResponse</span>
<span class=hs-linenum> 16: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>parsePrefs</span>
<span class=hs-linenum> 17: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>getMeta</span>
<span class=hs-linenum> 18: </span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 19: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Generics</span> <span class='hs-layout'>(</span><span class='hs-conid'>Generic</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 20: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.ByteString</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>BS</span>
<span class=hs-linenum> 21: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.ByteString.Lazy.Char8</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>LB</span>
<span class=hs-linenum> 22: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<span class=hs-linenum> 23: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text.Encoding</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<span class=hs-linenum> 24: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Text.Printf</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 25: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Debug.Trace</span> <span class='hs-layout'>(</span><span class='hs-varid'>trace</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 26: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span> <span class='hs-layout'>(</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 27: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Either.Combinators</span> <span class='hs-layout'>(</span> <span class='hs-varid'>rightToMaybe</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 28: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Monad.IO.Class</span> <span class='hs-layout'>(</span> <span class='hs-conid'>MonadIO</span><span class='hs-layout'>(</span><span class='hs-varid'>liftIO</span><span class='hs-layout'>)</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 29: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Utils.Helper</span> <span class='hs-layout'>(</span> <span class='hs-varid'>getKey</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 30: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Utils.HttpHeadersPathDefinitions</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>H</span>
<span class=hs-linenum> 31: </span>    <span class='hs-layout'>(</span> <span class='hs-conid'>ResponseBody</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 32: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Monoid</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>&lt;&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 33: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Preferences</span> <span class='hs-layout'>(</span><span class='hs-varid'>parsePrefs</span><span class='hs-layout'>,</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 34: </span>
<span class=hs-linenum> 35: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Web.Telegram.API.Bot</span>
<span class=hs-linenum> 36: </span>    <span class='hs-layout'>(</span> <span class='hs-conid'>Update</span><span class='hs-layout'>(</span><span class='hs-conid'>Update</span><span class='hs-layout'>,</span> <span class='hs-varid'>message</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 37: </span>      <span class='hs-conid'>Token</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 38: </span>      <span class='hs-conid'>TelegramClient</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 39: </span>      <span class='hs-conid'>ChatId</span><span class='hs-layout'>(</span><span class='hs-conid'>ChatId</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 40: </span>      <span class='hs-varid'>runTelegramClient</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 41: </span>      <span class='hs-varid'>sendMessageM</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 42: </span>      <span class='hs-varid'>sendMessageRequest</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 43: </span>      <span class='hs-conid'>Chat</span><span class='hs-layout'>(</span><span class='hs-varid'>chat_id</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 44: </span>      <span class='hs-conid'>Message</span><span class='hs-layout'>(</span><span class='hs-varid'>from</span><span class='hs-layout'>,</span> <span class='hs-varid'>chat</span><span class='hs-layout'>,</span> <span class='hs-varid'>text</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 45: </span>      <span class='hs-conid'>User</span> <span class='hs-layout'>(</span><span class='hs-varid'>user_id</span><span class='hs-layout'>,</span> <span class='hs-varid'>user_first_name</span> <span class='hs-layout'>,</span> <span class='hs-varid'>user_last_name</span><span class='hs-layout'>,</span> <span class='hs-varid'>user_username</span><span class='hs-layout'>,</span> <span class='hs-varid'>user_language_code</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> 
<span class=hs-linenum> 46: </span>      <span class='hs-conid'>SetWebhookRequest</span> <span class='hs-layout'>(</span><span class='hs-varid'>webhook_allowed_updates</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 47: </span>
<span class=hs-linenum> 48: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Network.HTTP.Client</span> <span class='hs-layout'>(</span><span class='hs-conid'>Manager</span><span class='hs-layout'>,</span> <span class='hs-varid'>newManager</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 49: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Network.HTTP.Client.TLS</span> <span class='hs-layout'>(</span><span class='hs-varid'>tlsManagerSettings</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 50: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Monad</span><span class='hs-layout'>(</span><span class='hs-varid'>void</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 51: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.ByteString</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Data.ByteString.Char8</span>
<span class=hs-linenum> 52: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Aeson</span>
<span class=hs-linenum> 53: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>eitherDecode</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 54: </span>      <span class='hs-varid'>encode</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 55: </span>      <span class='hs-varid'>decode</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 56: </span>      <span class='hs-conid'>KeyValue</span><span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>.=</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 57: </span>      <span class='hs-varid'>object</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 58: </span>      <span class='hs-conid'>FromJSON</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 59: </span>      <span class='hs-varid'>parseJSON</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 60: </span>      <span class='hs-conid'>Value</span> <span class='hs-layout'>(</span><span class='hs-conid'>Object</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 61: </span>       <span class='hs-layout'>)</span>
<span class=hs-linenum> 62: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text.Lazy.Lens</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<span class=hs-linenum> 63: </span>
<span class=hs-linenum> 64: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>TC</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Token</span><span class='hs-layout'>,</span> <span class='hs-conid'>Manager</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 65: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>AllInputs</span>  <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>H.ResponseBody</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Update</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 66: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>TelegramMessage</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Update</span>
<span class=hs-linenum> 67: </span>
<span class=hs-linenum> 68: </span>
<span class=hs-linenum> 69: </span><span class='hs-definition'>runTC</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>TC</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TelegramClient</span> <span class='hs-conid'>()</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 70: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2015:(GHC.Maybe.Maybe (Web.Telegram.API.Bot.API.Core.Token, Network.HTTP.Client.Types.Manager)) -&gt; lq_tmp$x##2016:(Control.Monad.Trans.Reader.ReaderT Web.Telegram.API.Bot.API.Core.Token Servant.Client.Internal.HttpClient.ClientM ()) -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>runTC</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-keyword'>_</span>                   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2052 : (GHC.Base.Applicative GHC.Types.IO) | lq_tmp$x##2052 == GHC.Base.$fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2056 : () | lq_tmp$x##2056 == GHC.Tuple.()}</span><span class='hs-conid'>()</span></a> <span class='hs-comment'>-- really nothing can be done vis-a-vis telegram in this case !</span>
<span class=hs-linenum> 71: </span><span class='hs-definition'>runTC</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>token</span><span class='hs-layout'>,</span> <span class='hs-varid'>manager</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>act</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2151:(GHC.Types.IO {lq_tmp$x##2161 : (Data.Either.Either {lq_tmp$x##2159 : Servant.Client.Core.ClientError.ClientError | $k_##2154[VV##2153:=lq_tmp$x##2159][VV##2157:=lq_tmp$x##2161][lq_tmp$x##2150:=GHC.Base.$fFunctorIO]} {lq_tmp$x##2160 : () | $k_##2156[VV##2155:=lq_tmp$x##2160][VV##2157:=lq_tmp$x##2161][lq_tmp$x##2150:=GHC.Base.$fFunctorIO]}) | $k_##2158[VV##2157:=lq_tmp$x##2161][lq_tmp$x##2150:=GHC.Base.$fFunctorIO]}) -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>void</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO (Data.Either.Either Servant.Client.Core.ClientError.ClientError {lq_tmp$x##2132 : () | $k_##2131[VV##2130:=lq_tmp$x##2132][lq_tmp$x##2127:=token##a3cBD][lq_tmp$x##2128:=manager##a3cBE][lq_tmp$x##2129:=ds_d3cQc]}))</span><span class='hs-varid'>runTelegramClient</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2133 : Web.Telegram.API.Bot.API.Core.Token | lq_tmp$x##2133 == token##a3cBD}</span><span class='hs-varid'>token</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2134 : Network.HTTP.Client.Types.Manager | lq_tmp$x##2134 == manager##a3cBE}</span><span class='hs-varid'>manager</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2138 : (Control.Monad.Trans.Reader.ReaderT Web.Telegram.API.Bot.API.Core.Token Servant.Client.Internal.HttpClient.ClientM ()) | lq_tmp$x##2138 == ds_d3cQc}</span><span class='hs-varid'>act</span></a>
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-definition'>getTelegramSettings</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>String</span> <span class='hs-conid'>TC</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 74: </span><a class=annot href="#"><span class=annottext>(GHC.Types.IO (Data.Either.Either [GHC.Types.Char] (Web.Telegram.API.Bot.API.Core.Token, Network.HTTP.Client.Types.Manager)))</span><span class='hs-definition'>getTelegramSettings</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 75: </span>  <a class=annot href="#"><span class=annottext>(Data.Either.Either InterfaceAdapters.Utils.Helper.EnvError [GHC.Types.Char])</span><span class='hs-varid'>tk</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO (Data.Either.Either InterfaceAdapters.Utils.Helper.EnvError [GHC.Types.Char]))</span><span class='hs-varid'>getKey</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4716 : [GHC.Types.Char] | len lq_tmp$x##4716 == strLen lq_anf$##7205759403793558131##d3cT9
                                     &amp;&amp; lq_tmp$x##4716 ~~ lq_anf$##7205759403793558131##d3cT9}</span><span class='hs-str'>"TELEGRAM_TOKEN"</span></a>
<span class=hs-linenum> 76: </span>  <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4786 : (Data.Either.Either InterfaceAdapters.Utils.Helper.EnvError [GHC.Types.Char]) | lq_tmp$x##4786 == tk##a3cBG}</span><span class='hs-varid'>tk</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 77: </span>    <span class='hs-conid'>Left</span> <span class='hs-varid'>msg</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4986:{lq_tmp$x##5018 : (GHC.Types.IO {lq_tmp$x##5017 : (Data.Either.Either {lq_tmp$x##5011 : [{lq_tmp$x##5008 : GHC.Types.Char | $k_##4989[VV##4988:=lq_tmp$x##5008][VV##4993:=lq_tmp$x##5011][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]}]&lt;\lq_tmp$x##5009 VV -&gt; {lq_tmp$x##5010 : GHC.Types.Char | $k_##4992[VV##4991:=lq_tmp$x##5010][VV##4993:=lq_tmp$x##5011][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf][lq_tmp$x##4990:=lq_tmp$x##5009]}&gt; | $k_##4994[VV##4993:=lq_tmp$x##5011][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]} {lq_tmp$x##5016 : ({lq_tmp$x##5012 : Web.Telegram.API.Bot.API.Core.Token | $k_##4996[VV##4995:=lq_tmp$x##5012][VV##5002:=lq_tmp$x##5016][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]}, {lq_tmp$x##5013 : Network.HTTP.Client.Types.Manager | $k_##4998[VV##4997:=lq_tmp$x##5013][VV##5002:=lq_tmp$x##5016][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]})&lt;\lq_tmp$x##5014 VV -&gt; {lq_tmp$x##5015 : Network.HTTP.Client.Types.Manager | $k_##5001[VV##5000:=lq_tmp$x##5015][VV##5002:=lq_tmp$x##5016][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf][lq_tmp$x##4999:=lq_tmp$x##5014]}&gt; | $k_##5003[VV##5002:=lq_tmp$x##5016][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]}) | $k_##5005[VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]}) | $k_##5007[VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]} -&gt; {lq_tmp$x##5018 : (GHC.Types.IO {lq_tmp$x##5017 : (Data.Either.Either {lq_tmp$x##5011 : [{lq_tmp$x##5008 : GHC.Types.Char | $k_##4989[VV##4988:=lq_tmp$x##5008][VV##4993:=lq_tmp$x##5011][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]}]&lt;\lq_tmp$x##5009 VV -&gt; {lq_tmp$x##5010 : GHC.Types.Char | $k_##4992[VV##4991:=lq_tmp$x##5010][VV##4993:=lq_tmp$x##5011][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf][lq_tmp$x##4990:=lq_tmp$x##5009]}&gt; | $k_##4994[VV##4993:=lq_tmp$x##5011][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]} {lq_tmp$x##5016 : ({lq_tmp$x##5012 : Web.Telegram.API.Bot.API.Core.Token | $k_##4996[VV##4995:=lq_tmp$x##5012][VV##5002:=lq_tmp$x##5016][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]}, {lq_tmp$x##5013 : Network.HTTP.Client.Types.Manager | $k_##4998[VV##4997:=lq_tmp$x##5013][VV##5002:=lq_tmp$x##5016][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]})&lt;\lq_tmp$x##5014 VV -&gt; {lq_tmp$x##5015 : Network.HTTP.Client.Types.Manager | $k_##5001[VV##5000:=lq_tmp$x##5015][VV##5002:=lq_tmp$x##5016][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf][lq_tmp$x##4999:=lq_tmp$x##5014]}&gt; | $k_##5003[VV##5002:=lq_tmp$x##5016][VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]}) | $k_##5005[VV##5004:=lq_tmp$x##5017][VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]}) | $k_##5007[VV##5006:=lq_tmp$x##5018][lq_tmp$x##4985:=lq_anf$##7205759403793558137##d3cTf]}</span><span class='hs-varid'>trace</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4850 : [{lq_tmp$x##4862 : GHC.Types.Char | $k_##4861[VV##4860:=lq_tmp$x##4862][lq_tmp$x##4855:=lq_anf$##7205759403793558135##d3cTd][lq_tmp$x##4856:=lq_anf$##7205759403793558136##d3cTe]}] | len lq_tmp$x##4850 == len lq_anf$##7205759403793558135##d3cTd + len lq_anf$##7205759403793558136##d3cTe}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4816 : [GHC.Types.Char] | len lq_tmp$x##4816 == strLen lq_anf$##7205759403793558134##d3cTc
                                     &amp;&amp; lq_tmp$x##4816 ~~ lq_anf$##7205759403793558134##d3cTc}</span><span class='hs-str'>"Left "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4837 : InterfaceAdapters.Utils.Helper.EnvError | lq_tmp$x##4837 == msg##a3cBH}</span><span class='hs-varid'>msg</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##22:{lq_tmp$x##4962 : (Data.Either.Either {lq_tmp$x##4956 : [{lq_tmp$x##4953 : GHC.Types.Char | $k_##4936[VV##4935:=lq_tmp$x##4953][VV##4940:=lq_tmp$x##4956][VV##4951:=lq_tmp$x##4962]}]&lt;\lq_tmp$x##4954 VV -&gt; {lq_tmp$x##4955 : GHC.Types.Char | $k_##4939[VV##4938:=lq_tmp$x##4955][VV##4940:=lq_tmp$x##4956][VV##4951:=lq_tmp$x##4962][lq_tmp$x##4937:=lq_tmp$x##4954]}&gt; | $k_##4941[VV##4940:=lq_tmp$x##4956][VV##4951:=lq_tmp$x##4962]} {lq_tmp$x##4961 : ({lq_tmp$x##4957 : Web.Telegram.API.Bot.API.Core.Token | $k_##4943[VV##4942:=lq_tmp$x##4957][VV##4949:=lq_tmp$x##4961][VV##4951:=lq_tmp$x##4962]}, {lq_tmp$x##4958 : Network.HTTP.Client.Types.Manager | $k_##4945[VV##4944:=lq_tmp$x##4958][VV##4949:=lq_tmp$x##4961][VV##4951:=lq_tmp$x##4962]})&lt;\lq_tmp$x##4959 VV -&gt; {lq_tmp$x##4960 : Network.HTTP.Client.Types.Manager | $k_##4948[VV##4947:=lq_tmp$x##4960][VV##4949:=lq_tmp$x##4961][VV##4951:=lq_tmp$x##4962][lq_tmp$x##4946:=lq_tmp$x##4959]}&gt; | $k_##4950[VV##4949:=lq_tmp$x##4961][VV##4951:=lq_tmp$x##4962]}) | $k_##4952[VV##4951:=lq_tmp$x##4962]} -&gt; (GHC.Types.IO {lq_tmp$x##4962 : (Data.Either.Either {lq_tmp$x##4956 : [{lq_tmp$x##4953 : GHC.Types.Char | $k_##4936[VV##4935:=lq_tmp$x##4953][VV##4940:=lq_tmp$x##4956][VV##4951:=lq_tmp$x##4962]}]&lt;\lq_tmp$x##4954 VV -&gt; {lq_tmp$x##4955 : GHC.Types.Char | $k_##4939[VV##4938:=lq_tmp$x##4955][VV##4940:=lq_tmp$x##4956][VV##4951:=lq_tmp$x##4962][lq_tmp$x##4937:=lq_tmp$x##4954]}&gt; | $k_##4941[VV##4940:=lq_tmp$x##4956][VV##4951:=lq_tmp$x##4962]} {lq_tmp$x##4961 : ({lq_tmp$x##4957 : Web.Telegram.API.Bot.API.Core.Token | $k_##4943[VV##4942:=lq_tmp$x##4957][VV##4949:=lq_tmp$x##4961][VV##4951:=lq_tmp$x##4962]}, {lq_tmp$x##4958 : Network.HTTP.Client.Types.Manager | $k_##4945[VV##4944:=lq_tmp$x##4958][VV##4949:=lq_tmp$x##4961][VV##4951:=lq_tmp$x##4962]})&lt;\lq_tmp$x##4959 VV -&gt; {lq_tmp$x##4960 : Network.HTTP.Client.Types.Manager | $k_##4948[VV##4947:=lq_tmp$x##4960][VV##4949:=lq_tmp$x##4961][VV##4951:=lq_tmp$x##4962][lq_tmp$x##4946:=lq_tmp$x##4959]}&gt; | $k_##4950[VV##4949:=lq_tmp$x##4961][VV##4951:=lq_tmp$x##4962]}) | $k_##4952[VV##4951:=lq_tmp$x##4962]})</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either {lq_tmp$x##4902 : [{lq_tmp$x##4899 : GHC.Types.Char | $k_##4893[VV##4892:=lq_tmp$x##4899][VV##4897:=lq_tmp$x##4902][lq_tmp$x##4891:=lq_anf$##7205759403793558139##d3cTh]}]&lt;\lq_tmp$x##4900 VV -&gt; {lq_tmp$x##4901 : GHC.Types.Char | $k_##4896[VV##4895:=lq_tmp$x##4901][VV##4897:=lq_tmp$x##4902][lq_tmp$x##4891:=lq_anf$##7205759403793558139##d3cTh][lq_tmp$x##4894:=lq_tmp$x##4900]}&gt; | $k_##4898[VV##4897:=lq_tmp$x##4902][lq_tmp$x##4891:=lq_anf$##7205759403793558139##d3cTh]} {lq_tmp$x##4916 : ({lq_tmp$x##4912 : Web.Telegram.API.Bot.API.Core.Token | $k_##4904[VV##4903:=lq_tmp$x##4912][VV##4910:=lq_tmp$x##4916][lq_tmp$x##4891:=lq_anf$##7205759403793558139##d3cTh]}, {lq_tmp$x##4913 : Network.HTTP.Client.Types.Manager | $k_##4906[VV##4905:=lq_tmp$x##4913][VV##4910:=lq_tmp$x##4916][lq_tmp$x##4891:=lq_anf$##7205759403793558139##d3cTh]})&lt;\lq_tmp$x##4914 VV -&gt; {lq_tmp$x##4915 : Network.HTTP.Client.Types.Manager | $k_##4909[VV##4908:=lq_tmp$x##4915][VV##4910:=lq_tmp$x##4916][lq_tmp$x##4891:=lq_anf$##7205759403793558139##d3cTh][lq_tmp$x##4907:=lq_tmp$x##4914]}&gt; | $k_##4911[VV##4910:=lq_tmp$x##4916][lq_tmp$x##4891:=lq_anf$##7205759403793558139##d3cTh]})</span><span class='hs-conid'>Left</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4880 : [GHC.Types.Char] | len lq_tmp$x##4880 == strLen lq_anf$##7205759403793558138##d3cTg
                                     &amp;&amp; lq_tmp$x##4880 ~~ lq_anf$##7205759403793558138##d3cTg}</span><span class='hs-str'>"Fail:getTelegramSettings | Telegram Token error"</span></a>
<span class=hs-linenum> 78: </span>    <span class='hs-conid'>Right</span> <span class='hs-varid'>token</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 79: </span>      <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{VV : Web.Telegram.API.Bot.API.Core.Token | VV ~~ lq_anf$##7205759403793558146##d3cTo}</span><span class='hs-varid'>t</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>Token</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5083 : Data.Text.Internal.Text | len lq_anf$##7205759403793558143##d3cTl == stringlen lq_tmp$x##5083
                                            &amp;&amp; lq_anf$##7205759403793558143##d3cTl ~~ lq_tmp$x##5083}</span><span class='hs-str'>"bot"</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.pack</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5104 : [GHC.Types.Char] | lq_tmp$x##5104 == token##a3cBI
                                     &amp;&amp; len lq_tmp$x##5104 &gt;= 0}</span><span class='hs-varid'>token</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 80: </span>      <a class=annot href="#"><span class=annottext>Network.HTTP.Client.Types.Manager</span><span class='hs-varid'>manager</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO Network.HTTP.Client.Types.Manager)</span><span class='hs-varid'>newManager</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5131 : Network.HTTP.Client.Types.ManagerSettings | lq_tmp$x##5131 == Network.HTTP.Client.TLS.tlsManagerSettings}</span><span class='hs-varid'>tlsManagerSettings</span></a>
<span class=hs-linenum> 81: </span>      <a class=annot href="#"><span class=annottext>lq_tmp$x##5354:{lq_tmp$x##5386 : (GHC.Types.IO {lq_tmp$x##5385 : (Data.Either.Either {lq_tmp$x##5379 : [{lq_tmp$x##5376 : GHC.Types.Char | $k_##5357[VV##5356:=lq_tmp$x##5376][VV##5361:=lq_tmp$x##5379][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]}]&lt;\lq_tmp$x##5377 VV -&gt; {lq_tmp$x##5378 : GHC.Types.Char | $k_##5360[VV##5359:=lq_tmp$x##5378][VV##5361:=lq_tmp$x##5379][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs][lq_tmp$x##5358:=lq_tmp$x##5377]}&gt; | $k_##5362[VV##5361:=lq_tmp$x##5379][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]} {lq_tmp$x##5384 : ({lq_tmp$x##5380 : Web.Telegram.API.Bot.API.Core.Token | $k_##5364[VV##5363:=lq_tmp$x##5380][VV##5370:=lq_tmp$x##5384][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]}, {lq_tmp$x##5381 : Network.HTTP.Client.Types.Manager | $k_##5366[VV##5365:=lq_tmp$x##5381][VV##5370:=lq_tmp$x##5384][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]})&lt;\lq_tmp$x##5382 VV -&gt; {lq_tmp$x##5383 : Network.HTTP.Client.Types.Manager | $k_##5369[VV##5368:=lq_tmp$x##5383][VV##5370:=lq_tmp$x##5384][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs][lq_tmp$x##5367:=lq_tmp$x##5382]}&gt; | $k_##5371[VV##5370:=lq_tmp$x##5384][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]}) | $k_##5373[VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]}) | $k_##5375[VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]} -&gt; {lq_tmp$x##5386 : (GHC.Types.IO {lq_tmp$x##5385 : (Data.Either.Either {lq_tmp$x##5379 : [{lq_tmp$x##5376 : GHC.Types.Char | $k_##5357[VV##5356:=lq_tmp$x##5376][VV##5361:=lq_tmp$x##5379][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]}]&lt;\lq_tmp$x##5377 VV -&gt; {lq_tmp$x##5378 : GHC.Types.Char | $k_##5360[VV##5359:=lq_tmp$x##5378][VV##5361:=lq_tmp$x##5379][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs][lq_tmp$x##5358:=lq_tmp$x##5377]}&gt; | $k_##5362[VV##5361:=lq_tmp$x##5379][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]} {lq_tmp$x##5384 : ({lq_tmp$x##5380 : Web.Telegram.API.Bot.API.Core.Token | $k_##5364[VV##5363:=lq_tmp$x##5380][VV##5370:=lq_tmp$x##5384][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]}, {lq_tmp$x##5381 : Network.HTTP.Client.Types.Manager | $k_##5366[VV##5365:=lq_tmp$x##5381][VV##5370:=lq_tmp$x##5384][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]})&lt;\lq_tmp$x##5382 VV -&gt; {lq_tmp$x##5383 : Network.HTTP.Client.Types.Manager | $k_##5369[VV##5368:=lq_tmp$x##5383][VV##5370:=lq_tmp$x##5384][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs][lq_tmp$x##5367:=lq_tmp$x##5382]}&gt; | $k_##5371[VV##5370:=lq_tmp$x##5384][VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]}) | $k_##5373[VV##5372:=lq_tmp$x##5385][VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]}) | $k_##5375[VV##5374:=lq_tmp$x##5386][lq_tmp$x##5353:=lq_anf$##7205759403793558150##d3cTs]}</span><span class='hs-varid'>trace</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5204 : [{lq_tmp$x##5216 : GHC.Types.Char | $k_##5215[VV##5214:=lq_tmp$x##5216][lq_tmp$x##5209:=lq_anf$##7205759403793558148##d3cTq][lq_tmp$x##5210:=lq_anf$##7205759403793558149##d3cTr]}] | len lq_tmp$x##5204 == len lq_anf$##7205759403793558148##d3cTq + len lq_anf$##7205759403793558149##d3cTr}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##5159 : [GHC.Types.Char] | len lq_tmp$x##5159 == strLen lq_anf$##7205759403793558147##d3cTp
                                     &amp;&amp; lq_tmp$x##5159 ~~ lq_anf$##7205759403793558147##d3cTp}</span><span class='hs-str'>"Right  "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5190 : [GHC.Types.Char] | lq_tmp$x##5190 == token##a3cBI
                                     &amp;&amp; len lq_tmp$x##5190 &gt;= 0}</span><span class='hs-varid'>token</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##13:{lq_tmp$x##5330 : (Data.Either.Either {lq_tmp$x##5324 : [{lq_tmp$x##5321 : GHC.Types.Char | $k_##5304[VV##5303:=lq_tmp$x##5321][VV##5308:=lq_tmp$x##5324][VV##5319:=lq_tmp$x##5330]}]&lt;\lq_tmp$x##5322 VV -&gt; {lq_tmp$x##5323 : GHC.Types.Char | $k_##5307[VV##5306:=lq_tmp$x##5323][VV##5308:=lq_tmp$x##5324][VV##5319:=lq_tmp$x##5330][lq_tmp$x##5305:=lq_tmp$x##5322]}&gt; | $k_##5309[VV##5308:=lq_tmp$x##5324][VV##5319:=lq_tmp$x##5330]} {lq_tmp$x##5329 : ({lq_tmp$x##5325 : Web.Telegram.API.Bot.API.Core.Token | $k_##5311[VV##5310:=lq_tmp$x##5325][VV##5317:=lq_tmp$x##5329][VV##5319:=lq_tmp$x##5330]}, {lq_tmp$x##5326 : Network.HTTP.Client.Types.Manager | $k_##5313[VV##5312:=lq_tmp$x##5326][VV##5317:=lq_tmp$x##5329][VV##5319:=lq_tmp$x##5330]})&lt;\lq_tmp$x##5327 VV -&gt; {lq_tmp$x##5328 : Network.HTTP.Client.Types.Manager | $k_##5316[VV##5315:=lq_tmp$x##5328][VV##5317:=lq_tmp$x##5329][VV##5319:=lq_tmp$x##5330][lq_tmp$x##5314:=lq_tmp$x##5327]}&gt; | $k_##5318[VV##5317:=lq_tmp$x##5329][VV##5319:=lq_tmp$x##5330]}) | $k_##5320[VV##5319:=lq_tmp$x##5330]} -&gt; (GHC.Types.IO {lq_tmp$x##5330 : (Data.Either.Either {lq_tmp$x##5324 : [{lq_tmp$x##5321 : GHC.Types.Char | $k_##5304[VV##5303:=lq_tmp$x##5321][VV##5308:=lq_tmp$x##5324][VV##5319:=lq_tmp$x##5330]}]&lt;\lq_tmp$x##5322 VV -&gt; {lq_tmp$x##5323 : GHC.Types.Char | $k_##5307[VV##5306:=lq_tmp$x##5323][VV##5308:=lq_tmp$x##5324][VV##5319:=lq_tmp$x##5330][lq_tmp$x##5305:=lq_tmp$x##5322]}&gt; | $k_##5309[VV##5308:=lq_tmp$x##5324][VV##5319:=lq_tmp$x##5330]} {lq_tmp$x##5329 : ({lq_tmp$x##5325 : Web.Telegram.API.Bot.API.Core.Token | $k_##5311[VV##5310:=lq_tmp$x##5325][VV##5317:=lq_tmp$x##5329][VV##5319:=lq_tmp$x##5330]}, {lq_tmp$x##5326 : Network.HTTP.Client.Types.Manager | $k_##5313[VV##5312:=lq_tmp$x##5326][VV##5317:=lq_tmp$x##5329][VV##5319:=lq_tmp$x##5330]})&lt;\lq_tmp$x##5327 VV -&gt; {lq_tmp$x##5328 : Network.HTTP.Client.Types.Manager | $k_##5316[VV##5315:=lq_tmp$x##5328][VV##5317:=lq_tmp$x##5329][VV##5319:=lq_tmp$x##5330][lq_tmp$x##5314:=lq_tmp$x##5327]}&gt; | $k_##5318[VV##5317:=lq_tmp$x##5329][VV##5319:=lq_tmp$x##5330]}) | $k_##5320[VV##5319:=lq_tmp$x##5330]})</span><span class='hs-varid'>return</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either {lq_tmp$x##5269 : [{lq_tmp$x##5266 : GHC.Types.Char | $k_##5260[VV##5259:=lq_tmp$x##5266][VV##5264:=lq_tmp$x##5269][lq_tmp$x##5258:=lq_anf$##7205759403793558151##d3cTt]}]&lt;\lq_tmp$x##5267 VV -&gt; {lq_tmp$x##5268 : GHC.Types.Char | $k_##5263[VV##5262:=lq_tmp$x##5268][VV##5264:=lq_tmp$x##5269][lq_tmp$x##5258:=lq_anf$##7205759403793558151##d3cTt][lq_tmp$x##5261:=lq_tmp$x##5267]}&gt; | $k_##5265[VV##5264:=lq_tmp$x##5269][lq_tmp$x##5258:=lq_anf$##7205759403793558151##d3cTt]} {lq_tmp$x##5283 : ({lq_tmp$x##5279 : Web.Telegram.API.Bot.API.Core.Token | $k_##5271[VV##5270:=lq_tmp$x##5279][VV##5277:=lq_tmp$x##5283][lq_tmp$x##5258:=lq_anf$##7205759403793558151##d3cTt]}, {lq_tmp$x##5280 : Network.HTTP.Client.Types.Manager | $k_##5273[VV##5272:=lq_tmp$x##5280][VV##5277:=lq_tmp$x##5283][lq_tmp$x##5258:=lq_anf$##7205759403793558151##d3cTt]})&lt;\lq_tmp$x##5281 VV -&gt; {lq_tmp$x##5282 : Network.HTTP.Client.Types.Manager | $k_##5276[VV##5275:=lq_tmp$x##5282][VV##5277:=lq_tmp$x##5283][lq_tmp$x##5258:=lq_anf$##7205759403793558151##d3cTt][lq_tmp$x##5274:=lq_tmp$x##5281]}&gt; | $k_##5278[VV##5277:=lq_tmp$x##5283][lq_tmp$x##5258:=lq_anf$##7205759403793558151##d3cTt]})</span><span class='hs-conid'>Right</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5234 : ({lq_tmp$x##5242 : Web.Telegram.API.Bot.API.Core.Token | $k_##5241[VV##5240:=lq_tmp$x##5242][lq_tmp$x##5237:=t##a3cBJ][lq_tmp$x##5238:=manager##a3cBK]}, {lq_tmp$x##5245 : Network.HTTP.Client.Types.Manager | $k_##5244[VV##5243:=lq_tmp$x##5245][lq_tmp$x##5237:=t##a3cBJ][lq_tmp$x##5238:=manager##a3cBK]})&lt;\lq_tmp$x##5239 VV -&gt; {lq_tmp$x##5245 : Network.HTTP.Client.Types.Manager | $k_##5247[VV##5246:=lq_tmp$x##5245][lq_tmp$x##5237:=t##a3cBJ][lq_tmp$x##5238:=manager##a3cBK][lq_tmp$x##5248:=lq_tmp$x##5239]}&gt; | fst lq_tmp$x##5234 == t##a3cBJ
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; snd lq_tmp$x##5234 == manager##a3cBK
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; x_Tuple21 lq_tmp$x##5234 == t##a3cBJ
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; x_Tuple22 lq_tmp$x##5234 == manager##a3cBK}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##5250 : Web.Telegram.API.Bot.API.Core.Token | lq_tmp$x##5250 == t##a3cBJ
                                                        &amp;&amp; lq_tmp$x##5250 ~~ lq_anf$##7205759403793558146##d3cTo}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5251 : Network.HTTP.Client.Types.Manager | lq_tmp$x##5251 == manager##a3cBK}</span><span class='hs-varid'>manager</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 82: </span>
<span class=hs-linenum> 83: </span><span class='hs-sel'>_callTelegramClient</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>TC</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>AllInputs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 84: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2872:(GHC.Maybe.Maybe (Web.Telegram.API.Bot.API.Core.Token, Network.HTTP.Client.Types.Manager)) -&gt; lq_tmp$x##2873:(Data.Text.Internal.Text, (GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.Update)) -&gt; (GHC.Types.IO ())</span><span class='hs-sel'>_callTelegramClient</span></a> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe (Web.Telegram.API.Bot.API.Core.Token, Network.HTTP.Client.Types.Manager))</span><span class='hs-varid'>tc</span></a> <a class=annot href="#"><span class=annottext>(Data.Text.Internal.Text, (GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.Update))</span><span class='hs-varid'>allin</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2954:(Control.Monad.Trans.Reader.ReaderT Web.Telegram.API.Bot.API.Core.Token Servant.Client.Internal.HttpClient.ClientM ()) -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>runTC</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2961 : (GHC.Maybe.Maybe (Web.Telegram.API.Bot.API.Core.Token, Network.HTTP.Client.Types.Manager)) | lq_tmp$x##2961 == tc##a3cBL}</span><span class='hs-varid'>tc</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2917 : (Control.Monad.Trans.Reader.ReaderT {lq_tmp$x##2914 : Web.Telegram.API.Bot.API.Core.Token | $k_##2907[VV##2906:=lq_tmp$x##2914][VV##2912:=lq_tmp$x##2917][lq_tmp$x##2894:=InterfaceAdapters.Telegram.Telegram._handleUpdate][lq_tmp$x##2895:=allin##a3cBM]} {lq_tmp$x##2915 : Servant.Client.Internal.HttpClient.ClientM | $k_##2909[VV##2908:=lq_tmp$x##2915][VV##2912:=lq_tmp$x##2917][lq_tmp$x##2894:=InterfaceAdapters.Telegram.Telegram._handleUpdate][lq_tmp$x##2895:=allin##a3cBM]} {lq_tmp$x##2916 : () | $k_##2911[VV##2910:=lq_tmp$x##2916][VV##2912:=lq_tmp$x##2917][lq_tmp$x##2894:=InterfaceAdapters.Telegram.Telegram._handleUpdate][lq_tmp$x##2895:=allin##a3cBM]}) | $k_##2913[VV##2912:=lq_tmp$x##2917][lq_tmp$x##2894:=InterfaceAdapters.Telegram.Telegram._handleUpdate][lq_tmp$x##2895:=allin##a3cBM]}</span><span class='hs-varid'>uncurry</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##2927:Data.Text.Internal.Text -&gt; lq_tmp$x##2928:(GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.Update) -&gt; (Control.Monad.Trans.Reader.ReaderT Web.Telegram.API.Bot.API.Core.Token Servant.Client.Internal.HttpClient.ClientM ())</span><span class='hs-sel'>_handleUpdate</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2935 : (Data.Text.Internal.Text, (GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.Update)) | lq_tmp$x##2935 == allin##a3cBM}</span><span class='hs-varid'>allin</span></a>
<span class=hs-linenum> 85: </span>
<span class=hs-linenum> 86: </span><span class='hs-comment'>{--
  To Do: got to refactor so that end is based on a long space so New York City can come in rightly
  Look into https :// hackage . haskell . org / package / text -1.2 . 4.1 / docs / Data - Text.html #g : 17
--}</span>
<span class=hs-linenum> 90: </span><span class='hs-definition'>gettheTelegram</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Update</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum> 91: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##4461:Web.Telegram.API.Bot.Data.Update -&gt; Data.Text.Internal.Text</span><span class='hs-definition'>gettheTelegram</span></a> <span class='hs-conid'>Update</span> <span class='hs-layout'>{</span><span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>m</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4700:(lq_tmp$x##4699:GHC.Types.Char -&gt; GHC.Types.Bool) -&gt; lq_tmp$x##4701:Data.Text.Internal.Text -&gt; Data.Text.Internal.Text</span><span class='hs-conid'>T.dropWhileEnd</span></a> <a class=annot href="#"><span class=annottext>ds_d3cPg:{VV##4613 : GHC.Types.Char | $k_##4614} -&gt; {lq_tmp$x##4620 : GHC.Types.Bool | lq_tmp$x##4620 &lt;=&gt; ds_d3cPg == ds_d3cPh}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>==</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4608 : GHC.Types.Char | lq_tmp$x##4608 == ((lit "32" Char) : Char)}</span><span class='hs-chr'>' '</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4687 : Data.Text.Internal.Text | (not (isJust lq_anf$##7205759403793558129##d3cT7) =&gt; lq_tmp$x##4687 == lq_anf$##7205759403793558128##d3cT6)
                                            &amp;&amp; $k_##4686[VV##4685:=lq_tmp$x##4687][lq_tmp$x##4683:=lq_anf$##7205759403793558128##d3cT6][lq_tmp$x##4684:=lq_anf$##7205759403793558129##d3cT7]}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fromMaybe</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4661 : Data.Text.Internal.Text | len lq_anf$##7205759403793558127##d3cT5 == stringlen lq_tmp$x##4661
                                            &amp;&amp; lq_anf$##7205759403793558127##d3cT5 ~~ lq_tmp$x##4661}</span><span class='hs-str'>""</span></a> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Data.Text.Internal.Text)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>text</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4675 : Web.Telegram.API.Bot.Data.Message | lq_tmp$x##4675 == m##a3cBN}</span><span class='hs-varid'>m</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 92: </span><span class='hs-definition'>gettheTelegram</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4562 : [{lq_tmp$x##4566 : GHC.Types.Char | $k_##4565[VV##4564:=lq_tmp$x##4566]}]&lt;\lq_tmp$x##4563 VV -&gt; {lq_tmp$x##4566 : GHC.Types.Char | $k_##4568[VV##4567:=lq_tmp$x##4566][lq_tmp$x##4569:=lq_tmp$x##4563]}&gt; | len lq_tmp$x##4562 == 0}</span><span class='hs-str'>""</span></a>
<span class=hs-linenum> 93: </span>
<span class=hs-linenum> 94: </span><span class='hs-definition'>getTelegramUser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Update</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>User</span>
<span class=hs-linenum> 95: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1848:Web.Telegram.API.Bot.Data.Update -&gt; (GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.User)</span><span class='hs-definition'>getTelegramUser</span></a> <span class='hs-conid'>Update</span> <span class='hs-layout'>{</span><span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>m</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1969:Web.Telegram.API.Bot.Data.Message -&gt; (GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.User)</span><span class='hs-varid'>from</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1970 : Web.Telegram.API.Bot.Data.Message | lq_tmp$x##1970 == m##a3cBO}</span><span class='hs-varid'>m</span></a>
<span class=hs-linenum> 96: </span><span class='hs-definition'>getTelegramUser</span> <span class='hs-keyword'>_</span>                         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1947 : (GHC.Maybe.Maybe a) | not (isJust lq_tmp$x##1947)} | VV == GHC.Maybe.Nothing}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum> 97: </span>
<span class=hs-linenum> 98: </span><span class='hs-definition'>getUserId</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>User</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum> 99: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3629:(GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.User) -&gt; Data.Text.Internal.Text</span><span class='hs-definition'>getUserId</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3756:[GHC.Types.Char] -&gt; Data.Text.Internal.Text</span><span class='hs-conid'>T.pack</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3700:GHC.Types.Int -&gt; [GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>user_id</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3710 : Web.Telegram.API.Bot.Data.User | lq_tmp$x##3710 == u##a3cBP}</span><span class='hs-varid'>u</span></a>
<span class=hs-linenum>100: </span><span class='hs-definition'>getUserId</span> <span class='hs-conid'>Nothing</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3645 : [{lq_tmp$x##3649 : GHC.Types.Char | $k_##3648[VV##3647:=lq_tmp$x##3649]}]&lt;\lq_tmp$x##3646 VV -&gt; {lq_tmp$x##3649 : GHC.Types.Char | $k_##3651[VV##3650:=lq_tmp$x##3649][lq_tmp$x##3652:=lq_tmp$x##3646]}&gt; | len lq_tmp$x##3645 == 0}</span><span class='hs-str'>""</span></a>
<span class=hs-linenum>101: </span>
<span class=hs-linenum>102: </span><span class='hs-definition'>getTelegram</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>103: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3517:(GHC.Maybe.Maybe Data.Text.Internal.Text) -&gt; (GHC.Maybe.Maybe Data.Text.Internal.Text)</span><span class='hs-definition'>getTelegram</span></a> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Data.Text.Internal.Text)</span><span class='hs-varid'>tape</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3606:(Data.Either.Either {lq_tmp$x##3617 : [{lq_tmp$x##3614 : GHC.Types.Char | $k_##3608[VV##3607:=lq_tmp$x##3614][VV##3612:=lq_tmp$x##3617]}]&lt;\lq_tmp$x##3615 VV -&gt; {lq_tmp$x##3616 : GHC.Types.Char | $k_##3611[VV##3610:=lq_tmp$x##3616][VV##3612:=lq_tmp$x##3617][lq_tmp$x##3609:=lq_tmp$x##3615]}&gt; | $k_##3613[VV##3612:=lq_tmp$x##3617]} {lq_tmp$x##3620 : Data.Text.Internal.Text | $k_##3619[VV##3618:=lq_tmp$x##3620]}) -&gt; (GHC.Maybe.Maybe {lq_tmp$x##3620 : Data.Text.Internal.Text | $k_##3619[VV##3618:=lq_tmp$x##3620]})</span><span class='hs-varid'>rightToMaybe</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either [GHC.Types.Char] Data.Text.Internal.Text)</span><span class='hs-varid'>eitherDecode</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Lazy.Internal.ByteString</span><span class='hs-layout'>(</span></a><span class='hs-conid'>LB.fromStrict</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-layout'>(</span></a><span class='hs-conid'>T.encodeUtf8</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3564 : Data.Text.Internal.Text | (not (isJust tape##a3cBQ) =&gt; lq_tmp$x##3564 == lq_anf$##7205759403793558083##d3cSn)
                                            &amp;&amp; $k_##3563[VV##3562:=lq_tmp$x##3564][lq_tmp$x##3560:=lq_anf$##7205759403793558083##d3cSn][lq_tmp$x##3561:=tape##a3cBQ]}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fromMaybe</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3545 : Data.Text.Internal.Text | len lq_anf$##7205759403793558082##d3cSm == stringlen lq_tmp$x##3545
                                            &amp;&amp; lq_anf$##7205759403793558082##d3cSm ~~ lq_tmp$x##3545}</span><span class='hs-str'>""</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3567 : (GHC.Maybe.Maybe Data.Text.Internal.Text) | lq_tmp$x##3567 == tape##a3cBQ}</span><span class='hs-varid'>tape</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>104: </span>
<span class=hs-linenum>105: </span><span class='hs-comment'>-- | pushes a message to Telegram Chatid</span>
<span class=hs-linenum>106: </span><span class='hs-sel'>_pushTelegramMsg</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ChatId</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TelegramClient</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>107: </span><a class=annot href="#"><span class=annottext>msg##a3cBR:{VV##2424 : Data.Text.Internal.Text | $k_##2425} -&gt; cid##a3cBS:{VV##2427 : Web.Telegram.API.Bot.Requests.ChatId | $k_##2428} -&gt; {VV##2436 : (Control.Monad.Trans.Reader.ReaderT {VV##2430 : Web.Telegram.API.Bot.API.Core.Token | $k_##2431} {VV##2432 : Servant.Client.Internal.HttpClient.ClientM | $k_##2433} {VV##2434 : () | $k_##2435}) | $k_##2437}</span><span class='hs-sel'>_pushTelegramMsg</span></a> <a class=annot href="#"><span class=annottext>{VV##2424 : Data.Text.Internal.Text | $k_##2425}</span><span class='hs-varid'>msg</span></a> <a class=annot href="#"><span class=annottext>{VV##2427 : Web.Telegram.API.Bot.Requests.ChatId | $k_##2428}</span><span class='hs-varid'>cid</span></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>void</span> <a class=annot href="#"><span class=annottext>(Control.Monad.Trans.Reader.ReaderT Web.Telegram.API.Bot.API.Core.Token Servant.Client.Internal.HttpClient.ClientM (Web.Telegram.API.Bot.Responses.Response Web.Telegram.API.Bot.Data.Message))</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2455:Web.Telegram.API.Bot.Requests.SendMessageRequest -&gt; (Control.Monad.Trans.Reader.ReaderT Web.Telegram.API.Bot.API.Core.Token Servant.Client.Internal.HttpClient.ClientM (Web.Telegram.API.Bot.Responses.Response Web.Telegram.API.Bot.Data.Message))</span><span class='hs-varid'>sendMessageM</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Requests.SendMessageRequest</span><span class='hs-varid'>sendMessageRequest</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2445 : Web.Telegram.API.Bot.Requests.ChatId | lq_tmp$x##2445 == cid##a3cBS
                                                         &amp;&amp; $k_##2428[VV##2427:=lq_tmp$x##2445]}</span><span class='hs-varid'>cid</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2446 : Data.Text.Internal.Text | lq_tmp$x##2446 == msg##a3cBR
                                            &amp;&amp; $k_##2425[VV##2424:=lq_tmp$x##2446]}</span><span class='hs-varid'>msg</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>108: </span>
<span class=hs-linenum>109: </span><span class='hs-sel'>_handleUpdate</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Update</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TelegramClient</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>110: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2489:Data.Text.Internal.Text -&gt; lq_tmp$x##2490:(GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.Update) -&gt; (Control.Monad.Trans.Reader.ReaderT Web.Telegram.API.Bot.API.Core.Token Servant.Client.Internal.HttpClient.ClientM ())</span><span class='hs-sel'>_handleUpdate</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>helper</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-conid'>Update</span> <span class='hs-layout'>{</span><span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>m</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2865:{lq_tmp$x##2857 : Web.Telegram.API.Bot.Requests.ChatId | $k_##2428[VV##2427:=lq_tmp$x##2857][lq_tmp$x##2864:=helper##a3cBT][msg##a3cBR:=helper##a3cBT]} -&gt; {lq_tmp$x##2861 : (Control.Monad.Trans.Reader.ReaderT {lq_tmp$x##2858 : Web.Telegram.API.Bot.API.Core.Token | $k_##2431[VV##2430:=lq_tmp$x##2858][VV##2436:=lq_tmp$x##2861][cid##a3cBS:=lq_tmp$x##2865][lq_tmp$x##2864:=helper##a3cBT][msg##a3cBR:=helper##a3cBT]} {lq_tmp$x##2859 : Servant.Client.Internal.HttpClient.ClientM | $k_##2433[VV##2432:=lq_tmp$x##2859][VV##2436:=lq_tmp$x##2861][cid##a3cBS:=lq_tmp$x##2865][lq_tmp$x##2864:=helper##a3cBT][msg##a3cBR:=helper##a3cBT]} {lq_tmp$x##2860 : () | $k_##2435[VV##2434:=lq_tmp$x##2860][VV##2436:=lq_tmp$x##2861][cid##a3cBS:=lq_tmp$x##2865][lq_tmp$x##2864:=helper##a3cBT][msg##a3cBR:=helper##a3cBT]}) | $k_##2437[VV##2436:=lq_tmp$x##2861][cid##a3cBS:=lq_tmp$x##2865][lq_tmp$x##2864:=helper##a3cBT][msg##a3cBR:=helper##a3cBT]}</span><span class='hs-sel'>_pushTelegramMsg</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2866 : Data.Text.Internal.Text | lq_tmp$x##2866 == helper##a3cBT}</span><span class='hs-varid'>helper</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Requests.ChatId</span><span class='hs-conid'>ChatId</span></a> <a class=annot href="#"><span class=annottext>GHC.Int.Int64</span><span class='hs-layout'>(</span></a><span class='hs-varid'>chat_id</span> <a class=annot href="#"><span class=annottext>Web.Telegram.API.Bot.Data.Chat</span><span class='hs-layout'>(</span></a><span class='hs-varid'>chat</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2842 : Web.Telegram.API.Bot.Data.Message | lq_tmp$x##2842 == m##a3cBU}</span><span class='hs-varid'>m</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>111: </span><span class='hs-sel'>_handleUpdate</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>u</span>                                     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##53:(GHC.Types.IO {lq_tmp$x##2821 : () | $k_##2820[VV##2819:=lq_tmp$x##2821]}) -&gt; (Control.Monad.Trans.Reader.ReaderT Web.Telegram.API.Bot.API.Core.Token Servant.Client.Internal.HttpClient.ClientM {lq_tmp$x##2821 : () | $k_##2820[VV##2819:=lq_tmp$x##2821]})</span><span class='hs-varid'>liftIO</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2794:[GHC.Types.Char] -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>putStrLn</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2725 : [GHC.Types.Char] | len lq_tmp$x##2725 == strLen lq_anf$##7205759403793558025##d3cRr
                                     &amp;&amp; lq_tmp$x##2725 ~~ lq_anf$##7205759403793558025##d3cRr}</span><span class='hs-str'>"Unhandled message: "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2749 : (GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.Update) | lq_tmp$x##2749 == ds_d3cJD}</span><span class='hs-varid'>u</span></a>
<span class=hs-linenum>112: </span>
<span class=hs-linenum>113: </span><span class='hs-definition'>getMeta</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Update</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>T.Text</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-conid'>T.Text</span><span class='hs-layout'>,</span> <span class='hs-conid'>T.Text</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>114: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3768:(GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.Update) -&gt; (Data.Text.Internal.Text, (Data.Text.Internal.Text, Data.Text.Internal.Text))</span><span class='hs-definition'>getMeta</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-conid'>Update</span> <span class='hs-layout'>{</span><span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>m</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##4422:a -&gt; lq_tmp$x##4423:{lq_tmp$x##4414 : b&lt;p2 lq_tmp$x##4422&gt; | true} -&gt; {lq_tmp$x##4419 : (a, b)&lt;\lq_tmp$x##4424 VV -&gt; {lq_tmp$x##4418 : b&lt;p2 lq_tmp$x##4424&gt; | true}&gt; | fst lq_tmp$x##4419 == lq_tmp$x##4422
                                                                                                                                                                                            &amp;&amp; snd lq_tmp$x##4419 == lq_tmp$x##4423
                                                                                                                                                                                            &amp;&amp; x_Tuple21 lq_tmp$x##4419 == lq_tmp$x##4422
                                                                                                                                                                                            &amp;&amp; x_Tuple22 lq_tmp$x##4419 == lq_tmp$x##4423} | VV == GHC.Tuple.(,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4453 : Data.Text.Internal.Text | lq_tmp$x##4453 == uuid##a3cBX}</span><span class='hs-varid'>uuid</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4394 : ({lq_tmp$x##4402 : Data.Text.Internal.Text | $k_##4401[VV##4400:=lq_tmp$x##4402][lq_tmp$x##4397:=whatUserTyped##a3cBY][lq_tmp$x##4398:=parseResponse##a3cBZ]}, {lq_tmp$x##4405 : Data.Text.Internal.Text | $k_##4404[VV##4403:=lq_tmp$x##4405][lq_tmp$x##4397:=whatUserTyped##a3cBY][lq_tmp$x##4398:=parseResponse##a3cBZ]})&lt;\lq_tmp$x##4399 VV -&gt; {lq_tmp$x##4405 : Data.Text.Internal.Text | $k_##4407[VV##4406:=lq_tmp$x##4405][lq_tmp$x##4397:=whatUserTyped##a3cBY][lq_tmp$x##4398:=parseResponse##a3cBZ][lq_tmp$x##4408:=lq_tmp$x##4399]}&gt; | fst lq_tmp$x##4394 == whatUserTyped##a3cBY
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &amp;&amp; snd lq_tmp$x##4394 == parseResponse##a3cBZ
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &amp;&amp; x_Tuple21 lq_tmp$x##4394 == whatUserTyped##a3cBY
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &amp;&amp; x_Tuple22 lq_tmp$x##4394 == parseResponse##a3cBZ}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4410 : Data.Text.Internal.Text | lq_tmp$x##4410 == whatUserTyped##a3cBY}</span><span class='hs-varid'>whatUserTyped</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4411 : Data.Text.Internal.Text | lq_tmp$x##4411 == parseResponse##a3cBZ}</span><span class='hs-varid'>parseResponse</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>115: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>116: </span>    <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>uuid</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>getUserId</span></a> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Web.Telegram.API.Bot.Data.User)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>from</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4368 : Web.Telegram.API.Bot.Data.Message | lq_tmp$x##4368 == m##a3cBW}</span><span class='hs-varid'>m</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>117: </span>    <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>whatUserTyped</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4360:Data.Text.Internal.Text -&gt; Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.dropWhileEnd</span></a> <a class=annot href="#"><span class=annottext>ds_d3cNN:{VV##4262 : GHC.Types.Char | $k_##4263} -&gt; {lq_tmp$x##4269 : GHC.Types.Bool | lq_tmp$x##4269 &lt;=&gt; ds_d3cNN == ds_d3cNO}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4257 : GHC.Types.Char | lq_tmp$x##4257 == ((lit "32" Char) : Char)}</span><span class='hs-chr'>' '</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4336 : Data.Text.Internal.Text | (not (isJust lq_anf$##7205759403793558118##d3cSW) =&gt; lq_tmp$x##4336 == lq_anf$##7205759403793558117##d3cSV)
                                            &amp;&amp; $k_##4335[VV##4334:=lq_tmp$x##4336][lq_tmp$x##4332:=lq_anf$##7205759403793558117##d3cSV][lq_tmp$x##4333:=lq_anf$##7205759403793558118##d3cSW]}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fromMaybe</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4310 : Data.Text.Internal.Text | len lq_anf$##7205759403793558116##d3cSU == stringlen lq_tmp$x##4310
                                            &amp;&amp; lq_anf$##7205759403793558116##d3cSU ~~ lq_tmp$x##4310}</span><span class='hs-str'>""</span></a> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Data.Text.Internal.Text)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>text</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4324 : Web.Telegram.API.Bot.Data.Message | lq_tmp$x##4324 == m##a3cBW}</span><span class='hs-varid'>m</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>118: </span>    <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>parseResponse</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>parseGetResponse</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4385 : Data.Text.Internal.Text | lq_tmp$x##4385 == whatUserTyped##a3cBY}</span><span class='hs-varid'>whatUserTyped</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4386 : Data.Text.Internal.Text | lq_tmp$x##4386 == uuid##a3cBX}</span><span class='hs-varid'>uuid</span></a>
<span class=hs-linenum>119: </span><span class='hs-definition'>getMeta</span> <span class='hs-conid'>Nothing</span>                          <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##3920:a -&gt; lq_tmp$x##3921:{lq_tmp$x##3912 : b&lt;p2 lq_tmp$x##3920&gt; | true} -&gt; {lq_tmp$x##3917 : (a, b)&lt;\lq_tmp$x##3922 VV -&gt; {lq_tmp$x##3916 : b&lt;p2 lq_tmp$x##3922&gt; | true}&gt; | fst lq_tmp$x##3917 == lq_tmp$x##3920
                                                                                                                                                                                            &amp;&amp; snd lq_tmp$x##3917 == lq_tmp$x##3921
                                                                                                                                                                                            &amp;&amp; x_Tuple21 lq_tmp$x##3917 == lq_tmp$x##3920
                                                                                                                                                                                            &amp;&amp; x_Tuple22 lq_tmp$x##3917 == lq_tmp$x##3921} | VV == GHC.Tuple.(,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3809 : Data.Text.Internal.Text | len lq_anf$##7205759403793558094##d3cSy == stringlen lq_tmp$x##3809
                                            &amp;&amp; lq_anf$##7205759403793558094##d3cSy ~~ lq_tmp$x##3809}</span><span class='hs-str'>"getMeta no data"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3892 : ({lq_tmp$x##3900 : Data.Text.Internal.Text | $k_##3899[VV##3898:=lq_tmp$x##3900][lq_tmp$x##3895:=lq_anf$##7205759403793558098##d3cSC][lq_tmp$x##3896:=lq_anf$##7205759403793558101##d3cSF]}, {lq_tmp$x##3903 : Data.Text.Internal.Text | $k_##3902[VV##3901:=lq_tmp$x##3903][lq_tmp$x##3895:=lq_anf$##7205759403793558098##d3cSC][lq_tmp$x##3896:=lq_anf$##7205759403793558101##d3cSF]})&lt;\lq_tmp$x##3897 VV -&gt; {lq_tmp$x##3903 : Data.Text.Internal.Text | $k_##3905[VV##3904:=lq_tmp$x##3903][lq_tmp$x##3895:=lq_anf$##7205759403793558098##d3cSC][lq_tmp$x##3896:=lq_anf$##7205759403793558101##d3cSF][lq_tmp$x##3906:=lq_tmp$x##3897]}&gt; | fst lq_tmp$x##3892 == lq_anf$##7205759403793558098##d3cSC
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; snd lq_tmp$x##3892 == lq_anf$##7205759403793558101##d3cSF
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; x_Tuple21 lq_tmp$x##3892 == lq_anf$##7205759403793558098##d3cSC
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; x_Tuple22 lq_tmp$x##3892 == lq_anf$##7205759403793558101##d3cSF}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3843 : Data.Text.Internal.Text | len lq_anf$##7205759403793558097##d3cSB == stringlen lq_tmp$x##3843
                                            &amp;&amp; lq_anf$##7205759403793558097##d3cSB ~~ lq_tmp$x##3843}</span><span class='hs-str'>"usertyped missing"</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3877 : Data.Text.Internal.Text | len lq_anf$##7205759403793558100##d3cSE == stringlen lq_tmp$x##3877
                                            &amp;&amp; lq_anf$##7205759403793558100##d3cSE ~~ lq_tmp$x##3877}</span><span class='hs-str'>"so no response"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>120: </span><span class='hs-definition'>getMeta</span> <span class='hs-keyword'>_</span>                                <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##4204:a -&gt; lq_tmp$x##4205:{lq_tmp$x##4196 : b&lt;p2 lq_tmp$x##4204&gt; | true} -&gt; {lq_tmp$x##4201 : (a, b)&lt;\lq_tmp$x##4206 VV -&gt; {lq_tmp$x##4200 : b&lt;p2 lq_tmp$x##4206&gt; | true}&gt; | fst lq_tmp$x##4201 == lq_tmp$x##4204
                                                                                                                                                                                            &amp;&amp; snd lq_tmp$x##4201 == lq_tmp$x##4205
                                                                                                                                                                                            &amp;&amp; x_Tuple21 lq_tmp$x##4201 == lq_tmp$x##4204
                                                                                                                                                                                            &amp;&amp; x_Tuple22 lq_tmp$x##4201 == lq_tmp$x##4205} | VV == GHC.Tuple.(,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4093 : Data.Text.Internal.Text | len lq_anf$##7205759403793558106##d3cSK == stringlen lq_tmp$x##4093
                                            &amp;&amp; lq_anf$##7205759403793558106##d3cSK ~~ lq_tmp$x##4093}</span><span class='hs-str'>"getMeta unkwown error"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4176 : ({lq_tmp$x##4184 : Data.Text.Internal.Text | $k_##4183[VV##4182:=lq_tmp$x##4184][lq_tmp$x##4179:=lq_anf$##7205759403793558110##d3cSO][lq_tmp$x##4180:=lq_anf$##7205759403793558113##d3cSR]}, {lq_tmp$x##4187 : Data.Text.Internal.Text | $k_##4186[VV##4185:=lq_tmp$x##4187][lq_tmp$x##4179:=lq_anf$##7205759403793558110##d3cSO][lq_tmp$x##4180:=lq_anf$##7205759403793558113##d3cSR]})&lt;\lq_tmp$x##4181 VV -&gt; {lq_tmp$x##4187 : Data.Text.Internal.Text | $k_##4189[VV##4188:=lq_tmp$x##4187][lq_tmp$x##4179:=lq_anf$##7205759403793558110##d3cSO][lq_tmp$x##4180:=lq_anf$##7205759403793558113##d3cSR][lq_tmp$x##4190:=lq_tmp$x##4181]}&gt; | fst lq_tmp$x##4176 == lq_anf$##7205759403793558110##d3cSO
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; snd lq_tmp$x##4176 == lq_anf$##7205759403793558113##d3cSR
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; x_Tuple21 lq_tmp$x##4176 == lq_anf$##7205759403793558110##d3cSO
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; x_Tuple22 lq_tmp$x##4176 == lq_anf$##7205759403793558113##d3cSR}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4127 : Data.Text.Internal.Text | len lq_anf$##7205759403793558109##d3cSN == stringlen lq_tmp$x##4127
                                            &amp;&amp; lq_anf$##7205759403793558109##d3cSN ~~ lq_tmp$x##4127}</span><span class='hs-str'>"usertyped bad"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4161 : Data.Text.Internal.Text | len lq_anf$##7205759403793558112##d3cSQ == stringlen lq_tmp$x##4161
                                            &amp;&amp; lq_anf$##7205759403793558112##d3cSQ ~~ lq_tmp$x##4161}</span><span class='hs-str'>"so no response"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>121: </span>
<span class=hs-linenum>122: </span><span class='hs-definition'>parseGetResponse</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>123: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2969:Data.Text.Internal.Text -&gt; lq_tmp$x##2970:Data.Text.Internal.Text -&gt; Data.Text.Internal.Text</span><span class='hs-definition'>parseGetResponse</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>whatUserTyped</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>uuid</span></a>
<span class=hs-linenum>124: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3066 : Data.Text.Internal.Text | len lq_anf$##7205759403793558041##d3cRH == stringlen lq_tmp$x##3066
                                            &amp;&amp; lq_anf$##7205759403793558041##d3cRH ~~ lq_tmp$x##3066}</span><span class='hs-str'>"/start"</span></a> <span class='hs-varop'>`T.isPrefixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3083 : Data.Text.Internal.Text | lq_tmp$x##3083 == whatUserTyped##a3cC0}</span><span class='hs-varid'>whatUserTyped</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3110 : Data.Text.Internal.Text | len lq_anf$##7205759403793558045##d3cRL == stringlen lq_tmp$x##3110
                                            &amp;&amp; lq_anf$##7205759403793558045##d3cRL ~~ lq_tmp$x##3110}</span><span class='hs-str'>"?"</span></a> <span class='hs-varop'>`T.isPrefixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3127 : Data.Text.Internal.Text | lq_tmp$x##3127 == whatUserTyped##a3cC0}</span><span class='hs-varid'>whatUserTyped</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3154 : Data.Text.Internal.Text | len lq_anf$##7205759403793558049##d3cRP == stringlen lq_tmp$x##3154
                                            &amp;&amp; lq_anf$##7205759403793558049##d3cRP ~~ lq_tmp$x##3154}</span><span class='hs-str'>"/help"</span></a> <span class='hs-varop'>`T.isPrefixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3171 : Data.Text.Internal.Text | lq_tmp$x##3171 == whatUserTyped##a3cC0}</span><span class='hs-varid'>whatUserTyped</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3198 : Data.Text.Internal.Text | len lq_anf$##7205759403793558053##d3cRT == stringlen lq_tmp$x##3198
                                            &amp;&amp; lq_anf$##7205759403793558053##d3cRT ~~ lq_tmp$x##3198}</span><span class='hs-str'>"help"</span></a> <span class='hs-varop'>`T.isPrefixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3215 : Data.Text.Internal.Text | lq_tmp$x##3215 == whatUserTyped##a3cC0}</span><span class='hs-varid'>whatUserTyped</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3514 : Data.Text.Internal.Text | lq_tmp$x##3514 == hlpMessage##a3cC2
                                            &amp;&amp; len lq_anf$##7205759403793558039##d3cRF == stringlen lq_tmp$x##3514
                                            &amp;&amp; lq_anf$##7205759403793558039##d3cRF ~~ lq_tmp$x##3514}</span><span class='hs-varid'>hlpMessage</span></a>
<span class=hs-linenum>125: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3279 : Data.Text.Internal.Text | len lq_anf$##7205759403793558061##d3cS1 == stringlen lq_tmp$x##3279
                                            &amp;&amp; lq_anf$##7205759403793558061##d3cS1 ~~ lq_tmp$x##3279}</span><span class='hs-str'>"/prefs"</span></a> <span class='hs-varop'>`T.isPrefixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3296 : Data.Text.Internal.Text | lq_tmp$x##3296 == whatUserTyped##a3cC0}</span><span class='hs-varid'>whatUserTyped</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3508 : Data.Text.Internal.Text | lq_tmp$x##3508 == prfsMessage##a3cC3}</span><span class='hs-varid'>prfsMessage</span></a>
<span class=hs-linenum>126: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3330 : Data.Text.Internal.Text | len lq_anf$##7205759403793558066##d3cS6 == stringlen lq_tmp$x##3330
                                            &amp;&amp; lq_anf$##7205759403793558066##d3cS6 ~~ lq_tmp$x##3330}</span><span class='hs-str'>"/"</span></a> <span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3347 : Data.Text.Internal.Text | lq_tmp$x##3347 == whatUserTyped##a3cC0}</span><span class='hs-varid'>whatUserTyped</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3374 : Data.Text.Internal.Text | len lq_anf$##7205759403793558070##d3cSa == stringlen lq_tmp$x##3374
                                            &amp;&amp; lq_anf$##7205759403793558070##d3cSa ~~ lq_tmp$x##3374}</span><span class='hs-str'>"*"</span></a> <span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3391 : Data.Text.Internal.Text | lq_tmp$x##3391 == whatUserTyped##a3cC0}</span><span class='hs-varid'>whatUserTyped</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3418 : Data.Text.Internal.Text | len lq_anf$##7205759403793558074##d3cSe == stringlen lq_tmp$x##3418
                                            &amp;&amp; lq_anf$##7205759403793558074##d3cSe ~~ lq_tmp$x##3418}</span><span class='hs-str'>"-"</span></a> <span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3435 : Data.Text.Internal.Text | lq_tmp$x##3435 == whatUserTyped##a3cC0}</span><span class='hs-varid'>whatUserTyped</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3476 : [GHC.Types.Char] | len lq_tmp$x##3476 == strLen lq_anf$##7205759403793558080##d3cSk
                                     &amp;&amp; lq_tmp$x##3476 ~~ lq_anf$##7205759403793558080##d3cSk}</span><span class='hs-str'>"\nPlace Name seems odd\n"</span></a>
<span class=hs-linenum>127: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3464 : Data.Text.Internal.Text | lq_tmp$x##3464 == whatUserTyped##a3cC0}</span><span class='hs-varid'>whatUserTyped</span></a>
<span class=hs-linenum>128: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>129: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##3032 : Data.Text.Internal.Text | len lq_anf$##7205759403793558039##d3cRF == stringlen lq_tmp$x##3032
                                            &amp;&amp; lq_anf$##7205759403793558039##d3cRF ~~ lq_tmp$x##3032}</span><span class='hs-varid'>hlpMessage</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3013 : [GHC.Types.Char] | len lq_tmp$x##3013 == strLen lq_anf$##7205759403793558038##d3cRE
                                     &amp;&amp; lq_tmp$x##3013 ~~ lq_anf$##7205759403793558038##d3cRE}</span><span class='hs-str'>"Hi! I am @MaximumCityBot \nEnter a place name For ex: \nMumbai, \nPune \nMaharashtra \nBhivandi\n "</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>130: </span>    <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>prfsMessage</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>parsePrefs</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3004 : Data.Text.Internal.Text | lq_tmp$x##3004 == uuid##a3cC1}</span><span class='hs-varid'>uuid</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2994:Data.Text.Internal.Text -&gt; Data.Text.Internal.Text</span><span class='hs-conid'>T.strip</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.drop</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2976 : GHC.Types.Int | lq_tmp$x##2976 == (lq_anf$##7205759403793558034##d3cRA : int)}</span><span class='hs-num'>6</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2989 : Data.Text.Internal.Text | lq_tmp$x##2989 == whatUserTyped##a3cC0}</span><span class='hs-varid'>whatUserTyped</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-- over at @module Preferences</span></pre>
</body>
</html>