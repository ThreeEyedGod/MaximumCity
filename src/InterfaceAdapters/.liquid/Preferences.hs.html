<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/InterfaceAdapters/Preferences.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE TypeInType, StandaloneDeriving #-}</span></a>
<span class=hs-linenum>  2: </span><span class='hs-comment'>{-# LANGUAGE TemplateHaskell, LambdaCase, BlockArguments, GADTs, FlexibleContexts, TypeOperators, ScopedTypeVariables #-}</span>
<span class=hs-linenum>  3: </span><span class='hs-comment'>{-# LANGUAGE DeriveAnyClass #-}</span>
<span class=hs-linenum>  4: </span><span class='hs-comment'>{-# LANGUAGE DeriveGeneric #-}</span>
<span class=hs-linenum>  5: </span>
<span class=hs-linenum>  6: </span>
<span class=hs-linenum>  7: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>InterfaceAdapters.Preferences</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  8: </span>
<span class=hs-linenum>  9: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Polysemy</span>
<span class=hs-linenum> 11: </span>    <span class='hs-layout'>(</span> <span class='hs-conid'>Sem</span><span class='hs-layout'>,</span> <span class='hs-conid'>Member</span><span class='hs-layout'>,</span> <span class='hs-conid'>Embed</span><span class='hs-layout'>,</span> <span class='hs-varid'>embed</span><span class='hs-layout'>,</span> <span class='hs-varid'>runM</span><span class='hs-layout'>,</span> <span class='hs-varid'>interpret</span><span class='hs-layout'>,</span> <span class='hs-varid'>makeSem</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 12: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Function</span>             <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>&amp;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 13: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Parameters.KVS</span> <span class='hs-layout'>(</span> <span class='hs-varid'>getKvs</span><span class='hs-layout'>,</span> <span class='hs-varid'>insertKvs</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 14: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Parameters.KVSAWSSSMParmStore</span>
<span class=hs-linenum> 15: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>runKvsAsAWSSSMParmStore</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 16: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Utils.Helper</span> <span class='hs-layout'>(</span> <span class='hs-varid'>logMessage</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 17: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text</span> <span class='hs-layout'>(</span><span class='hs-conid'>Text</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<span class=hs-linenum> 19: </span>    <span class='hs-layout'>(</span> <span class='hs-conid'>Text</span><span class='hs-layout'>,</span> <span class='hs-varid'>pack</span><span class='hs-layout'>,</span> <span class='hs-varid'>words</span><span class='hs-layout'>,</span> <span class='hs-varid'>isInfixOf</span><span class='hs-layout'>,</span> <span class='hs-varid'>null</span><span class='hs-layout'>,</span> <span class='hs-varid'>toLower</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 20: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text.Encoding</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span> <span class='hs-layout'>(</span><span class='hs-varid'>encodeUtf8</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 21: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text.Manipulate</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>DTM</span>
<span class=hs-linenum> 22: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Sort</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>DS</span>
<span class=hs-linenum> 23: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Ord</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>O</span>
<span class=hs-linenum> 24: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>InterfaceAdapters.Parameters.Types</span>
<span class=hs-linenum> 25: </span>    <span class='hs-layout'>(</span> <span class='hs-conid'>ParameterName</span><span class='hs-layout'>,</span> <span class='hs-conid'>ParameterValue</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 26: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Amazonka.SSM</span> <span class='hs-layout'>(</span><span class='hs-conid'>ParameterTier</span><span class='hs-layout'>(</span><span class='hs-conid'>ParameterTier_Advanced</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 27: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>cast</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 28: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Amazonka</span> <span class='hs-layout'>(</span><span class='hs-conid'>FromJSON</span><span class='hs-layout'>,</span> <span class='hs-conid'>ToJSON</span><span class='hs-layout'>,</span> <span class='hs-varid'>eitherDecode</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 29: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Amazonka.Prelude</span> <span class='hs-layout'>(</span><span class='hs-conid'>Generic</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 30: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.ByteString.Lazy</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TL</span>
<span class=hs-linenum> 31: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Aeson</span> <span class='hs-layout'>(</span><span class='hs-varid'>eitherDecodeStrict</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 32: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>GHC.IO.Encoding</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<span class=hs-linenum> 33: </span>
<span class=hs-linenum> 34: </span><a class=annot href="#"><span class=annottext>forall a .
InterfaceAdapters.Preferences.Preferences -&gt; (GHC.Generics.Rep InterfaceAdapters.Preferences.Preferences a)</span><span class='hs-keyword'>data</span></a> <span class='hs-conid'>Preferences</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Preferences</span> <span class='hs-layout'>{</span>
<span class=hs-linenum> 35: </span>  <span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Agdata</span>
<span class=hs-linenum> 36: </span><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Datasize</span>
<span class=hs-linenum> 37: </span><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Timespan</span>
<span class=hs-linenum> 38: </span><span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Generics.Generic InterfaceAdapters.Preferences.Preferences)</span><span class='hs-conid'>Generic</span></a><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 39: </span>
<span class=hs-linenum> 40: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>(Data.Aeson.Types.FromJSON.FromJSON InterfaceAdapters.Preferences.Preferences)</span><span class='hs-conid'>FromJSON</span></a> <span class='hs-conid'>Preferences</span>
<span class=hs-linenum> 41: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>(Data.Aeson.Types.ToJSON.ToJSON InterfaceAdapters.Preferences.Preferences)</span><span class='hs-conid'>ToJSON</span></a> <span class='hs-conid'>Preferences</span>
<span class=hs-linenum> 42: </span>
<span class=hs-linenum> 43: </span><a class=annot href="#"><span class=annottext>forall a .
InterfaceAdapters.Preferences.Agdata -&gt; (GHC.Generics.Rep InterfaceAdapters.Preferences.Agdata a)</span><span class='hs-keyword'>data</span></a> <span class='hs-conid'>Agdata</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Weather</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>WaterLevels</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>WeatherWaterLevels</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Monsoon</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>All</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Generics.Generic InterfaceAdapters.Preferences.Agdata)</span><span class='hs-conid'>Generic</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Data.Aeson.Types.FromJSON.FromJSON InterfaceAdapters.Preferences.Agdata)</span><span class='hs-conid'>FromJSON</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Data.Aeson.Types.ToJSON.ToJSON InterfaceAdapters.Preferences.Agdata)</span><span class='hs-conid'>ToJSON</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 44: </span><a class=annot href="#"><span class=annottext>forall a .
InterfaceAdapters.Preferences.Datasize -&gt; (GHC.Generics.Rep InterfaceAdapters.Preferences.Datasize a)</span><span class='hs-keyword'>data</span></a> <span class='hs-conid'>Datasize</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mini</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Standard</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Detailed</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Generics.Generic InterfaceAdapters.Preferences.Datasize)</span><span class='hs-conid'>Generic</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Data.Aeson.Types.FromJSON.FromJSON InterfaceAdapters.Preferences.Datasize)</span><span class='hs-conid'>FromJSON</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Data.Aeson.Types.ToJSON.ToJSON InterfaceAdapters.Preferences.Datasize)</span><span class='hs-conid'>ToJSON</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 45: </span><a class=annot href="#"><span class=annottext>forall a .
InterfaceAdapters.Preferences.Timespan -&gt; (GHC.Generics.Rep InterfaceAdapters.Preferences.Timespan a)</span><span class='hs-keyword'>data</span></a> <span class='hs-conid'>Timespan</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RightNow</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Alerts</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>NearForecast</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>LongRange</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Generics.Generic InterfaceAdapters.Preferences.Timespan)</span><span class='hs-conid'>Generic</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Data.Aeson.Types.FromJSON.FromJSON InterfaceAdapters.Preferences.Timespan)</span><span class='hs-conid'>FromJSON</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Data.Aeson.Types.ToJSON.ToJSON InterfaceAdapters.Preferences.Timespan)</span><span class='hs-conid'>ToJSON</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 46: </span>
<span class=hs-linenum> 47: </span><span class='hs-definition'>modalUser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Text</span>
<span class=hs-linenum> 48: </span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-definition'>modalUser</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-str'>""</span>
<span class=hs-linenum> 49: </span>
<span class=hs-linenum> 50: </span><span class='hs-definition'>runGetParm</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ParameterName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Text</span>
<span class=hs-linenum> 51: </span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-definition'>runGetParm</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>key</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 52: </span>  <span class='hs-varid'>getKvs</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == key}</span><span class='hs-varid'>key</span></a>
<span class=hs-linenum> 53: </span>  <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (InterfaceAdapters.Parameters.KVS.KVS ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) Data.Text.Internal.Text Data.Text.Internal.Text) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))) Data.Text.Internal.Text) -&gt; (Polysemy.Internal.Sem (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) Data.Text.Internal.Text)</span><span class='hs-varid'>runKvsAsAWSSSMParmStore</span></a>
<span class=hs-linenum> 54: </span>  <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)))) Data.Text.Internal.Text) -&gt; (GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-varid'>runM</span></a>
<span class=hs-linenum> 55: </span>
<span class=hs-linenum> 56: </span><span class='hs-definition'>runSetParm</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ParameterName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ParameterValue</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 57: </span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; Data.Text.Internal.Text -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>runSetParm</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>key</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>val</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 58: </span>  <span class='hs-varid'>insertKvs</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == key}</span><span class='hs-varid'>key</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == val}</span><span class='hs-varid'>val</span></a>
<span class=hs-linenum> 59: </span>  <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (InterfaceAdapters.Parameters.KVS.KVS ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) Data.Text.Internal.Text Data.Text.Internal.Text) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))) ()) -&gt; (Polysemy.Internal.Sem (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) ())</span><span class='hs-varid'>runKvsAsAWSSSMParmStore</span></a>
<span class=hs-linenum> 60: </span>  <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)))) ()) -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>runM</span></a>
<span class=hs-linenum> 61: </span>
<span class=hs-linenum> 62: </span><span class='hs-definition'>setPreferences</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 63: </span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; Data.Text.Internal.Text -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>setPreferences</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>runSetParm</span>
<span class=hs-linenum> 64: </span>
<span class=hs-linenum> 65: </span><span class='hs-definition'>getPreferences</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Preferences</span>
<span class=hs-linenum> 66: </span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; (GHC.Types.IO InterfaceAdapters.Preferences.Preferences)</span><span class='hs-definition'>getPreferences</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>user_id</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 67: </span>  <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO Data.Text.Internal.Text)</span><span class='hs-varid'>runGetParm</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == user_id}</span><span class='hs-varid'>user_id</span></a>
<span class=hs-linenum> 68: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Aeson.Types.FromJSON.FromJSON InterfaceAdapters.Preferences.Preferences)</span><span class='hs-varid'>eitherDecodeStrict</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-conid'>T.encodeUtf8</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>String</span> <span class='hs-conid'>Preferences</span>
<span class=hs-linenum> 69: </span>  <span class='hs-keyword'>case</span> <span class='hs-varid'>y</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 70: </span>    <span class='hs-conid'>Left</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 71: </span>        <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>logMessage</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"No Preferences for user id. Getting one for modal user"</span></a>
<span class=hs-linenum> 72: </span>        <a class=annot href="#"><span class=annottext>(GHC.Types.IO InterfaceAdapters.Preferences.Preferences)</span><span class='hs-varid'>return</span></a> <a class=annot href="#"><span class=annottext>InterfaceAdapters.Preferences.Preferences</span><span class='hs-conid'>Preferences</span></a> <span class='hs-layout'>{</span><span class='hs-varid'>userdata</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : InterfaceAdapters.Preferences.Agdata | v == Weather}</span><span class='hs-conid'>Weather</span></a><span class='hs-layout'>,</span> <span class='hs-varid'>usersize</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : InterfaceAdapters.Preferences.Datasize | v == Mini}</span><span class='hs-conid'>Mini</span></a><span class='hs-layout'>,</span> <span class='hs-varid'>usertimespan</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : InterfaceAdapters.Preferences.Timespan | v == NearForecast}</span><span class='hs-conid'>NearForecast</span></a><span class='hs-layout'>}</span>
<span class=hs-linenum> 73: </span>    <span class='hs-conid'>Right</span> <span class='hs-varid'>prefs</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Monad GHC.Types.IO) | v == $fMonadIO}</span><span class='hs-varid'>return</span></a> <a class=annot href="#"><span class=annottext>{v : InterfaceAdapters.Preferences.Preferences | v == prefs}</span><span class='hs-varid'>prefs</span></a>
<span class=hs-linenum> 74: </span>
<span class=hs-linenum> 75: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>MyPreferences</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 76: </span>  <span class='hs-conid'>ReadPrefs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MyPreferences</span> <span class='hs-varid'>m</span> <span class='hs-conid'>Preferences</span>
<span class=hs-linenum> 77: </span>  <span class='hs-conid'>SetPrefs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MyPreferences</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 78: </span>
<span class=hs-linenum> 79: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.(%,%)&lt;[]&gt; ((Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (InterfaceAdapters.Preferences.MyPreferences (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) a), (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (InterfaceAdapters.Preferences.MyPreferences (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) a) '())) (Polysemy.Internal.CustomErrors.Redefined.IfStuck () GHC.Types.Constraint (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (InterfaceAdapters.Preferences.MyPreferences (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) a) (Polysemy.Internal.CustomErrors.Redefined.IfStuck [((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)] GHC.Types.Constraint a (Polysemy.Internal.CustomErrors.AmbiguousSendError GHC.Types.Constraint 'Polysemy.Internal.CustomErrors.TyVarR a (InterfaceAdapters.Preferences.MyPreferences (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (Fcf.Combinators.Pure GHC.Types.Constraint (Polysemy.Internal.CustomErrors.AmbiguousSendError GHC.Types.Constraint (Polysemy.Internal.CustomErrors.UnstuckRState a) a (InterfaceAdapters.Preferences.MyPreferences (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))) (Fcf.Combinators.Pure GHC.Types.Constraint ()))) =&gt;
[GHC.Types.Char] -&gt; [GHC.Types.Char] -&gt; (Polysemy.Internal.Sem a ())</span><span class='hs-definition'>makeSem</span></a> <span class='hs-chr'>'</span><span class='hs-chr'>'</span><span class='hs-conid'>MyPreferences</span>
<span class=hs-linenum> 80: </span>
<span class=hs-linenum> 81: </span><span class='hs-definition'>runprefsToIO</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Member</span> <span class='hs-layout'>(</span><span class='hs-conid'>Embed</span> <span class='hs-conid'>IO</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-layout'>(</span><span class='hs-conid'>MyPreferences</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sem</span> <span class='hs-varid'>r</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 82: </span><a class=annot href="#"><span class=annottext>forall a b .
(GHC.Classes.(%,%)&lt;[]&gt; (Polysemy.Internal.Union.Find ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a) (GHC.Types.~ () (Polysemy.Internal.Union.LocateEffect ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) a) '())) =&gt;
(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (InterfaceAdapters.Preferences.MyPreferences ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) a) b) -&gt; (Polysemy.Internal.Sem a b)</span><span class='hs-definition'>runprefsToIO</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>interpret</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Prim.Addr# | v == "src/InterfaceAdapters/Preferences.hs:82:27-87|lambda"}</span><span class='hs-layout'>(</span></a></span><span class=hs-error><span class='hs-keyglyph'>\</span></span><span class=hs-error><span class='hs-layout'>(</span></span><span class=hs-error><span class='hs-conid'>ReadPrefs</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>userId</span></span><span class=hs-error><span class='hs-layout'>)</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-keyglyph'>-&gt;</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem a InterfaceAdapters.Preferences.Preferences)</span><span class='hs-varid'>embed</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>(GHC.Types.IO InterfaceAdapters.Preferences.Preferences)</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; (GHC.Types.IO InterfaceAdapters.Preferences.Preferences)</span><span class='hs-varid'>getPreferences</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>$</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.pack</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | v == userId
                        &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>userId</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class=hs-error><span class='hs-layout'>)</span></span>
<span class=hs-linenum> 83: </span>
<span class=hs-linenum> 84: </span><span class='hs-definition'>runGetPrefs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Preferences</span>
<span class=hs-linenum> 85: </span><a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; (GHC.Types.IO InterfaceAdapters.Preferences.Preferences)</span><span class='hs-definition'>runGetPrefs</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>userid</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 86: </span>  <span class='hs-varid'>readPrefs</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | v == userid
                        &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>userid</span></a>
<span class=hs-linenum> 87: </span>  <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (InterfaceAdapters.Preferences.MyPreferences ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))))) InterfaceAdapters.Preferences.Preferences) -&gt; (Polysemy.Internal.Sem (': ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] ((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep))) InterfaceAdapters.Preferences.Preferences)</span><span class='hs-varid'>runprefsToIO</span></a>
<span class=hs-linenum> 88: </span>  <span class='hs-varop'>&amp;</span> <a class=annot href="#"><span class=annottext>(Polysemy.Internal.Sem (': (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) (Polysemy.Embed.Type.Embed GHC.Types.IO) ('[] (((TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)) -&gt; (TYPE 'GHC.Types.LiftedRep) -&gt; (TYPE 'GHC.Types.LiftedRep)))) InterfaceAdapters.Preferences.Preferences) -&gt; (GHC.Types.IO InterfaceAdapters.Preferences.Preferences)</span><span class='hs-varid'>runM</span></a>
<span class=hs-linenum> 89: </span>
<span class=hs-linenum> 90: </span><span class='hs-definition'>parsePrefs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum> 91: </span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; Data.Text.Internal.Text -&gt; Data.Text.Internal.Text</span><span class='hs-definition'>parsePrefs</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>uuid</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>prefsText</span></a>
<span class=hs-linenum> 92: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>somePrefs</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 93: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Bool] | len v == len listPrefs}</span><span class='hs-varid'>allPrefsvalid</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; GHC.Types.Bool</span><span class='hs-conid'>Prelude.map</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == allPossiblePrefs}</span><span class='hs-varid'>allPossiblePrefs</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [Data.Text.Internal.Text] | v == listPrefs
                                 &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>listPrefs</span></a>
<span class=hs-linenum> 94: </span>    <span class='hs-keyword'>let</span> <span class='hs-varid'>allPrefsOK</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>and</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Bool] | v == allPrefsvalid
                        &amp;&amp; len v == len listPrefs
                        &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>allPrefsvalid</span></a>
<span class=hs-linenum> 95: </span>    <span class='hs-keyword'>if</span> <span class='hs-varid'>allPrefsOK</span>
<span class=hs-linenum> 96: </span>      <span class='hs-keyword'>then</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 97: </span>        <span class='hs-varid'>createPrefsJSON</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == prefsText}</span><span class='hs-varid'>prefsText</span></a>
<span class=hs-linenum> 98: </span>      <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == allPossiblePrefs}</span><span class='hs-varid'>allPossiblePrefs</span></a>
<span class=hs-linenum> 99: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == allPossiblePrefs}</span><span class='hs-varid'>allPossiblePrefs</span></a>
<span class=hs-linenum>100: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>101: </span>    <span class='hs-varid'>somePrefs</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Bool -&gt; {v : GHC.Types.Bool | v &lt;=&gt; not x1}</span><span class='hs-varid'>not</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-conid'>T.null</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == prefsText}</span><span class='hs-varid'>prefsText</span></a>
<span class=hs-linenum>102: </span>    <a class=annot href="#"><span class=annottext>[Data.Text.Internal.Text]</span><span class='hs-varid'>listPrefs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; [Data.Text.Internal.Text]</span><span class='hs-conid'>DTM.splitWords</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == prefsText}</span><span class='hs-varid'>prefsText</span></a>
<span class=hs-linenum>103: </span>    <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>allPossiblePrefs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"Weather | WaterLevels | WeatherWaterLevels | Monsoon | All ||| Mini | Standard | Detailed ||| RightNow | Alerts | NearForecast | LongRange"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>104: </span>    <span class='hs-varid'>textPrefsJSON</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>createPrefsJSON</span> <span class='hs-varid'>prefsText</span>
<span class=hs-linenum>105: </span>
<span class=hs-linenum>106: </span><span class='hs-comment'>-- {"userdata":"Weather", "usersize": "Mini","usertimespan":"NearForecast"}</span>
<span class=hs-linenum>107: </span><span class='hs-definition'>createPrefsJSON</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>108: </span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; Data.Text.Internal.Text</span><span class='hs-definition'>createPrefsJSON</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>plainText</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>109: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>udata</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"{\"userdata\": "</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>110: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>usize</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"\"usersize\": "</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>111: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>utimespan</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"\"usertimespan\": "</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>112: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>[Data.Text.Internal.Text]</span><span class='hs-varid'>listPrefs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; [Data.Text.Internal.Text]</span><span class='hs-conid'>DTM.splitWords</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == plainText}</span><span class='hs-varid'>plainText</span></a>
<span class=hs-linenum>113: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>[Data.Text.Internal.Text]</span><span class='hs-varid'>sortedList</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[Data.Text.Internal.Text]</span><span class='hs-varid'>prefsSort</span></a> <a class=annot href="#"><span class=annottext>{v : [Data.Text.Internal.Text] | v == listPrefs
                                 &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>listPrefs</span></a>
<span class=hs-linenum>114: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == head sortedList}</span><span class='hs-varid'>udataPref</span></a> <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == head sortedList}</span><span class='hs-varid'>head</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : [Data.Text.Internal.Text] | v == sortedList
                                 &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>sortedList</span></a></span>
<span class=hs-linenum>115: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>usizePref</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:{v : [Data.Text.Internal.Text] | len v &gt; 0} -&gt; {v : Data.Text.Internal.Text | v == head x1}</span><span class='hs-varid'>head</span></a> <span class='hs-varop'>$</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : [Data.Text.Internal.Text] | v == tail sortedList
                                 &amp;&amp; len v == len sortedList - 1}</span><span class='hs-varid'>tail</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : [Data.Text.Internal.Text] | v == sortedList
                                 &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>sortedList</span></a></span>
<span class=hs-linenum>116: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>utimespanPref</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>last</span></a> <a class=annot href="#"><span class=annottext>{v : [Data.Text.Internal.Text] | v == sortedList
                                 &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>sortedList</span></a>
<span class=hs-linenum>117: </span>  <span class='hs-comment'>--let udataPref = "\"Weather\"" :: T.Text</span>
<span class=hs-linenum>118: </span>  <span class='hs-comment'>--let usizePref = "\"Mini\"" :: T.Text</span>
<span class=hs-linenum>119: </span>  <span class='hs-comment'>--let utimespanPref = "\"RightNow\"" :: T.Text</span>
<span class=hs-linenum>120: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>totalPref</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == udata}</span><span class='hs-varid'>udata</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"\""</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == udataPref
                               &amp;&amp; v == head sortedList}</span><span class='hs-varid'>udataPref</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"\""</span></a> <span class='hs-varop'>&lt;&gt;</span>  <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>","</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == usize}</span><span class='hs-varid'>usize</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"\""</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == usizePref}</span><span class='hs-varid'>usizePref</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"\""</span></a> <span class='hs-varop'>&lt;&gt;</span>  <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>","</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == utimespan}</span><span class='hs-varid'>utimespan</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"\""</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == utimespanPref}</span><span class='hs-varid'>utimespanPref</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"\""</span></a> <span class='hs-varop'>&lt;&gt;</span>  <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"}"</span></a>
<span class=hs-linenum>121: </span>  <span class='hs-varid'>totalPref</span>
<span class=hs-linenum>122: </span>
<span class=hs-linenum>123: </span><span class='hs-definition'>sortByPrefs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ordering</span>
<span class=hs-linenum>124: </span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; Data.Text.Internal.Text -&gt; GHC.Types.Ordering</span><span class='hs-definition'>sortByPrefs</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>y</span></a>
<span class=hs-linenum>125: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"Weather | WaterLevels | WeatherWaterLevels | Monsoon | All"</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == y}</span><span class='hs-varid'>y</span></a> <span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"Mini | Standard | Detailed"</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Ordering | v == LT}</span><span class='hs-conid'>LT</span></a>
<span class=hs-linenum>126: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"Mini | Standard | Detailed"</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == y}</span><span class='hs-varid'>y</span></a> <span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"RightNow | Alerts | NearForecast | LongRange"</span></a><span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Ordering | v == LT}</span><span class='hs-conid'>LT</span></a>
<span class=hs-linenum>127: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"Mini | Standard | Detailed"</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == y}</span><span class='hs-varid'>y</span></a> <span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"Weather | WaterLevels | WeatherWaterLevels | Monsoon | All"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Ordering | v == GT}</span><span class='hs-conid'>GT</span></a>
<span class=hs-linenum>128: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>`T.isInfixOf`</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-conid'>T.toLower</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"RightNow | Alerts | NearForecast | LongRange"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Ordering | v == GT}</span><span class='hs-conid'>GT</span></a>
<span class=hs-linenum>129: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Ordering | v == EQ}</span><span class='hs-conid'>EQ</span></a>
<span class=hs-linenum>130: </span>
<span class=hs-linenum>131: </span><span class='hs-definition'>prefsSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>T.Text</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>T.Text</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>132: </span><a class=annot href="#"><span class=annottext>[Data.Text.Internal.Text] -&gt; [Data.Text.Internal.Text]</span><span class='hs-definition'>prefsSort</span></a> <a class=annot href="#"><span class=annottext>[Data.Text.Internal.Text]</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[Data.Text.Internal.Text] -&gt; {v : [Data.Text.Internal.Text] | len v == len x1}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; Data.Text.Internal.Text</span><span class='hs-varid'>replaceBy</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>[Data.Text.Internal.Text]</span><span class='hs-conid'>DS.sortBy</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; Data.Text.Internal.Text -&gt; GHC.Types.Ordering</span><span class='hs-varid'>sortByPrefs</span></a> <a class=annot href="#"><span class=annottext>{v : [Data.Text.Internal.Text] | v == xs
                                 &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>133: </span>
<span class=hs-linenum>134: </span><span class='hs-definition'>replaceBy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>T.Text</span> 
<span class=hs-linenum>135: </span><a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; Data.Text.Internal.Text</span><span class='hs-definition'>replaceBy</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>136: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"weather"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Weather"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>137: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"waterlevels"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"WaterLevels"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>138: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"weatherwaterlevels"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"WeatherWaterLevels"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>139: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"monsoon"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Monsoon"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>140: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"all"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"All"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>141: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"mini"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Mini"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>142: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"standard"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Standard"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>143: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"detailede"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Detailed"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>144: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"rightnow"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"RightNow"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>145: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"alerts"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Alerts"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>146: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"nearforecast"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"NearForecast"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>147: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>"longrange"</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"LongRange"</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>T.Text</span>
<span class=hs-linenum>148: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Hmm"</span></a>
<span class=hs-linenum>149: </span> </pre>
</body>
</html>